{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Ragnos Framework Ragnos es un framework moderno y ligero para el desarrollo de aplicaciones web. Su objetivo es proporcionar una base s\u00f3lida y flexible para construir aplicaciones escalables y de alto rendimiento. Est\u00e1 basado en CodeIgniter 4 , lo que garantiza un n\u00facleo robusto y probado en el tiempo. Adem\u00e1s, utiliza tecnolog\u00edas como jQuery , DataTables y AdminLTE para ofrecer una experiencia de desarrollo completa y eficiente. Caracter\u00edsticas Ligero y r\u00e1pido : Dise\u00f1ado para ser eficiente y minimizar el uso de recursos. Modular : Estructura modular que permite a\u00f1adir o quitar componentes seg\u00fan sea necesario. Escalable : Ideal para proyectos peque\u00f1os y grandes, con capacidad de crecer seg\u00fan las necesidades. F\u00e1cil de usar : Sintaxis clara y documentaci\u00f3n completa para facilitar el desarrollo. Basado en CodeIgniter 4 : Aprovecha las ventajas de un framework PHP moderno, con soporte para namespaces, controladores, modelos y vistas. Integraci\u00f3n con jQuery : Simplifica la manipulaci\u00f3n del DOM, las solicitudes AJAX y la interacci\u00f3n con el usuario. Uso de DataTables : Permite la creaci\u00f3n de tablas din\u00e1micas con funcionalidades como b\u00fasqueda, paginaci\u00f3n y ordenamiento. Dise\u00f1o con AdminLTE : Proporciona una interfaz de usuario moderna y responsiva, ideal para paneles de administraci\u00f3n y aplicaciones web. Funcionalidades y beneficios Desarrollo r\u00e1pido : Gracias a su estructura basada en CodeIgniter 4, Ragnos permite a los desarrolladores centrarse en la l\u00f3gica de negocio sin preocuparse por configuraciones complejas. Interfaz moderna : AdminLTE ofrece un dise\u00f1o atractivo y responsivo, asegurando que las aplicaciones se vean bien en cualquier dispositivo. Gesti\u00f3n de datos eficiente : DataTables facilita la visualizaci\u00f3n y manipulaci\u00f3n de grandes conjuntos de datos de manera interactiva. Flexibilidad : Su arquitectura modular permite personalizar el framework seg\u00fan las necesidades espec\u00edficas del proyecto. Comunidad y soporte : Al estar basado en tecnolog\u00edas ampliamente utilizadas como CodeIgniter y jQuery, los desarrolladores tienen acceso a una gran cantidad de recursos y soporte en l\u00ednea. Organizaci\u00f3n de la Documentaci\u00f3n Esta documentaci\u00f3n est\u00e1 dividida en cuatro secciones principales para facilitar tu aprendizaje: \ud83d\udd30 Fundamentos Todo lo necesario para empezar. Comienza con la Instalaci\u00f3n , revisa la Configuraci\u00f3n y crea tu primer m\u00f3dulo en Primeros Pasos . \ud83d\udcbe Datasets y Modelos El n\u00facleo de Ragnos. Aprende a declarar Datasets , definir Campos y manejar relaciones Maestro-Detalle . \ud83d\ude80 Funcionalidades Avanzadas Para usuarios intermedios. Profundiza en el Modo API , sistema de Hooks y Despliegue en Producci\u00f3n . \ud83c\udfa8 Frontend y UI Personalizaci\u00f3n de la interfaz. Aprende a modificar Men\u00fas o Temas y generar Reportes .","title":"Inicio"},{"location":"#ragnos-framework","text":"Ragnos es un framework moderno y ligero para el desarrollo de aplicaciones web. Su objetivo es proporcionar una base s\u00f3lida y flexible para construir aplicaciones escalables y de alto rendimiento. Est\u00e1 basado en CodeIgniter 4 , lo que garantiza un n\u00facleo robusto y probado en el tiempo. Adem\u00e1s, utiliza tecnolog\u00edas como jQuery , DataTables y AdminLTE para ofrecer una experiencia de desarrollo completa y eficiente.","title":"Ragnos Framework"},{"location":"#caracteristicas","text":"Ligero y r\u00e1pido : Dise\u00f1ado para ser eficiente y minimizar el uso de recursos. Modular : Estructura modular que permite a\u00f1adir o quitar componentes seg\u00fan sea necesario. Escalable : Ideal para proyectos peque\u00f1os y grandes, con capacidad de crecer seg\u00fan las necesidades. F\u00e1cil de usar : Sintaxis clara y documentaci\u00f3n completa para facilitar el desarrollo. Basado en CodeIgniter 4 : Aprovecha las ventajas de un framework PHP moderno, con soporte para namespaces, controladores, modelos y vistas. Integraci\u00f3n con jQuery : Simplifica la manipulaci\u00f3n del DOM, las solicitudes AJAX y la interacci\u00f3n con el usuario. Uso de DataTables : Permite la creaci\u00f3n de tablas din\u00e1micas con funcionalidades como b\u00fasqueda, paginaci\u00f3n y ordenamiento. Dise\u00f1o con AdminLTE : Proporciona una interfaz de usuario moderna y responsiva, ideal para paneles de administraci\u00f3n y aplicaciones web.","title":"Caracter\u00edsticas"},{"location":"#funcionalidades-y-beneficios","text":"Desarrollo r\u00e1pido : Gracias a su estructura basada en CodeIgniter 4, Ragnos permite a los desarrolladores centrarse en la l\u00f3gica de negocio sin preocuparse por configuraciones complejas. Interfaz moderna : AdminLTE ofrece un dise\u00f1o atractivo y responsivo, asegurando que las aplicaciones se vean bien en cualquier dispositivo. Gesti\u00f3n de datos eficiente : DataTables facilita la visualizaci\u00f3n y manipulaci\u00f3n de grandes conjuntos de datos de manera interactiva. Flexibilidad : Su arquitectura modular permite personalizar el framework seg\u00fan las necesidades espec\u00edficas del proyecto. Comunidad y soporte : Al estar basado en tecnolog\u00edas ampliamente utilizadas como CodeIgniter y jQuery, los desarrolladores tienen acceso a una gran cantidad de recursos y soporte en l\u00ednea.","title":"Funcionalidades y beneficios"},{"location":"#organizacion-de-la-documentacion","text":"Esta documentaci\u00f3n est\u00e1 dividida en cuatro secciones principales para facilitar tu aprendizaje: \ud83d\udd30 Fundamentos Todo lo necesario para empezar. Comienza con la Instalaci\u00f3n , revisa la Configuraci\u00f3n y crea tu primer m\u00f3dulo en Primeros Pasos . \ud83d\udcbe Datasets y Modelos El n\u00facleo de Ragnos. Aprende a declarar Datasets , definir Campos y manejar relaciones Maestro-Detalle . \ud83d\ude80 Funcionalidades Avanzadas Para usuarios intermedios. Profundiza en el Modo API , sistema de Hooks y Despliegue en Producci\u00f3n . \ud83c\udfa8 Frontend y UI Personalizaci\u00f3n de la interfaz. Aprende a modificar Men\u00fas o Temas y generar Reportes .","title":"Organizaci\u00f3n de la Documentaci\u00f3n"},{"location":"avanzado/auditlog/","text":"Registro de Auditor\u00eda (Audit Log) El framework Ragnos incluye un sistema nativo y autom\u00e1tico para registrar los cambios realizados en los datos de las entidades. Este sistema permite rastrear qui\u00e9n realiz\u00f3 una acci\u00f3n, cu\u00e1ndo, desde qu\u00e9 direcci\u00f3n IP y qu\u00e9 datos espec\u00edficos fueron modificados, proporcionando una trazabilidad completa de las operaciones. Configuraci\u00f3n Uso en Datasets (RDatasetController) Activado por defecto Todas las clases que extienden de RDatasetController tienen el registro de auditor\u00eda activado autom\u00e1ticamente . Si desea desactivar la auditor\u00eda para un dataset espec\u00edfico (por ejemplo, para tablas temporales o de movimientos masivos donde no se requiere trazabilidad), puede utilizar el m\u00e9todo setEnableAudit(false) dentro del constructor. Ejemplo: class LogsTemporales extends RDatasetController { public function __construct() { parent::__construct(); $this->setTableName('logs_temp'); $this->setIdField('id'); // \u274c Desactivar auditor\u00eda para este controlador $this->setEnableAudit(false); // ... resto de configuraci\u00f3n } } Uso en Modelos Manuales Para activar el registro de auditor\u00eda en un modelo personalizado (que no es gestionado por un Dataset), debe establecer la propiedad $enableAudit en true . Este modelo debe estar utilizando el CrudOperationsTrait (o heredar de una clase base que lo use, como RdatasetModel ). class ClientesModel extends RdatasetModel { protected $table = 'clientes'; protected $primaryKey = 'id_cliente'; // Habilitar auditor\u00eda autom\u00e1tica para esta entidad protected $enableAudit = true; // ... definici\u00f3n de campos } Al habilitar esta propiedad, todas las operaciones de inserci\u00f3n, actualizaci\u00f3n y eliminaci\u00f3n realizadas a trav\u00e9s del controlador/modelo ser\u00e1n interceptadas y registradas autom\u00e1ticamente sin necesidad de c\u00f3digo adicional en sus controladores. Funcionamiento Interno El sistema funciona a trav\u00e9s de App\\ThirdParty\\Ragnos\\Models\\Traits\\CrudOperationsTrait . Cuando se ejecuta una acci\u00f3n de escritura, el sistema realiza los siguientes pasos de manera transparente: 1. Inserci\u00f3n (INSERT) Se ejecuta despu\u00e9s de que el registro ha sido guardado exitosamente. Guarda en el log todos los datos del nuevo registro bajo la clave new . 2. Actualizaci\u00f3n (UPDATE) Antes de guardar, el sistema compara los valores actuales en la base de datos con los nuevos valores enviados. Solo si hay diferencias reales, se procede a guardar el log. Optimizaci\u00f3n : Se registra un JSON que contiene \u00fanicamente los campos que cambiaron, con su valor anterior ( old ) y el nuevo ( new ). Ejemplo de JSON guardado: { \"status\" : { \"old\" : \"pendiente\" , \"new\" : \"activo\" }, \"limite_credito\" : { \"old\" : \"1000.00\" , \"new\" : \"2500.00\" } } 3. Eliminaci\u00f3n (DELETE) Antes de eliminar el registro f\u00edsico, el sistema realiza una consulta para obtener los datos actuales. Guarda una copia completa de los datos del registro eliminado bajo la clave deleted_data para permitir una eventual consulta hist\u00f3rica o restauraci\u00f3n manual. Informaci\u00f3n Registrada Para cada evento, el modelo AuditLogModel (tabla gen_audit_logs ) almacena la siguiente informaci\u00f3n de contexto: Campo Descripci\u00f3n user_id ID del usuario que realiz\u00f3 la acci\u00f3n. El sistema resuelve autom\u00e1ticamente la identidad ya sea por sesi\u00f3n activa (Web) o por Token Bearer (API). table_name Nombre de la tabla de la base de datos donde ocurri\u00f3 el cambio. record_id ID (Clave primaria) del registro afectado. action Tipo de operaci\u00f3n: INSERT , UPDATE o DELETE . changes Carga \u00fatil (Payload) en formato JSON con los detalles del cambio (ver secci\u00f3n anterior). Se almacena con soporte Unicode para caracteres especiales. ip_address Direcci\u00f3n IP desde donde se origin\u00f3 la solicitud. user_agent Informaci\u00f3n del navegador o cliente HTTP utilizado. Detecci\u00f3n de Usuario (Web y API) El mecanismo de auditor\u00eda es agn\u00f3stico al origen de la petici\u00f3n. El m\u00e9todo getCurrentUserId() intenta resolver la identidad del actor de la siguiente manera: Sesi\u00f3n Web: Verifica si existe una sesi\u00f3n activa de CodeIgniter ( session()->get('usu_id') ). API Token: Si es una llamada API, inspecciona el encabezado Authorization . Extrae el token Bearer y busca al usuario correspondiente en la tabla gen_usuarios . Fallback: Si no se identifica al usuario, se registra el ID 0 (Sistema/An\u00f3nimo).","title":"Audit Log"},{"location":"avanzado/auditlog/#registro-de-auditoria-audit-log","text":"El framework Ragnos incluye un sistema nativo y autom\u00e1tico para registrar los cambios realizados en los datos de las entidades. Este sistema permite rastrear qui\u00e9n realiz\u00f3 una acci\u00f3n, cu\u00e1ndo, desde qu\u00e9 direcci\u00f3n IP y qu\u00e9 datos espec\u00edficos fueron modificados, proporcionando una trazabilidad completa de las operaciones.","title":"Registro de Auditor\u00eda (Audit Log)"},{"location":"avanzado/auditlog/#configuracion","text":"","title":"Configuraci\u00f3n"},{"location":"avanzado/auditlog/#uso-en-datasets-rdatasetcontroller","text":"Activado por defecto Todas las clases que extienden de RDatasetController tienen el registro de auditor\u00eda activado autom\u00e1ticamente . Si desea desactivar la auditor\u00eda para un dataset espec\u00edfico (por ejemplo, para tablas temporales o de movimientos masivos donde no se requiere trazabilidad), puede utilizar el m\u00e9todo setEnableAudit(false) dentro del constructor. Ejemplo: class LogsTemporales extends RDatasetController { public function __construct() { parent::__construct(); $this->setTableName('logs_temp'); $this->setIdField('id'); // \u274c Desactivar auditor\u00eda para este controlador $this->setEnableAudit(false); // ... resto de configuraci\u00f3n } }","title":"Uso en Datasets (RDatasetController)"},{"location":"avanzado/auditlog/#uso-en-modelos-manuales","text":"Para activar el registro de auditor\u00eda en un modelo personalizado (que no es gestionado por un Dataset), debe establecer la propiedad $enableAudit en true . Este modelo debe estar utilizando el CrudOperationsTrait (o heredar de una clase base que lo use, como RdatasetModel ). class ClientesModel extends RdatasetModel { protected $table = 'clientes'; protected $primaryKey = 'id_cliente'; // Habilitar auditor\u00eda autom\u00e1tica para esta entidad protected $enableAudit = true; // ... definici\u00f3n de campos } Al habilitar esta propiedad, todas las operaciones de inserci\u00f3n, actualizaci\u00f3n y eliminaci\u00f3n realizadas a trav\u00e9s del controlador/modelo ser\u00e1n interceptadas y registradas autom\u00e1ticamente sin necesidad de c\u00f3digo adicional en sus controladores.","title":"Uso en Modelos Manuales"},{"location":"avanzado/auditlog/#funcionamiento-interno","text":"El sistema funciona a trav\u00e9s de App\\ThirdParty\\Ragnos\\Models\\Traits\\CrudOperationsTrait . Cuando se ejecuta una acci\u00f3n de escritura, el sistema realiza los siguientes pasos de manera transparente:","title":"Funcionamiento Interno"},{"location":"avanzado/auditlog/#1-insercion-insert","text":"Se ejecuta despu\u00e9s de que el registro ha sido guardado exitosamente. Guarda en el log todos los datos del nuevo registro bajo la clave new .","title":"1. Inserci\u00f3n (INSERT)"},{"location":"avanzado/auditlog/#2-actualizacion-update","text":"Antes de guardar, el sistema compara los valores actuales en la base de datos con los nuevos valores enviados. Solo si hay diferencias reales, se procede a guardar el log. Optimizaci\u00f3n : Se registra un JSON que contiene \u00fanicamente los campos que cambiaron, con su valor anterior ( old ) y el nuevo ( new ). Ejemplo de JSON guardado: { \"status\" : { \"old\" : \"pendiente\" , \"new\" : \"activo\" }, \"limite_credito\" : { \"old\" : \"1000.00\" , \"new\" : \"2500.00\" } }","title":"2. Actualizaci\u00f3n (UPDATE)"},{"location":"avanzado/auditlog/#3-eliminacion-delete","text":"Antes de eliminar el registro f\u00edsico, el sistema realiza una consulta para obtener los datos actuales. Guarda una copia completa de los datos del registro eliminado bajo la clave deleted_data para permitir una eventual consulta hist\u00f3rica o restauraci\u00f3n manual.","title":"3. Eliminaci\u00f3n (DELETE)"},{"location":"avanzado/auditlog/#informacion-registrada","text":"Para cada evento, el modelo AuditLogModel (tabla gen_audit_logs ) almacena la siguiente informaci\u00f3n de contexto: Campo Descripci\u00f3n user_id ID del usuario que realiz\u00f3 la acci\u00f3n. El sistema resuelve autom\u00e1ticamente la identidad ya sea por sesi\u00f3n activa (Web) o por Token Bearer (API). table_name Nombre de la tabla de la base de datos donde ocurri\u00f3 el cambio. record_id ID (Clave primaria) del registro afectado. action Tipo de operaci\u00f3n: INSERT , UPDATE o DELETE . changes Carga \u00fatil (Payload) en formato JSON con los detalles del cambio (ver secci\u00f3n anterior). Se almacena con soporte Unicode para caracteres especiales. ip_address Direcci\u00f3n IP desde donde se origin\u00f3 la solicitud. user_agent Informaci\u00f3n del navegador o cliente HTTP utilizado.","title":"Informaci\u00f3n Registrada"},{"location":"avanzado/auditlog/#deteccion-de-usuario-web-y-api","text":"El mecanismo de auditor\u00eda es agn\u00f3stico al origen de la petici\u00f3n. El m\u00e9todo getCurrentUserId() intenta resolver la identidad del actor de la siguiente manera: Sesi\u00f3n Web: Verifica si existe una sesi\u00f3n activa de CodeIgniter ( session()->get('usu_id') ). API Token: Si es una llamada API, inspecciona el encabezado Authorization . Extrae el token Bearer y busca al usuario correspondiente en la tabla gen_usuarios . Fallback: Si no se identifica al usuario, se registra el ID 0 (Sistema/An\u00f3nimo).","title":"Detecci\u00f3n de Usuario (Web y API)"},{"location":"avanzado/autenticacion_integrada/","text":"Sistema de Autenticaci\u00f3n y Permisos en Ragnos Ragnos incorpora un sistema de autenticaci\u00f3n ligero y flexible integrado directamente en el n\u00facleo del framework. Este sistema gestiona sesiones de usuario, protecci\u00f3n de controladores y control de acceso basado en roles (grupos). El sistema se apoya principalmente en el servicio App\\Services\\Admin_aut y en la clase BaseController . Tablas de Base de Datos El sistema espera una estructura de base de datos espec\u00edfica: gen_usuarios : Tabla de usuarios ( usu_id , usu_nombre , usu_login , usu_pword , usu_activo , usu_grupo ). gen_gruposdeusuarios : Tabla de roles ( gru_id , gru_nombre ). Protecci\u00f3n de Controladores Todos los controladores que extienden de BaseController (incluyendo RDatasetController , RProcessController , etc.) tienen acceso a m\u00e9todos de protecci\u00f3n simplificados. Flujo de Verificaci\u00f3n graph TD Req[\"Petici\u00f3n Entrante\"] --> Controller[\"Controlador\"] Controller -->|Llama| Check{\"checkLogin( )\"} Check -- \"No hay sesi\u00f3n\" --> Type{\"\u00bfEs API?\"} Type -- \"S\u00ed\" --> Error401[\"JSON 401 Unauthorized\"] Type -- \"No\" --> Login[\"Redirigir a Login\"] Check -- \"Hay sesi\u00f3n\" --> Group{\"\u00bfcheckUserInGroup( )?\"} Group -- \"No requerido\" --> Access[\"\u2705 Acceso Permitido\"] Group -- \"Requerido\" --> Role{\"\u00bfUsuario en Grupo?\"} Role -- \"S\u00ed\" --> Access Role -- \"No\" --> Error403[\"\u26d4 Redirigir / Error 403\"] %% Estilos mejorados style Access fill:#d4edda,stroke:#155724,stroke-width:2px,color:#155724 style Error401 fill:#f8d7da,stroke:#721c24,stroke-width:2px,color:#721c24 style Login fill:#fff3cd,stroke:#856404,stroke-width:2px,color:#856404 style Error403 fill:#f8d7da,stroke:#721c24,stroke-width:2px,color:#721c24 checkLogin() Este m\u00e9todo verifica si el usuario tiene una sesi\u00f3n activa. Si no la tiene: Para peticiones Web: Redirige al login ( admin/login ). Para API: Verifica el header Authorization contra el usu_token en base de datos. Si falla, devuelve un error 401 JSON. Uso: Se recomienda llamarlo al inicio de cualquier funci\u00f3n que requiera autenticaci\u00f3n, o en el constructor si todo el controlador es privado. Controllers P\u00fablicos Si tienes un controlador p\u00fablico (ej. p\u00e1gina de inicio), simplemente no llames a checkLogin() . public function miFunciopPrivada() { $this->checkLogin(); // El resto del c\u00f3digo solo se ejecuta si el usuario est\u00e1 logueado return view('mi_vista'); } checkUserInGroup($grupos) Restringe el acceso exclusivamente a usuarios que pertenezcan a los grupos especificados. Par\u00e1metro : Puede ser un string con el nombre de un grupo o un array de strings para permitir m\u00faltiples grupos. Comportamiento : Si no cumple la condici\u00f3n, redirige a admin/index (o devuelve 403/401 si es API). Internamente llama a checkLogin() , por lo que no es necesario llamar a ambos. Uso: public function __construct() { // Solo permitir acceso a Administradores $this->checkUserInGroup('Administrador'); } public function reporteGerencial() { // Permitir acceso a Administradores o Gerentes $this->checkUserInGroup(['Administrador', 'Gerencia']); // L\u00f3gica del reporte... } Servicio Admin_aut Para l\u00f3gica m\u00e1s granular dentro de tus vistas o controladores, puedes acceder directamente al servicio de autenticaci\u00f3n. Lo ideal es invocarlo mediante service('Admin_aut') . Funciones Principales isLoggedIn() Devuelve true si hay un usuario logueado, false en caso contrario. if (service('Admin_aut')->isLoggedIn()) { echo \"Usuario conectado\"; } id() Devuelve el ID ( usu_id ) del usuario actual. name() Devuelve el nombre completo ( usu_nombre ) del usuario actual. isUserInGroup($grupo) Eval\u00faa si el usuario actual pertenece al grupo indicado. Es muy \u00fatil para ocultar o mostrar botones en las vistas o aplicar l\u00f3gica condicional. Comparaci\u00f3n case-insensitive . // En un controlador o vista if (service('Admin_aut')->isUserInGroup('Ventas')) { // Mostrar bot\u00f3n de crear pedido } campo($nombreCampo) Obtiene cualquier campo de la tabla gen_usuarios para el usuario actual. La informaci\u00f3n se carga bajo demanda (lazy loading) la primera vez que se solicita un campo. // Obtener el email o cualquier campo personalizado $email = service('Admin_aut')->getField('usu_email'); Autenticaci\u00f3n v\u00eda API El sistema soporta autenticaci\u00f3n para APIs REST de forma transparente. Al hacer login, se genera un token seguro en usu_token . El cliente debe enviar este token en el header Authorization . checkLogin() detecta autom\u00e1ticamente si la petici\u00f3n es una llamada API ( isApiCall() ) y valida el token en lugar de la sesi\u00f3n de PHP. Esto permite utilizar los mismos controladores para la interfaz web y para aplicaciones m\u00f3viles o frontends desacoplados. Ejemplo Completo <?php namespace App\\Controllers ; use App\\ThirdParty\\Ragnos\\Controllers\\BaseController ; class Pedidos extends BaseController { public function __construct () { // Cargar helpers necesarios helper ([ 'form' , 'url' ]); } public function index () { // 1. Asegurar que est\u00e9 logueado $this -> checkLogin (); $auth = service ( 'Admin_aut' ); // 2. Obtener datos del usuario $data [ 'usuario' ] = $auth -> name (); $data [ 'esAdmin' ] = $auth -> isUserInGroup ( 'Administrador' ); return view ( 'pedidos/index' , $data ); } public function eliminar ( $id ) { // 3. Restricci\u00f3n estricta: Solo Admins pueden eliminar $this -> checkUserInGroup ( 'Administrador' ); $model = new \\App\\Models\\PedidosModel (); $model -> delete ( $id ); return redirect () -> to ( '/pedidos' ); } }","title":"Autenticaci\u00f3n"},{"location":"avanzado/autenticacion_integrada/#sistema-de-autenticacion-y-permisos-en-ragnos","text":"Ragnos incorpora un sistema de autenticaci\u00f3n ligero y flexible integrado directamente en el n\u00facleo del framework. Este sistema gestiona sesiones de usuario, protecci\u00f3n de controladores y control de acceso basado en roles (grupos). El sistema se apoya principalmente en el servicio App\\Services\\Admin_aut y en la clase BaseController .","title":"Sistema de Autenticaci\u00f3n y Permisos en Ragnos"},{"location":"avanzado/autenticacion_integrada/#tablas-de-base-de-datos","text":"El sistema espera una estructura de base de datos espec\u00edfica: gen_usuarios : Tabla de usuarios ( usu_id , usu_nombre , usu_login , usu_pword , usu_activo , usu_grupo ). gen_gruposdeusuarios : Tabla de roles ( gru_id , gru_nombre ).","title":"Tablas de Base de Datos"},{"location":"avanzado/autenticacion_integrada/#proteccion-de-controladores","text":"Todos los controladores que extienden de BaseController (incluyendo RDatasetController , RProcessController , etc.) tienen acceso a m\u00e9todos de protecci\u00f3n simplificados.","title":"Protecci\u00f3n de Controladores"},{"location":"avanzado/autenticacion_integrada/#flujo-de-verificacion","text":"graph TD Req[\"Petici\u00f3n Entrante\"] --> Controller[\"Controlador\"] Controller -->|Llama| Check{\"checkLogin( )\"} Check -- \"No hay sesi\u00f3n\" --> Type{\"\u00bfEs API?\"} Type -- \"S\u00ed\" --> Error401[\"JSON 401 Unauthorized\"] Type -- \"No\" --> Login[\"Redirigir a Login\"] Check -- \"Hay sesi\u00f3n\" --> Group{\"\u00bfcheckUserInGroup( )?\"} Group -- \"No requerido\" --> Access[\"\u2705 Acceso Permitido\"] Group -- \"Requerido\" --> Role{\"\u00bfUsuario en Grupo?\"} Role -- \"S\u00ed\" --> Access Role -- \"No\" --> Error403[\"\u26d4 Redirigir / Error 403\"] %% Estilos mejorados style Access fill:#d4edda,stroke:#155724,stroke-width:2px,color:#155724 style Error401 fill:#f8d7da,stroke:#721c24,stroke-width:2px,color:#721c24 style Login fill:#fff3cd,stroke:#856404,stroke-width:2px,color:#856404 style Error403 fill:#f8d7da,stroke:#721c24,stroke-width:2px,color:#721c24","title":"Flujo de Verificaci\u00f3n"},{"location":"avanzado/autenticacion_integrada/#checklogin","text":"Este m\u00e9todo verifica si el usuario tiene una sesi\u00f3n activa. Si no la tiene: Para peticiones Web: Redirige al login ( admin/login ). Para API: Verifica el header Authorization contra el usu_token en base de datos. Si falla, devuelve un error 401 JSON. Uso: Se recomienda llamarlo al inicio de cualquier funci\u00f3n que requiera autenticaci\u00f3n, o en el constructor si todo el controlador es privado. Controllers P\u00fablicos Si tienes un controlador p\u00fablico (ej. p\u00e1gina de inicio), simplemente no llames a checkLogin() . public function miFunciopPrivada() { $this->checkLogin(); // El resto del c\u00f3digo solo se ejecuta si el usuario est\u00e1 logueado return view('mi_vista'); }","title":"checkLogin()"},{"location":"avanzado/autenticacion_integrada/#checkuseringroupgrupos","text":"Restringe el acceso exclusivamente a usuarios que pertenezcan a los grupos especificados. Par\u00e1metro : Puede ser un string con el nombre de un grupo o un array de strings para permitir m\u00faltiples grupos. Comportamiento : Si no cumple la condici\u00f3n, redirige a admin/index (o devuelve 403/401 si es API). Internamente llama a checkLogin() , por lo que no es necesario llamar a ambos. Uso: public function __construct() { // Solo permitir acceso a Administradores $this->checkUserInGroup('Administrador'); } public function reporteGerencial() { // Permitir acceso a Administradores o Gerentes $this->checkUserInGroup(['Administrador', 'Gerencia']); // L\u00f3gica del reporte... }","title":"checkUserInGroup($grupos)"},{"location":"avanzado/autenticacion_integrada/#servicio-admin_aut","text":"Para l\u00f3gica m\u00e1s granular dentro de tus vistas o controladores, puedes acceder directamente al servicio de autenticaci\u00f3n. Lo ideal es invocarlo mediante service('Admin_aut') .","title":"Servicio Admin_aut"},{"location":"avanzado/autenticacion_integrada/#funciones-principales","text":"","title":"Funciones Principales"},{"location":"avanzado/autenticacion_integrada/#isloggedin","text":"Devuelve true si hay un usuario logueado, false en caso contrario. if (service('Admin_aut')->isLoggedIn()) { echo \"Usuario conectado\"; }","title":"isLoggedIn()"},{"location":"avanzado/autenticacion_integrada/#id","text":"Devuelve el ID ( usu_id ) del usuario actual.","title":"id()"},{"location":"avanzado/autenticacion_integrada/#name","text":"Devuelve el nombre completo ( usu_nombre ) del usuario actual.","title":"name()"},{"location":"avanzado/autenticacion_integrada/#isuseringroupgrupo","text":"Eval\u00faa si el usuario actual pertenece al grupo indicado. Es muy \u00fatil para ocultar o mostrar botones en las vistas o aplicar l\u00f3gica condicional. Comparaci\u00f3n case-insensitive . // En un controlador o vista if (service('Admin_aut')->isUserInGroup('Ventas')) { // Mostrar bot\u00f3n de crear pedido }","title":"isUserInGroup($grupo)"},{"location":"avanzado/autenticacion_integrada/#camponombrecampo","text":"Obtiene cualquier campo de la tabla gen_usuarios para el usuario actual. La informaci\u00f3n se carga bajo demanda (lazy loading) la primera vez que se solicita un campo. // Obtener el email o cualquier campo personalizado $email = service('Admin_aut')->getField('usu_email');","title":"campo($nombreCampo)"},{"location":"avanzado/autenticacion_integrada/#autenticacion-via-api","text":"El sistema soporta autenticaci\u00f3n para APIs REST de forma transparente. Al hacer login, se genera un token seguro en usu_token . El cliente debe enviar este token en el header Authorization . checkLogin() detecta autom\u00e1ticamente si la petici\u00f3n es una llamada API ( isApiCall() ) y valida el token en lugar de la sesi\u00f3n de PHP. Esto permite utilizar los mismos controladores para la interfaz web y para aplicaciones m\u00f3viles o frontends desacoplados.","title":"Autenticaci\u00f3n v\u00eda API"},{"location":"avanzado/autenticacion_integrada/#ejemplo-completo","text":"<?php namespace App\\Controllers ; use App\\ThirdParty\\Ragnos\\Controllers\\BaseController ; class Pedidos extends BaseController { public function __construct () { // Cargar helpers necesarios helper ([ 'form' , 'url' ]); } public function index () { // 1. Asegurar que est\u00e9 logueado $this -> checkLogin (); $auth = service ( 'Admin_aut' ); // 2. Obtener datos del usuario $data [ 'usuario' ] = $auth -> name (); $data [ 'esAdmin' ] = $auth -> isUserInGroup ( 'Administrador' ); return view ( 'pedidos/index' , $data ); } public function eliminar ( $id ) { // 3. Restricci\u00f3n estricta: Solo Admins pueden eliminar $this -> checkUserInGroup ( 'Administrador' ); $model = new \\App\\Models\\PedidosModel (); $model -> delete ( $id ); return redirect () -> to ( '/pedidos' ); } }","title":"Ejemplo Completo"},{"location":"avanzado/despliegue/","text":"Gu\u00eda de Despliegue (Production) Esta gu\u00eda cubre los pasos esenciales para llevar tu aplicaci\u00f3n Ragnos de un entorno de desarrollo local a un servidor de producci\u00f3n. 1. Configuraci\u00f3n de Entorno Importante En producci\u00f3n, nunca debes ejecutar la aplicaci\u00f3n en modo development . Esto expondr\u00eda informaci\u00f3n sensible y ralentizar\u00eda la aplicaci\u00f3n. Edita el archivo .env en tu servidor. Establece la variable de entorno: CI_ENVIRONMENT = production Esto desactivar\u00e1 la barra de depuraci\u00f3n (debug toolbar), ocultar\u00e1 los errores detallados de PHP en pantalla y activar\u00e1 el cach\u00e9 de configuraciones. 2. Permisos del Sistema de Archivos Aseg\u00farate de que el usuario del servidor web (ej. www-data en Apache/Nginx) tenga permisos de escritura en la carpeta writable y todas sus subcarpetas. chmod -R 775 writable/ chown -R www-data:www-data writable/ Las dem\u00e1s carpetas ( app , system , public ) deben ser de solo lectura para el servidor web por motivos de seguridad, a menos que tengas necesidades espec\u00edficas. 3. Base de Datos Actualiza las credenciales de conexi\u00f3n en el archivo .env apuntando a tu base de datos de producci\u00f3n. Aseg\u00farate de que app.baseURL est\u00e9 configurado correctamente con el dominio real (HTTPS recomendado). app.baseURL = 'https://mi-sistema-produccion.com/' 4. Eliminar archivos de desarrollo Se recomienda no subir archivos innecesarios al servidor de producci\u00f3n: Tests ( tests/ ) Archivos de git ( .git/ , .gitignore ) Documentaci\u00f3n interna ( documentacion/ ) Archivos SQL de ejemplos ( sampledatabase/ ) Soluci\u00f3n de Problemas Comunes Error 404 en todas las p\u00e1ginas excepto el Home: Esto suele ser un problema de configuraci\u00f3n del servidor web (Apache/Nginx) que no est\u00e1 redirigiendo las peticiones a index.php . Aseg\u00farate de que el archivo public/.htaccess est\u00e9 presente y que el m\u00f3dulo mod_rewrite est\u00e9 activo en Apache. P\u00e1gina en blanco o Error 500: Verifica los logs en writable/logs/ para ver el error real, ya que en modo producci\u00f3n no se muestran en pantalla.","title":"Despliegue"},{"location":"avanzado/despliegue/#guia-de-despliegue-production","text":"Esta gu\u00eda cubre los pasos esenciales para llevar tu aplicaci\u00f3n Ragnos de un entorno de desarrollo local a un servidor de producci\u00f3n.","title":"Gu\u00eda de Despliegue (Production)"},{"location":"avanzado/despliegue/#1-configuracion-de-entorno","text":"Importante En producci\u00f3n, nunca debes ejecutar la aplicaci\u00f3n en modo development . Esto expondr\u00eda informaci\u00f3n sensible y ralentizar\u00eda la aplicaci\u00f3n. Edita el archivo .env en tu servidor. Establece la variable de entorno: CI_ENVIRONMENT = production Esto desactivar\u00e1 la barra de depuraci\u00f3n (debug toolbar), ocultar\u00e1 los errores detallados de PHP en pantalla y activar\u00e1 el cach\u00e9 de configuraciones.","title":"1. Configuraci\u00f3n de Entorno"},{"location":"avanzado/despliegue/#2-permisos-del-sistema-de-archivos","text":"Aseg\u00farate de que el usuario del servidor web (ej. www-data en Apache/Nginx) tenga permisos de escritura en la carpeta writable y todas sus subcarpetas. chmod -R 775 writable/ chown -R www-data:www-data writable/ Las dem\u00e1s carpetas ( app , system , public ) deben ser de solo lectura para el servidor web por motivos de seguridad, a menos que tengas necesidades espec\u00edficas.","title":"2. Permisos del Sistema de Archivos"},{"location":"avanzado/despliegue/#3-base-de-datos","text":"Actualiza las credenciales de conexi\u00f3n en el archivo .env apuntando a tu base de datos de producci\u00f3n. Aseg\u00farate de que app.baseURL est\u00e9 configurado correctamente con el dominio real (HTTPS recomendado). app.baseURL = 'https://mi-sistema-produccion.com/'","title":"3. Base de Datos"},{"location":"avanzado/despliegue/#4-eliminar-archivos-de-desarrollo","text":"Se recomienda no subir archivos innecesarios al servidor de producci\u00f3n: Tests ( tests/ ) Archivos de git ( .git/ , .gitignore ) Documentaci\u00f3n interna ( documentacion/ ) Archivos SQL de ejemplos ( sampledatabase/ )","title":"4. Eliminar archivos de desarrollo"},{"location":"avanzado/despliegue/#solucion-de-problemas-comunes","text":"Error 404 en todas las p\u00e1ginas excepto el Home: Esto suele ser un problema de configuraci\u00f3n del servidor web (Apache/Nginx) que no est\u00e1 redirigiendo las peticiones a index.php . Aseg\u00farate de que el archivo public/.htaccess est\u00e9 presente y que el m\u00f3dulo mod_rewrite est\u00e9 activo en Apache. P\u00e1gina en blanco o Error 500: Verifica los logs en writable/logs/ para ver el error real, ya que en modo producci\u00f3n no se muestran en pantalla.","title":"Soluci\u00f3n de Problemas Comunes"},{"location":"avanzado/guia_modo_api/","text":"Gu\u00eda de Uso: Ragnos API Mode A partir de la versi\u00f3n v1.1, Ragnos Framework soporta controladores h\u00edbridos. Esto significa que el mismo controlador que sirve tu panel administrativo (HTML) puede funcionar como una API RESTful (JSON) sin escribir c\u00f3digo adicional. \ud83d\udccb Requisitos Previos Token de Acceso: Debes tener un api_token v\u00e1lido asignado a tu usuario en la base de datos. Endpoint: La URL es la misma que usas en el navegador (ej. https://tu-sitio.com/tienda/productos ). Autenticar con el Modo API y obtener el token Para usar el Modo API, primero debes autenticarte y obtener un token. Puedes hacerlo enviando una solicitud POST al endpoint de login con tus credenciales. Request: POST /admin/login Headers: Content-Type: application/json Accept: application/json Body (JSON): { \"usuario\": \"admin\", \"pword\": \"tu_contrase\u00f1a\" } Respuesta (200 OK): { \"status\" : \"success\" , \"message\" : \"Login successful\" , \"token\" : \"4984656be2ff893362b3b023d0b55df74494fb87552916031143e6431e8d9a7c\" , \"user_id\" : \"1\" } As\u00ed obtendr\u00e1s un token que deber\u00e1s usar en las cabeceras de tus futuras solicitudes API. \ud83d\udd10 Autenticaci\u00f3n y Cabeceras Para activar el \"Modo API\", el cliente debe enviar las siguientes cabeceras HTTP. Si no se env\u00edan, Ragnos responder\u00e1 con HTML (redirecciones y vistas). Header Valor Descripci\u00f3n Accept application/json Obligatorio. Le dice a Ragnos que no quieres HTML, sino JSON. Authorization Bearer TU_TOKEN_AQUI Obligatorio. Tu token de seguridad. Content-Type application/json Necesario cuando env\u00edas datos (POST/PUT). \ud83d\udce1 Endpoints y Operaciones Supongamos que tu controlador es Tienda/Productos . 1. Listar Registros (GET) Obtiene la lista de datos aplicando los filtros de la grilla. Request: GET /tienda/productos Headers: Accept: application/json Authorization: Bearer xyz123 Respuesta (200 OK): { \"status\" : 200 , \"data\" : [ { \"id\" : 1 , \"nombre\" : \"Laptop\" , \"precio\" : 1500 }, { \"id\" : 2 , \"nombre\" : \"Mouse\" , \"precio\" : 20 } ], \"count\" : 2 } 2. Crear un Registro (POST) Request: POST /tienda/productos/save Headers: Content-Type: application/json Accept: application/json Authorization: Bearer xyz123 Body (JSON): { \"nombre\": \"Teclado Mec\u00e1nico\", \"precio\": 85.50, \"stock\": 10 } Respuesta (201 Created): { \"status\" : 201 , \"message\" : \"Registro creado exitosamente.\" , \"data\" : { \"id\" : 15 } } 3. Actualizar un Registro (POST/PUT) En Ragnos, la actualizaci\u00f3n se maneja en el mismo endpoint save . La diferencia es que debes incluir el ID (clave primaria). Request: POST /tienda/productos/save Headers: ... (mismos de arriba) Body (JSON): { \"id\": 15, \"precio\": 90.00 } Respuesta (200 OK): { \"status\" : 200 , \"message\" : \"Registro actualizado exitosamente.\" , \"data\" : { \"id\" : 15 } } 4. Eliminar un Registro (POST/DELETE) Puedes enviar el ID en la URL o en el cuerpo del JSON. Opci\u00f3n A (URL): POST /tienda/productos/delete/15 Opci\u00f3n B (JSON Body): Request: POST /tienda/productos/delete Headers: ... Body (JSON): { \"id\": 15 } Respuesta (200 OK): { \"status\" : 200 , \"message\" : \"Registro eliminado correctamente\" } \u26a0\ufe0f Manejo de Errores Si algo sale mal (validaci\u00f3n o servidor), Ragnos devolver\u00e1 un c\u00f3digo de estado HTTP apropiado y un JSON de error. Ejemplo: Error de Validaci\u00f3n (400 Bad Request) { \"status\" : 400 , \"error\" : 400 , \"messages\" : { \"precio\" : \"El campo Precio es obligatorio.\" , \"stock\" : \"El campo Stock debe ser num\u00e9rico.\" } } Ejemplo: Token Inv\u00e1lido (401 Unauthorized) { \"status\" : 401 , \"error\" : \"Token inv\u00e1lido o expirado\" } \ud83d\udcbb Ejemplos de Cliente JavaScript (Fetch) const token = \"TU_API_TOKEN\" ; // Ejemplo: Guardar producto fetch ( \"https://tusitio.com/tienda/productos/save\" , { method : \"POST\" , headers : { \"Content-Type\" : \"application/json\" , Accept : \"application/json\" , Authorization : `Bearer ${ token } ` , }, body : JSON . stringify ({ nombre : \"Monitor 4K\" , precio : 300 , }), }) . then (( response ) => response . json ()) . then (( data ) => console . log ( data )) . catch (( error ) => console . error ( \"Error:\" , error )); cURL (Terminal) curl -X GET https://tusitio.com/tienda/productos -H \"Accept: application/json\" -H \"Authorization: Bearer TU_API_TOKEN\"","title":"Modo API"},{"location":"avanzado/guia_modo_api/#guia-de-uso-ragnos-api-mode","text":"A partir de la versi\u00f3n v1.1, Ragnos Framework soporta controladores h\u00edbridos. Esto significa que el mismo controlador que sirve tu panel administrativo (HTML) puede funcionar como una API RESTful (JSON) sin escribir c\u00f3digo adicional.","title":"Gu\u00eda de Uso: Ragnos API Mode"},{"location":"avanzado/guia_modo_api/#requisitos-previos","text":"Token de Acceso: Debes tener un api_token v\u00e1lido asignado a tu usuario en la base de datos. Endpoint: La URL es la misma que usas en el navegador (ej. https://tu-sitio.com/tienda/productos ).","title":"\ud83d\udccb Requisitos Previos"},{"location":"avanzado/guia_modo_api/#autenticar-con-el-modo-api-y-obtener-el-token","text":"Para usar el Modo API, primero debes autenticarte y obtener un token. Puedes hacerlo enviando una solicitud POST al endpoint de login con tus credenciales. Request: POST /admin/login Headers: Content-Type: application/json Accept: application/json Body (JSON): { \"usuario\": \"admin\", \"pword\": \"tu_contrase\u00f1a\" } Respuesta (200 OK): { \"status\" : \"success\" , \"message\" : \"Login successful\" , \"token\" : \"4984656be2ff893362b3b023d0b55df74494fb87552916031143e6431e8d9a7c\" , \"user_id\" : \"1\" } As\u00ed obtendr\u00e1s un token que deber\u00e1s usar en las cabeceras de tus futuras solicitudes API.","title":"Autenticar con el Modo API y obtener el token"},{"location":"avanzado/guia_modo_api/#autenticacion-y-cabeceras","text":"Para activar el \"Modo API\", el cliente debe enviar las siguientes cabeceras HTTP. Si no se env\u00edan, Ragnos responder\u00e1 con HTML (redirecciones y vistas). Header Valor Descripci\u00f3n Accept application/json Obligatorio. Le dice a Ragnos que no quieres HTML, sino JSON. Authorization Bearer TU_TOKEN_AQUI Obligatorio. Tu token de seguridad. Content-Type application/json Necesario cuando env\u00edas datos (POST/PUT).","title":"\ud83d\udd10 Autenticaci\u00f3n y Cabeceras"},{"location":"avanzado/guia_modo_api/#endpoints-y-operaciones","text":"Supongamos que tu controlador es Tienda/Productos .","title":"\ud83d\udce1 Endpoints y Operaciones"},{"location":"avanzado/guia_modo_api/#1-listar-registros-get","text":"Obtiene la lista de datos aplicando los filtros de la grilla. Request: GET /tienda/productos Headers: Accept: application/json Authorization: Bearer xyz123 Respuesta (200 OK): { \"status\" : 200 , \"data\" : [ { \"id\" : 1 , \"nombre\" : \"Laptop\" , \"precio\" : 1500 }, { \"id\" : 2 , \"nombre\" : \"Mouse\" , \"precio\" : 20 } ], \"count\" : 2 }","title":"1. Listar Registros (GET)"},{"location":"avanzado/guia_modo_api/#2-crear-un-registro-post","text":"Request: POST /tienda/productos/save Headers: Content-Type: application/json Accept: application/json Authorization: Bearer xyz123 Body (JSON): { \"nombre\": \"Teclado Mec\u00e1nico\", \"precio\": 85.50, \"stock\": 10 } Respuesta (201 Created): { \"status\" : 201 , \"message\" : \"Registro creado exitosamente.\" , \"data\" : { \"id\" : 15 } }","title":"2. Crear un Registro (POST)"},{"location":"avanzado/guia_modo_api/#3-actualizar-un-registro-postput","text":"En Ragnos, la actualizaci\u00f3n se maneja en el mismo endpoint save . La diferencia es que debes incluir el ID (clave primaria). Request: POST /tienda/productos/save Headers: ... (mismos de arriba) Body (JSON): { \"id\": 15, \"precio\": 90.00 } Respuesta (200 OK): { \"status\" : 200 , \"message\" : \"Registro actualizado exitosamente.\" , \"data\" : { \"id\" : 15 } }","title":"3. Actualizar un Registro (POST/PUT)"},{"location":"avanzado/guia_modo_api/#4-eliminar-un-registro-postdelete","text":"Puedes enviar el ID en la URL o en el cuerpo del JSON. Opci\u00f3n A (URL): POST /tienda/productos/delete/15 Opci\u00f3n B (JSON Body): Request: POST /tienda/productos/delete Headers: ... Body (JSON): { \"id\": 15 } Respuesta (200 OK): { \"status\" : 200 , \"message\" : \"Registro eliminado correctamente\" }","title":"4. Eliminar un Registro (POST/DELETE)"},{"location":"avanzado/guia_modo_api/#manejo-de-errores","text":"Si algo sale mal (validaci\u00f3n o servidor), Ragnos devolver\u00e1 un c\u00f3digo de estado HTTP apropiado y un JSON de error. Ejemplo: Error de Validaci\u00f3n (400 Bad Request) { \"status\" : 400 , \"error\" : 400 , \"messages\" : { \"precio\" : \"El campo Precio es obligatorio.\" , \"stock\" : \"El campo Stock debe ser num\u00e9rico.\" } } Ejemplo: Token Inv\u00e1lido (401 Unauthorized) { \"status\" : 401 , \"error\" : \"Token inv\u00e1lido o expirado\" }","title":"\u26a0\ufe0f Manejo de Errores"},{"location":"avanzado/guia_modo_api/#ejemplos-de-cliente","text":"","title":"\ud83d\udcbb Ejemplos de Cliente"},{"location":"avanzado/guia_modo_api/#javascript-fetch","text":"const token = \"TU_API_TOKEN\" ; // Ejemplo: Guardar producto fetch ( \"https://tusitio.com/tienda/productos/save\" , { method : \"POST\" , headers : { \"Content-Type\" : \"application/json\" , Accept : \"application/json\" , Authorization : `Bearer ${ token } ` , }, body : JSON . stringify ({ nombre : \"Monitor 4K\" , precio : 300 , }), }) . then (( response ) => response . json ()) . then (( data ) => console . log ( data )) . catch (( error ) => console . error ( \"Error:\" , error ));","title":"JavaScript (Fetch)"},{"location":"avanzado/guia_modo_api/#curl-terminal","text":"curl -X GET https://tusitio.com/tienda/productos -H \"Accept: application/json\" -H \"Authorization: Bearer TU_API_TOKEN\"","title":"cURL (Terminal)"},{"location":"avanzado/helpers/","text":"Helpers y Utilidades PHP Ragnos incluye una colecci\u00f3n de funciones auxiliares (helpers) globales dise\u00f1adas para agilizar tareas comunes y mejorar el rendimiento de la aplicaci\u00f3n. Estas funciones est\u00e1n disponibles en todo el framework autom\u00e1ticamente. Gesti\u00f3n de Base de Datos y Cach\u00e9 getCachedData() Esta funci\u00f3n ejecuta una consulta SQL pura y almacena el resultado en el sistema de cach\u00e9 de CodeIgniter 4. Es ideal para consultas pesadas o reportes que no requieren datos en tiempo real. function getCachedData(string $sql, array $params = [], ?string $cacheKey = null, int $ttl = 86400): array Par\u00e1metros Par\u00e1metro Tipo Descripci\u00f3n $sql string La consulta SQL a ejecutar. $params array (Opcional) Array de valores para los par\u00e1metros vinculados ( ? ) en la consulta. $cacheKey string (Opcional) Identificador \u00fanico para el cach\u00e9. Si es null , se generar\u00e1 un hash autom\u00e1tico basado en la consulta y los par\u00e1metros. $ttl int (Opcional) Tiempo de vida (Time To Live) en segundos. Por defecto es 86400 (24 horas). Retorno Retorna un array asociativo con los resultados de la consulta. Ejemplo de Uso // En un Modelo o Controlador public function obtenerMetricas() { $sql = \"SELECT p.productLine, SUM(od.quantityOrdered * od.priceEach) as Total FROM products p JOIN orderdetails od ON p.productCode = od.productCode GROUP BY p.productLine\"; // Cachear el resultado por 1 hora (3600 segundos) con una clave espec\u00edfica return getCachedData($sql, [], 'metricas_dashboard', 3600); } \u26a0\ufe0f Advertencias y Consideraciones Datos en Tiempo Real: No utilice esta funci\u00f3n para datos cr\u00edticos que cambian constantemente (ej. inventario en tiempo real si hay alta concurrencia, saldos bancarios). La informaci\u00f3n servida puede tener hasta $ttl segundos de antig\u00fcedad. Invalidaci\u00f3n de Cach\u00e9: Si utiliza una $cacheKey personalizada (como 'metricas_dashboard' ), puede limpiar manualmente ese cach\u00e9 cuando los datos cambien usando cache()->delete('metricas_dashboard') . Si deja que el sistema genere la clave autom\u00e1ticamente, la invalidaci\u00f3n manual es m\u00e1s dif\u00edcil. Entorno de Desarrollo: Recuerde que si est\u00e1 desarrollando y cambiando datos, es posible que siga viendo los datos antiguos hasta que limpie el cach\u00e9 ( php spark cache:clear ). queryToAssocArray() Ejecuta una consulta SQL y transforma el resultado directamente en un array asociativo del tipo [id => valor] . Es extremadamente \u00fatil para poblar listas desplegables ( <select> ). function queryToAssocArray(string $sql, string $index_key, string $column_key): array Ejemplo // Obtener lista de categor\u00edas para un Dropdown $sql = \"SELECT id, nombre FROM categorias ORDER BY nombre ASC\"; $opciones = queryToAssocArray($sql, 'id', 'nombre'); // Resultado: [1 => 'Electr\u00f3nica', 2 => 'Hogar', ...] Depuraci\u00f3n y Diagn\u00f3stico dbgConsola() Env\u00eda datos de PHP directamente a la consola del navegador del desarrollador. Utiliza console.log v\u00eda inyecci\u00f3n de script. Solo funciona en entorno de desarrollo ( development ). function dbgConsola($data, string $label = 'dbgConsola') Ejemplo $usuarios = $model->findAll(); dbgConsola($usuarios, 'Lista de Usuarios'); // Verifica la consola de Chrome/Firefox (F12) dbgDie() Mata la ejecuci\u00f3n del script y devuelve los datos proporcionados en formato JSON. Es perfecto para depurar llamadas API o AJAX. function dbgDie($data, int $statusCode = 200): never Formato y UI currency() Formatea n\u00fameros como moneda respetando la configuraci\u00f3n regional ( locale ) sin necesidad de extensiones complejas. function currency(float|int $number, bool $includeSymbol = true): string Ejemplo echo currency(1500.50); // Muestra \"$1,500.50\" (dependiendo de config) returnAsJSON() Estandariza las respuestas JSON de tu API o controladores AJAX. Maneja autom\u00e1ticamente los encabezados HTTP y la codificaci\u00f3n UTF-8. function returnAsJSON($data, $statusCode = 200) Ejemplo if (!$usuario) { returnAsJSON(['error' => 'Usuario no encontrado'], 404); } returnAsJSON($usuario);","title":"Helpers y Utilidades"},{"location":"avanzado/helpers/#helpers-y-utilidades-php","text":"Ragnos incluye una colecci\u00f3n de funciones auxiliares (helpers) globales dise\u00f1adas para agilizar tareas comunes y mejorar el rendimiento de la aplicaci\u00f3n. Estas funciones est\u00e1n disponibles en todo el framework autom\u00e1ticamente.","title":"Helpers y Utilidades PHP"},{"location":"avanzado/helpers/#gestion-de-base-de-datos-y-cache","text":"","title":"Gesti\u00f3n de Base de Datos y Cach\u00e9"},{"location":"avanzado/helpers/#getcacheddata","text":"Esta funci\u00f3n ejecuta una consulta SQL pura y almacena el resultado en el sistema de cach\u00e9 de CodeIgniter 4. Es ideal para consultas pesadas o reportes que no requieren datos en tiempo real. function getCachedData(string $sql, array $params = [], ?string $cacheKey = null, int $ttl = 86400): array","title":"getCachedData()"},{"location":"avanzado/helpers/#parametros","text":"Par\u00e1metro Tipo Descripci\u00f3n $sql string La consulta SQL a ejecutar. $params array (Opcional) Array de valores para los par\u00e1metros vinculados ( ? ) en la consulta. $cacheKey string (Opcional) Identificador \u00fanico para el cach\u00e9. Si es null , se generar\u00e1 un hash autom\u00e1tico basado en la consulta y los par\u00e1metros. $ttl int (Opcional) Tiempo de vida (Time To Live) en segundos. Por defecto es 86400 (24 horas).","title":"Par\u00e1metros"},{"location":"avanzado/helpers/#retorno","text":"Retorna un array asociativo con los resultados de la consulta.","title":"Retorno"},{"location":"avanzado/helpers/#ejemplo-de-uso","text":"// En un Modelo o Controlador public function obtenerMetricas() { $sql = \"SELECT p.productLine, SUM(od.quantityOrdered * od.priceEach) as Total FROM products p JOIN orderdetails od ON p.productCode = od.productCode GROUP BY p.productLine\"; // Cachear el resultado por 1 hora (3600 segundos) con una clave espec\u00edfica return getCachedData($sql, [], 'metricas_dashboard', 3600); }","title":"Ejemplo de Uso"},{"location":"avanzado/helpers/#advertencias-y-consideraciones","text":"Datos en Tiempo Real: No utilice esta funci\u00f3n para datos cr\u00edticos que cambian constantemente (ej. inventario en tiempo real si hay alta concurrencia, saldos bancarios). La informaci\u00f3n servida puede tener hasta $ttl segundos de antig\u00fcedad. Invalidaci\u00f3n de Cach\u00e9: Si utiliza una $cacheKey personalizada (como 'metricas_dashboard' ), puede limpiar manualmente ese cach\u00e9 cuando los datos cambien usando cache()->delete('metricas_dashboard') . Si deja que el sistema genere la clave autom\u00e1ticamente, la invalidaci\u00f3n manual es m\u00e1s dif\u00edcil. Entorno de Desarrollo: Recuerde que si est\u00e1 desarrollando y cambiando datos, es posible que siga viendo los datos antiguos hasta que limpie el cach\u00e9 ( php spark cache:clear ).","title":"\u26a0\ufe0f Advertencias y Consideraciones"},{"location":"avanzado/helpers/#querytoassocarray","text":"Ejecuta una consulta SQL y transforma el resultado directamente en un array asociativo del tipo [id => valor] . Es extremadamente \u00fatil para poblar listas desplegables ( <select> ). function queryToAssocArray(string $sql, string $index_key, string $column_key): array","title":"queryToAssocArray()"},{"location":"avanzado/helpers/#ejemplo","text":"// Obtener lista de categor\u00edas para un Dropdown $sql = \"SELECT id, nombre FROM categorias ORDER BY nombre ASC\"; $opciones = queryToAssocArray($sql, 'id', 'nombre'); // Resultado: [1 => 'Electr\u00f3nica', 2 => 'Hogar', ...]","title":"Ejemplo"},{"location":"avanzado/helpers/#depuracion-y-diagnostico","text":"","title":"Depuraci\u00f3n y Diagn\u00f3stico"},{"location":"avanzado/helpers/#dbgconsola","text":"Env\u00eda datos de PHP directamente a la consola del navegador del desarrollador. Utiliza console.log v\u00eda inyecci\u00f3n de script. Solo funciona en entorno de desarrollo ( development ). function dbgConsola($data, string $label = 'dbgConsola')","title":"dbgConsola()"},{"location":"avanzado/helpers/#ejemplo_1","text":"$usuarios = $model->findAll(); dbgConsola($usuarios, 'Lista de Usuarios'); // Verifica la consola de Chrome/Firefox (F12)","title":"Ejemplo"},{"location":"avanzado/helpers/#dbgdie","text":"Mata la ejecuci\u00f3n del script y devuelve los datos proporcionados en formato JSON. Es perfecto para depurar llamadas API o AJAX. function dbgDie($data, int $statusCode = 200): never","title":"dbgDie()"},{"location":"avanzado/helpers/#formato-y-ui","text":"","title":"Formato y UI"},{"location":"avanzado/helpers/#currency","text":"Formatea n\u00fameros como moneda respetando la configuraci\u00f3n regional ( locale ) sin necesidad de extensiones complejas. function currency(float|int $number, bool $includeSymbol = true): string","title":"currency()"},{"location":"avanzado/helpers/#ejemplo_2","text":"echo currency(1500.50); // Muestra \"$1,500.50\" (dependiendo de config)","title":"Ejemplo"},{"location":"avanzado/helpers/#returnasjson","text":"Estandariza las respuestas JSON de tu API o controladores AJAX. Maneja autom\u00e1ticamente los encabezados HTTP y la codificaci\u00f3n UTF-8. function returnAsJSON($data, $statusCode = 200)","title":"returnAsJSON()"},{"location":"avanzado/helpers/#ejemplo_3","text":"if (!$usuario) { returnAsJSON(['error' => 'Usuario no encontrado'], 404); } returnAsJSON($usuario);","title":"Ejemplo"},{"location":"avanzado/hooks/","text":"Hooks y ciclo de vida en Ragnos En Ragnos, los hooks permiten ejecutar l\u00f3gica personalizada en distintos momentos del ciclo de vida de un dataset. Son el mecanismo principal para extender comportamiento sin romper el modelo declarativo. Los hooks se definen como m\u00e9todos protegidos dentro del controlador que extiende RDatasetController . Concepto Clave El controlador no implementa el CRUD manualmente. Ragnos se encarga de la operaci\u00f3n de base de datos, y t\u00fa solo \"te enganchas\" (hook) en los puntos clave para inyectar tu l\u00f3gica de negocio. Ciclo de Vida Visual Entender el flujo de ejecuci\u00f3n es crucial para saber d\u00f3nde colocar tu l\u00f3gica. graph TD A[\"Petici\u00f3n del Usuario\"] --> B{\"Validaci\u00f3n de Campos\"} B -- Fallo --> Z[\"Mostrar Error\"] B -- \u00c9xito --> C{\"\u00bfExiste Hook _before*?\"} C -- S\u00ed --> D[\"Ejecutar _before*( )\"] D -- \"raise( )\" --> Z C -- No --> E[\"Operaci\u00f3n en Base de Datos\"] D -- \u00c9xito --> E E --> F{\"\u00bfOperaci\u00f3n Exitosa?\"} F -- No --> Z F -- S\u00ed --> G{\"\u00bfExiste Hook _after*?\"} G -- S\u00ed --> H[\"Ejecutar _after*( )\"] G -- No --> I[\"Respuesta Exitosa\"] H --> I Hooks disponibles Ragnos expone los siguientes hooks, todos opcionales: Hook Momento de ejecuci\u00f3n _beforeInsert() Antes de insertar un registro _afterInsert() Despu\u00e9s de insertar un registro _beforeUpdate() Antes de actualizar un registro _afterUpdate() Despu\u00e9s de actualizar un registro _beforeDelete() Antes de eliminar un registro _afterDelete() Despu\u00e9s de eliminar un registro Herramientas y conceptos fundamentales Antes de escribir funciones espec\u00edficas, es importante conocer las herramientas que Ragnos proporciona dentro de los hooks para interactuar con los datos y el flujo de la aplicaci\u00f3n. 1. Estructura b\u00e1sica Los hooks de tipo _before* (Insert y Update) reciben por referencia el array $data , permitiendo modificar los valores antes de que lleguen a la base de datos. Si no necesitas modificar datos, en algunos casos puedes omitir el argumento o no usarlo. // Hook con manipulaci\u00f3n de datos (por referencia) protected function _beforeInsert(&$data) { $data['creado_el'] = date('Y-m-d'); } 2. Acceso a valores: newValue() y oldValue() Para facilitar la l\u00f3gica de negocio, Ragnos proporciona funciones helper para inspeccionar el estado de los datos: newValue('campo') : Valor que se est\u00e1 intentando guardar (payload de la petici\u00f3n). oldValue('campo') : Valor original que ya existe en la base de datos (antes de la modificaci\u00f3n). Helper Insert Update Delete newValue() \u2705 \u2705 \u274c oldValue() \u274c \u2705 \u2705 3. Detecci\u00f3n de cambios: fieldHasChanged() \u00datil especialmente en actualizaciones para ejecutar acciones solo si un campo espec\u00edfico ha sido modificado. if (fieldHasChanged('status')) { // Enviar notificaci\u00f3n de cambio de estatus } 4. Interrupci\u00f3n segura: raise() Si necesitas detener una operaci\u00f3n debido a una regla de negocio, usa raise() . Esto detiene el proceso y muestra un mensaje de error al usuario, evitando que la operaci\u00f3n CRUD contin\u00fae. if (oldValue('locked') === true) { raise('No se puede modificar un registro bloqueado.'); } Nota de Dise\u00f1o raise() es preferible a throw new Exception para errores de validaci\u00f3n l\u00f3gica (\"Soft errors\") que el usuario debe corregir. Hooks de Inserci\u00f3n Estos hooks se ejecutan durante la creaci\u00f3n de nuevos registros. _beforeInsert(&$data) Se ejecuta antes del INSERT. Recibe $data por referencia. Usos comunes: Inicializar valores autom\u00e1ticos (fechas, UUIDs). Normalizar datos (may\u00fasculas, formatos). Validaciones personalizadas del payload. protected function _beforeInsert(&$data) { // Asignar fecha de creaci\u00f3n manual $data['created_at'] = date('Y-m-d H:i:s'); // Forzar may\u00fasculas en el RFC if (isset($data['rfc'])) { $data['rfc'] = strtoupper($data['rfc']); } } _afterInsert() Se ejecuta despu\u00e9s de un INSERT exitoso. Usos comunes: Logs de auditor\u00eda. Env\u00edo de notificaciones de bienvenida. protected function _afterInsert() { log_message('info', 'Nuevo usuario registrado con ID ' . $this->insertID()); } Hooks de Actualizaci\u00f3n Estos hooks gestionan la modificaci\u00f3n de registros existentes. Es donde reside la mayor parte de la l\u00f3gica de negocio compleja. _beforeUpdate(&$data) Se ejecuta antes del UPDATE. Recibe $data con los campos a actualizar. Usos comunes: Validaciones de transici\u00f3n de estados. Registrar metadatos de edici\u00f3n ( updated_by ). Protecci\u00f3n de campos cr\u00edticos. protected function _beforeUpdate(&$data) { // Registrar qui\u00e9n modific\u00f3 el registro $data['updated_by'] = session('user_id'); // Validar regla de negocio: No reabrir tareas completadas if (oldValue('status') === 'completed' && newValue('status') === 'pending') { raise('No se puede reabrir una tarea completada.'); } } _afterUpdate() Se ejecuta despu\u00e9s de un UPDATE exitoso. Usos comunes: Invalidar cache. Recalcular datos dependientes en otras tablas. protected function _afterUpdate() { // Si cambi\u00f3 el l\u00edmite de cr\u00e9dito, invalidar el cache de estados de cuenta if (fieldHasChanged('creditLimit')) { \\Config\\Services::cache()->delete('estadosdecuenta'); } } Hooks de Eliminaci\u00f3n Gestionan el borrado de informaci\u00f3n. _beforeDelete() Se ejecuta antes del DELETE. Usos comunes: Validar dependencias (integridad referencial manual). Evitar borrado de registros del sistema. protected function _beforeDelete() { // Proteger al usuario Administrador (ID 1) if (oldValue('user_id') == 1) { raise('No se puede eliminar al usuario administrador principal.'); } // Verificar relaciones manualmente if ($this->hasRelations()) { raise('No se puede eliminar el registro porque tiene datos asociados.'); } } _afterDelete() Se ejecuta despu\u00e9s del DELETE. Usos comunes: Limpieza de archivos adjuntos (im\u00e1genes, documentos). Logs de actividad. protected function _afterDelete() { log_message('info', 'Registro eliminado correctamente.'); } Caso de Estudio: Cifrado de Contrase\u00f1as Este ejemplo real muestra c\u00f3mo combinar hooks para gestionar contrase\u00f1as de usuarios de forma segura. // Al crear, SIEMPRE se cifra la contrase\u00f1a public function _beforeInsert(&$userData) { $userData['usu_pword'] = md5(strtoupper($userData['usu_pword'])); } // Al editar, SOLO se cifra si el usuario escribi\u00f3 una nueva contrase\u00f1a public function _beforeUpdate(&$userData) { if (fieldHasChanged('usu_pword')) { $userData['usu_pword'] = md5(strtoupper($userData['usu_pword'])); } } Explicaci\u00f3n: En _beforeInsert , la contrase\u00f1a siempre viene en texto plano, as\u00ed que se cifra incondicionalmente. En _beforeUpdate , usamos fieldHasChanged para detectar si el usuario ingres\u00f3 una nueva clave. Si no se verifica esto, se podr\u00eda volver a cifrar el hash existente, corrompiendo la contrase\u00f1a. Hooks de Interfaz (UI) Ragnos permite intervenir tambi\u00e9n en la interfaz visual generada. _customFormDataFooter() Inserta HTML o scripts al pie del formulario de edici\u00f3n. function _customFormDataFooter() { $id = $this->request->getPost($this->getIdField()); // Retornamos una vista parcial return view('Tienda/detalle_pedidos', ['orderId' => $id]); } Buenas pr\u00e1cticas Recomendado Mant\u00e9n los hooks peque\u00f1os: La l\u00f3gica compleja debe ir a Servicios o Librer\u00edas. Documenta efectos secundarios: Si un hook altera otra tabla, deja un comentario claro. - Usa raise() para errores de validaci\u00f3n en lugar de excepciones duras. A evitar No reemplaces el controlador: Los hooks son para extender , no para reescribir el flujo CRUD. Cuidado con el SQL manual: Intenta usar los modelos siempre que sea posible. Filosof\u00eda Los hooks en Ragnos permiten extender sin romper : Desacoplamiento: No acoplan l\u00f3gica de negocio dura al mecanismo CRUD gen\u00e9rico. Declarativo: Mantienen el enfoque de configuraci\u00f3n sobre programaci\u00f3n. Mantenibilidad: Separan claramente la responsabilidad \"Qu\u00e9 guardar\" de \"Qu\u00e9 hacer cuando se guarda\". Filosof\u00eda Ragnos En Ragnos, los hooks no controlan el flujo: reaccionan al dominio.","title":"Hooks y eventos"},{"location":"avanzado/hooks/#hooks-y-ciclo-de-vida-en-ragnos","text":"En Ragnos, los hooks permiten ejecutar l\u00f3gica personalizada en distintos momentos del ciclo de vida de un dataset. Son el mecanismo principal para extender comportamiento sin romper el modelo declarativo. Los hooks se definen como m\u00e9todos protegidos dentro del controlador que extiende RDatasetController . Concepto Clave El controlador no implementa el CRUD manualmente. Ragnos se encarga de la operaci\u00f3n de base de datos, y t\u00fa solo \"te enganchas\" (hook) en los puntos clave para inyectar tu l\u00f3gica de negocio.","title":"Hooks y ciclo de vida en Ragnos"},{"location":"avanzado/hooks/#ciclo-de-vida-visual","text":"Entender el flujo de ejecuci\u00f3n es crucial para saber d\u00f3nde colocar tu l\u00f3gica. graph TD A[\"Petici\u00f3n del Usuario\"] --> B{\"Validaci\u00f3n de Campos\"} B -- Fallo --> Z[\"Mostrar Error\"] B -- \u00c9xito --> C{\"\u00bfExiste Hook _before*?\"} C -- S\u00ed --> D[\"Ejecutar _before*( )\"] D -- \"raise( )\" --> Z C -- No --> E[\"Operaci\u00f3n en Base de Datos\"] D -- \u00c9xito --> E E --> F{\"\u00bfOperaci\u00f3n Exitosa?\"} F -- No --> Z F -- S\u00ed --> G{\"\u00bfExiste Hook _after*?\"} G -- S\u00ed --> H[\"Ejecutar _after*( )\"] G -- No --> I[\"Respuesta Exitosa\"] H --> I","title":"Ciclo de Vida Visual"},{"location":"avanzado/hooks/#hooks-disponibles","text":"Ragnos expone los siguientes hooks, todos opcionales: Hook Momento de ejecuci\u00f3n _beforeInsert() Antes de insertar un registro _afterInsert() Despu\u00e9s de insertar un registro _beforeUpdate() Antes de actualizar un registro _afterUpdate() Despu\u00e9s de actualizar un registro _beforeDelete() Antes de eliminar un registro _afterDelete() Despu\u00e9s de eliminar un registro","title":"Hooks disponibles"},{"location":"avanzado/hooks/#herramientas-y-conceptos-fundamentales","text":"Antes de escribir funciones espec\u00edficas, es importante conocer las herramientas que Ragnos proporciona dentro de los hooks para interactuar con los datos y el flujo de la aplicaci\u00f3n.","title":"Herramientas y conceptos fundamentales"},{"location":"avanzado/hooks/#1-estructura-basica","text":"Los hooks de tipo _before* (Insert y Update) reciben por referencia el array $data , permitiendo modificar los valores antes de que lleguen a la base de datos. Si no necesitas modificar datos, en algunos casos puedes omitir el argumento o no usarlo. // Hook con manipulaci\u00f3n de datos (por referencia) protected function _beforeInsert(&$data) { $data['creado_el'] = date('Y-m-d'); }","title":"1. Estructura b\u00e1sica"},{"location":"avanzado/hooks/#2-acceso-a-valores-newvalue-y-oldvalue","text":"Para facilitar la l\u00f3gica de negocio, Ragnos proporciona funciones helper para inspeccionar el estado de los datos: newValue('campo') : Valor que se est\u00e1 intentando guardar (payload de la petici\u00f3n). oldValue('campo') : Valor original que ya existe en la base de datos (antes de la modificaci\u00f3n). Helper Insert Update Delete newValue() \u2705 \u2705 \u274c oldValue() \u274c \u2705 \u2705","title":"2. Acceso a valores: newValue() y oldValue()"},{"location":"avanzado/hooks/#3-deteccion-de-cambios-fieldhaschanged","text":"\u00datil especialmente en actualizaciones para ejecutar acciones solo si un campo espec\u00edfico ha sido modificado. if (fieldHasChanged('status')) { // Enviar notificaci\u00f3n de cambio de estatus }","title":"3. Detecci\u00f3n de cambios: fieldHasChanged()"},{"location":"avanzado/hooks/#4-interrupcion-segura-raise","text":"Si necesitas detener una operaci\u00f3n debido a una regla de negocio, usa raise() . Esto detiene el proceso y muestra un mensaje de error al usuario, evitando que la operaci\u00f3n CRUD contin\u00fae. if (oldValue('locked') === true) { raise('No se puede modificar un registro bloqueado.'); } Nota de Dise\u00f1o raise() es preferible a throw new Exception para errores de validaci\u00f3n l\u00f3gica (\"Soft errors\") que el usuario debe corregir.","title":"4. Interrupci\u00f3n segura: raise()"},{"location":"avanzado/hooks/#hooks-de-insercion","text":"Estos hooks se ejecutan durante la creaci\u00f3n de nuevos registros.","title":"Hooks de Inserci\u00f3n"},{"location":"avanzado/hooks/#_beforeinsertdata","text":"Se ejecuta antes del INSERT. Recibe $data por referencia. Usos comunes: Inicializar valores autom\u00e1ticos (fechas, UUIDs). Normalizar datos (may\u00fasculas, formatos). Validaciones personalizadas del payload. protected function _beforeInsert(&$data) { // Asignar fecha de creaci\u00f3n manual $data['created_at'] = date('Y-m-d H:i:s'); // Forzar may\u00fasculas en el RFC if (isset($data['rfc'])) { $data['rfc'] = strtoupper($data['rfc']); } }","title":"_beforeInsert(&amp;$data)"},{"location":"avanzado/hooks/#_afterinsert","text":"Se ejecuta despu\u00e9s de un INSERT exitoso. Usos comunes: Logs de auditor\u00eda. Env\u00edo de notificaciones de bienvenida. protected function _afterInsert() { log_message('info', 'Nuevo usuario registrado con ID ' . $this->insertID()); }","title":"_afterInsert()"},{"location":"avanzado/hooks/#hooks-de-actualizacion","text":"Estos hooks gestionan la modificaci\u00f3n de registros existentes. Es donde reside la mayor parte de la l\u00f3gica de negocio compleja.","title":"Hooks de Actualizaci\u00f3n"},{"location":"avanzado/hooks/#_beforeupdatedata","text":"Se ejecuta antes del UPDATE. Recibe $data con los campos a actualizar. Usos comunes: Validaciones de transici\u00f3n de estados. Registrar metadatos de edici\u00f3n ( updated_by ). Protecci\u00f3n de campos cr\u00edticos. protected function _beforeUpdate(&$data) { // Registrar qui\u00e9n modific\u00f3 el registro $data['updated_by'] = session('user_id'); // Validar regla de negocio: No reabrir tareas completadas if (oldValue('status') === 'completed' && newValue('status') === 'pending') { raise('No se puede reabrir una tarea completada.'); } }","title":"_beforeUpdate(&amp;$data)"},{"location":"avanzado/hooks/#_afterupdate","text":"Se ejecuta despu\u00e9s de un UPDATE exitoso. Usos comunes: Invalidar cache. Recalcular datos dependientes en otras tablas. protected function _afterUpdate() { // Si cambi\u00f3 el l\u00edmite de cr\u00e9dito, invalidar el cache de estados de cuenta if (fieldHasChanged('creditLimit')) { \\Config\\Services::cache()->delete('estadosdecuenta'); } }","title":"_afterUpdate()"},{"location":"avanzado/hooks/#hooks-de-eliminacion","text":"Gestionan el borrado de informaci\u00f3n.","title":"Hooks de Eliminaci\u00f3n"},{"location":"avanzado/hooks/#_beforedelete","text":"Se ejecuta antes del DELETE. Usos comunes: Validar dependencias (integridad referencial manual). Evitar borrado de registros del sistema. protected function _beforeDelete() { // Proteger al usuario Administrador (ID 1) if (oldValue('user_id') == 1) { raise('No se puede eliminar al usuario administrador principal.'); } // Verificar relaciones manualmente if ($this->hasRelations()) { raise('No se puede eliminar el registro porque tiene datos asociados.'); } }","title":"_beforeDelete()"},{"location":"avanzado/hooks/#_afterdelete","text":"Se ejecuta despu\u00e9s del DELETE. Usos comunes: Limpieza de archivos adjuntos (im\u00e1genes, documentos). Logs de actividad. protected function _afterDelete() { log_message('info', 'Registro eliminado correctamente.'); }","title":"_afterDelete()"},{"location":"avanzado/hooks/#caso-de-estudio-cifrado-de-contrasenas","text":"Este ejemplo real muestra c\u00f3mo combinar hooks para gestionar contrase\u00f1as de usuarios de forma segura. // Al crear, SIEMPRE se cifra la contrase\u00f1a public function _beforeInsert(&$userData) { $userData['usu_pword'] = md5(strtoupper($userData['usu_pword'])); } // Al editar, SOLO se cifra si el usuario escribi\u00f3 una nueva contrase\u00f1a public function _beforeUpdate(&$userData) { if (fieldHasChanged('usu_pword')) { $userData['usu_pword'] = md5(strtoupper($userData['usu_pword'])); } } Explicaci\u00f3n: En _beforeInsert , la contrase\u00f1a siempre viene en texto plano, as\u00ed que se cifra incondicionalmente. En _beforeUpdate , usamos fieldHasChanged para detectar si el usuario ingres\u00f3 una nueva clave. Si no se verifica esto, se podr\u00eda volver a cifrar el hash existente, corrompiendo la contrase\u00f1a.","title":"Caso de Estudio: Cifrado de Contrase\u00f1as"},{"location":"avanzado/hooks/#hooks-de-interfaz-ui","text":"Ragnos permite intervenir tambi\u00e9n en la interfaz visual generada.","title":"Hooks de Interfaz (UI)"},{"location":"avanzado/hooks/#_customformdatafooter","text":"Inserta HTML o scripts al pie del formulario de edici\u00f3n. function _customFormDataFooter() { $id = $this->request->getPost($this->getIdField()); // Retornamos una vista parcial return view('Tienda/detalle_pedidos', ['orderId' => $id]); }","title":"_customFormDataFooter()"},{"location":"avanzado/hooks/#buenas-practicas","text":"Recomendado Mant\u00e9n los hooks peque\u00f1os: La l\u00f3gica compleja debe ir a Servicios o Librer\u00edas. Documenta efectos secundarios: Si un hook altera otra tabla, deja un comentario claro. - Usa raise() para errores de validaci\u00f3n en lugar de excepciones duras. A evitar No reemplaces el controlador: Los hooks son para extender , no para reescribir el flujo CRUD. Cuidado con el SQL manual: Intenta usar los modelos siempre que sea posible.","title":"Buenas pr\u00e1cticas"},{"location":"avanzado/hooks/#filosofia","text":"Los hooks en Ragnos permiten extender sin romper : Desacoplamiento: No acoplan l\u00f3gica de negocio dura al mecanismo CRUD gen\u00e9rico. Declarativo: Mantienen el enfoque de configuraci\u00f3n sobre programaci\u00f3n. Mantenibilidad: Separan claramente la responsabilidad \"Qu\u00e9 guardar\" de \"Qu\u00e9 hacer cuando se guarda\". Filosof\u00eda Ragnos En Ragnos, los hooks no controlan el flujo: reaccionan al dominio.","title":"Filosof\u00eda"},{"location":"avanzado/server_side_events/","text":"\u23f3 Procesos de Larga Duraci\u00f3n con Server-Side Events (SSE) El framework Ragnos incluye una implementaci\u00f3n para manejar procesos de larga duraci\u00f3n en el servidor, permitiendo enviar actualizaciones de progreso en tiempo real al navegador del usuario utilizando Server-Side Events (SSE) . Esta funcionalidad es ideal para tareas que exceden el tiempo de espera habitual de una petici\u00f3n HTTP o donde el usuario necesita retroalimentaci\u00f3n visual del avance (barras de progreso). L\u00edmites de tiempo en PHP Aunque SSE permite mantener la conexi\u00f3n abierta, tu servidor web o configuraci\u00f3n de PHP ( max_execution_time ) podr\u00eda matar el proceso si dura demasiado. Aseg\u00farate de configurar set_time_limit(0) en tu l\u00f3gica si esperas procesos muy largos. Arquitectura El sistema se basa en dos componentes principales: App\\ThirdParty\\Ragnos\\Controllers\\RProcessController : Una clase base para los controladores que ejecutar\u00e1n procesos. process_helper.php : Un helper que contiene las funciones para gestionar el flujo de eventos SSE (cabeceras, env\u00edo de datos, control de bufer, etc.). Flujo de Trabajo El usuario accede a una acci\u00f3n del controlador que renderiza la vista de progreso (m\u00e9todo showProgress ). La vista conecta mediante JavaScript ( EventSource ) al m\u00e9todo start del mismo controlador. El m\u00e9todo start ejecuta la l\u00f3gica pesada, enviando eventos de progreso peri\u00f3dicamente mediante las funciones del helper. Al finalizar, el servidor env\u00eda un evento de finalizaci\u00f3n y cierra la conexi\u00f3n. Clase RProcessController Para crear un nuevo proceso, debes crear un controlador que extienda de RProcessController . Ubicaci\u00f3n : App\\Controllers\\ o cualquier subcarpeta, siempre que el namespace sea correcto. M\u00e9todos Principales __construct() : Carga autom\u00e1ticamente el process_helper . showProgress() : Muestra la interfaz de usuario con la barra de progreso. Calcula autom\u00e1ticamente la URL del endpoint start bas\u00e1ndose en el nombre de la clase. start() : Debe ser sobreescrito . Aqu\u00ed reside la l\u00f3gica de tu proceso larga duraci\u00f3n. Funciones del Helper (process_helper) Estas funciones est\u00e1n disponibles autom\u00e1ticamente dentro de tu controlador extendido. processStart($title = 'Processing...') Inicializa el proceso SSE. Limpia buffers de salida y establece las cabeceras text/event-stream . Deshabilita l\u00edmites de tiempo ( set_time_limit(0) ) y memoria en PHP para evitar timeouts. Env\u00eda el t\u00edtulo del proceso al cliente. setProgress($percentage) Actualiza la barra de progreso al porcentaje indicado. $percentage : N\u00famero entero (0-100). setProgressText($text) Actualiza el texto descriptivo debajo de la barra de progreso. \u00datil para informar al usuario qu\u00e9 se est\u00e1 haciendo exactamente (ej: \"Procesando fila 45...\"). setProgressOf($currentStep, $total) Una funci\u00f3n de utilidad que calcula el porcentaje autom\u00e1ticamente y llama a setProgress . $currentStep : El paso actual (iterador). $total : El total de pasos a realizar. endProcess($additionalData = null) Finaliza el proceso. Calcula el tiempo total de ejecuci\u00f3n. Env\u00eda el evento de finalizaci\u00f3n al cliente con datos opcionales. Termina la ejecuci\u00f3n del script ( exit ). Aplicaciones Comunes Esta funcionalidad es \u00fatil para: Importaciones Masivas : Carga de archivos Excel/CSV con miles de registros a la base de datos. Generaci\u00f3n de Reportes : Creaci\u00f3n de PDFs complejos o excels grandes. Mantenimiento : Tareas de limpieza, rec\u00e1lculo de precios, regeneraci\u00f3n de cach\u00e9 o im\u00e1genes. Env\u00edo de Correos Masivos : Env\u00edo de newsletters donde se requiere feedback de cada bloque enviado. Ejemplos de Implementaci\u00f3n Ejemplo 1: Rec\u00e1lculo de Precios (B\u00e1sico) Este ejemplo simula un proceso que itera sobre 100 elementos. <?php namespace App\\Controllers ; use App\\ThirdParty\\Ragnos\\Controllers\\RProcessController ; class RecalculoPrecios extends RProcessController { // M\u00e9todo principal que ejecuta la l\u00f3gica public function start () { // 1. Iniciar el proceso processStart ( 'Recalculando precios del cat\u00e1logo' ); $totalProductos = 100 ; for ( $i = 1 ; $i <= $totalProductos ; $i ++ ) { // Simulamos trabajo pesado usleep ( 100000 ); // 0.1 segundos // 2. Actualizar progreso (calcula % autom\u00e1ticamente) setProgressOf ( $i , $totalProductos ); // 3. Actualizar texto informativo setProgressText ( \"Actualizando producto ID: # { $i } \" ); } // 4. Finalizar endProcess ([ 'mensaje' => 'Se han actualizado los precios correctamente' , 'total' => $totalProductos ]); } } Ejemplo 2: Importaci\u00f3n de Usuarios (Con validaci\u00f3n) Un ejemplo m\u00e1s complejo simulando una importaci\u00f3n donde se valida informaci\u00f3n. <?php namespace App\\Controllers ; use App\\ThirdParty\\Ragnos\\Controllers\\RProcessController ; class ImportarUsuarios extends RProcessController { public function start () { processStart ( 'Importando Base de Datos de Usuarios' ); // Simular obtenci\u00f3n de datos (ej. leer un CSV) $usuarios = $this -> obtenerDatosSimulados ( 500 ); $total = count ( $usuarios ); $importados = 0 ; $errores = 0 ; foreach ( $usuarios as $index => $usuario ) { $paso = $index + 1 ; // L\u00f3gica de negocio simulada if ( $this -> guardarUsuario ( $usuario )) { $importados ++ ; setProgressText ( \"Usuario { $usuario [ 'nombre' ] } importado.\" ); } else { $errores ++ ; setProgressText ( \"Error importando { $usuario [ 'nombre' ] } .\" ); } // Actualizar barra de progreso cada 5 registros para no saturar la red // en procesos muy r\u00e1pidos if ( $paso % 5 === 0 || $paso === $total ) { setProgressOf ( $paso , $total ); } // Simular tiempo de base de datos usleep ( 20000 ); } endProcess ([ 'resultado' => \"Importaci\u00f3n finalizada. \u00c9xito: { $importados } , Errores: { $errores } \" ]); } private function obtenerDatosSimulados ( $qty ) { /* ... */ return array_fill ( 0 , $qty , [ 'nombre' => 'User' ]); } private function guardarUsuario ( $user ) { return rand ( 0 , 10 ) > 1 ; } } Ejemplo 3: Generaci\u00f3n de Copia de Seguridad <?php namespace App\\Controllers\\Admin ; use App\\ThirdParty\\Ragnos\\Controllers\\RProcessController ; class BackupSystem extends RProcessController { public function start () { processStart ( 'Generando Backup del Sistema' ); $steps = [ 'Comprimiendo im\u00e1genes...' , 'Exportando base de datos...' , 'Generando archivos de log...' , 'Empaquetando ZIP final...' ]; $totalSteps = count ( $steps ); foreach ( $steps as $index => $stepName ) { setProgressText ( $stepName ); // Simular tarea larga sleep ( 2 ); setProgressOf ( $index + 1 , $totalSteps ); } endProcess ([ 'file' => 'backup_2023.zip' ]); } }","title":"Server Side Events"},{"location":"avanzado/server_side_events/#procesos-de-larga-duracion-con-server-side-events-sse","text":"El framework Ragnos incluye una implementaci\u00f3n para manejar procesos de larga duraci\u00f3n en el servidor, permitiendo enviar actualizaciones de progreso en tiempo real al navegador del usuario utilizando Server-Side Events (SSE) . Esta funcionalidad es ideal para tareas que exceden el tiempo de espera habitual de una petici\u00f3n HTTP o donde el usuario necesita retroalimentaci\u00f3n visual del avance (barras de progreso). L\u00edmites de tiempo en PHP Aunque SSE permite mantener la conexi\u00f3n abierta, tu servidor web o configuraci\u00f3n de PHP ( max_execution_time ) podr\u00eda matar el proceso si dura demasiado. Aseg\u00farate de configurar set_time_limit(0) en tu l\u00f3gica si esperas procesos muy largos.","title":"\u23f3 Procesos de Larga Duraci\u00f3n con Server-Side Events (SSE)"},{"location":"avanzado/server_side_events/#arquitectura","text":"El sistema se basa en dos componentes principales: App\\ThirdParty\\Ragnos\\Controllers\\RProcessController : Una clase base para los controladores que ejecutar\u00e1n procesos. process_helper.php : Un helper que contiene las funciones para gestionar el flujo de eventos SSE (cabeceras, env\u00edo de datos, control de bufer, etc.).","title":"Arquitectura"},{"location":"avanzado/server_side_events/#flujo-de-trabajo","text":"El usuario accede a una acci\u00f3n del controlador que renderiza la vista de progreso (m\u00e9todo showProgress ). La vista conecta mediante JavaScript ( EventSource ) al m\u00e9todo start del mismo controlador. El m\u00e9todo start ejecuta la l\u00f3gica pesada, enviando eventos de progreso peri\u00f3dicamente mediante las funciones del helper. Al finalizar, el servidor env\u00eda un evento de finalizaci\u00f3n y cierra la conexi\u00f3n.","title":"Flujo de Trabajo"},{"location":"avanzado/server_side_events/#clase-rprocesscontroller","text":"Para crear un nuevo proceso, debes crear un controlador que extienda de RProcessController . Ubicaci\u00f3n : App\\Controllers\\ o cualquier subcarpeta, siempre que el namespace sea correcto.","title":"Clase RProcessController"},{"location":"avanzado/server_side_events/#metodos-principales","text":"__construct() : Carga autom\u00e1ticamente el process_helper . showProgress() : Muestra la interfaz de usuario con la barra de progreso. Calcula autom\u00e1ticamente la URL del endpoint start bas\u00e1ndose en el nombre de la clase. start() : Debe ser sobreescrito . Aqu\u00ed reside la l\u00f3gica de tu proceso larga duraci\u00f3n.","title":"M\u00e9todos Principales"},{"location":"avanzado/server_side_events/#funciones-del-helper-process_helper","text":"Estas funciones est\u00e1n disponibles autom\u00e1ticamente dentro de tu controlador extendido.","title":"Funciones del Helper (process_helper)"},{"location":"avanzado/server_side_events/#processstarttitle-processing","text":"Inicializa el proceso SSE. Limpia buffers de salida y establece las cabeceras text/event-stream . Deshabilita l\u00edmites de tiempo ( set_time_limit(0) ) y memoria en PHP para evitar timeouts. Env\u00eda el t\u00edtulo del proceso al cliente.","title":"processStart($title = 'Processing...')"},{"location":"avanzado/server_side_events/#setprogresspercentage","text":"Actualiza la barra de progreso al porcentaje indicado. $percentage : N\u00famero entero (0-100).","title":"setProgress($percentage)"},{"location":"avanzado/server_side_events/#setprogresstexttext","text":"Actualiza el texto descriptivo debajo de la barra de progreso. \u00datil para informar al usuario qu\u00e9 se est\u00e1 haciendo exactamente (ej: \"Procesando fila 45...\").","title":"setProgressText($text)"},{"location":"avanzado/server_side_events/#setprogressofcurrentstep-total","text":"Una funci\u00f3n de utilidad que calcula el porcentaje autom\u00e1ticamente y llama a setProgress . $currentStep : El paso actual (iterador). $total : El total de pasos a realizar.","title":"setProgressOf($currentStep, $total)"},{"location":"avanzado/server_side_events/#endprocessadditionaldata-null","text":"Finaliza el proceso. Calcula el tiempo total de ejecuci\u00f3n. Env\u00eda el evento de finalizaci\u00f3n al cliente con datos opcionales. Termina la ejecuci\u00f3n del script ( exit ).","title":"endProcess($additionalData = null)"},{"location":"avanzado/server_side_events/#aplicaciones-comunes","text":"Esta funcionalidad es \u00fatil para: Importaciones Masivas : Carga de archivos Excel/CSV con miles de registros a la base de datos. Generaci\u00f3n de Reportes : Creaci\u00f3n de PDFs complejos o excels grandes. Mantenimiento : Tareas de limpieza, rec\u00e1lculo de precios, regeneraci\u00f3n de cach\u00e9 o im\u00e1genes. Env\u00edo de Correos Masivos : Env\u00edo de newsletters donde se requiere feedback de cada bloque enviado.","title":"Aplicaciones Comunes"},{"location":"avanzado/server_side_events/#ejemplos-de-implementacion","text":"","title":"Ejemplos de Implementaci\u00f3n"},{"location":"avanzado/server_side_events/#ejemplo-1-recalculo-de-precios-basico","text":"Este ejemplo simula un proceso que itera sobre 100 elementos. <?php namespace App\\Controllers ; use App\\ThirdParty\\Ragnos\\Controllers\\RProcessController ; class RecalculoPrecios extends RProcessController { // M\u00e9todo principal que ejecuta la l\u00f3gica public function start () { // 1. Iniciar el proceso processStart ( 'Recalculando precios del cat\u00e1logo' ); $totalProductos = 100 ; for ( $i = 1 ; $i <= $totalProductos ; $i ++ ) { // Simulamos trabajo pesado usleep ( 100000 ); // 0.1 segundos // 2. Actualizar progreso (calcula % autom\u00e1ticamente) setProgressOf ( $i , $totalProductos ); // 3. Actualizar texto informativo setProgressText ( \"Actualizando producto ID: # { $i } \" ); } // 4. Finalizar endProcess ([ 'mensaje' => 'Se han actualizado los precios correctamente' , 'total' => $totalProductos ]); } }","title":"Ejemplo 1: Rec\u00e1lculo de Precios (B\u00e1sico)"},{"location":"avanzado/server_side_events/#ejemplo-2-importacion-de-usuarios-con-validacion","text":"Un ejemplo m\u00e1s complejo simulando una importaci\u00f3n donde se valida informaci\u00f3n. <?php namespace App\\Controllers ; use App\\ThirdParty\\Ragnos\\Controllers\\RProcessController ; class ImportarUsuarios extends RProcessController { public function start () { processStart ( 'Importando Base de Datos de Usuarios' ); // Simular obtenci\u00f3n de datos (ej. leer un CSV) $usuarios = $this -> obtenerDatosSimulados ( 500 ); $total = count ( $usuarios ); $importados = 0 ; $errores = 0 ; foreach ( $usuarios as $index => $usuario ) { $paso = $index + 1 ; // L\u00f3gica de negocio simulada if ( $this -> guardarUsuario ( $usuario )) { $importados ++ ; setProgressText ( \"Usuario { $usuario [ 'nombre' ] } importado.\" ); } else { $errores ++ ; setProgressText ( \"Error importando { $usuario [ 'nombre' ] } .\" ); } // Actualizar barra de progreso cada 5 registros para no saturar la red // en procesos muy r\u00e1pidos if ( $paso % 5 === 0 || $paso === $total ) { setProgressOf ( $paso , $total ); } // Simular tiempo de base de datos usleep ( 20000 ); } endProcess ([ 'resultado' => \"Importaci\u00f3n finalizada. \u00c9xito: { $importados } , Errores: { $errores } \" ]); } private function obtenerDatosSimulados ( $qty ) { /* ... */ return array_fill ( 0 , $qty , [ 'nombre' => 'User' ]); } private function guardarUsuario ( $user ) { return rand ( 0 , 10 ) > 1 ; } }","title":"Ejemplo 2: Importaci\u00f3n de Usuarios (Con validaci\u00f3n)"},{"location":"avanzado/server_side_events/#ejemplo-3-generacion-de-copia-de-seguridad","text":"<?php namespace App\\Controllers\\Admin ; use App\\ThirdParty\\Ragnos\\Controllers\\RProcessController ; class BackupSystem extends RProcessController { public function start () { processStart ( 'Generando Backup del Sistema' ); $steps = [ 'Comprimiendo im\u00e1genes...' , 'Exportando base de datos...' , 'Generando archivos de log...' , 'Empaquetando ZIP final...' ]; $totalSteps = count ( $steps ); foreach ( $steps as $index => $stepName ) { setProgressText ( $stepName ); // Simular tarea larga sleep ( 2 ); setProgressOf ( $index + 1 , $totalSteps ); } endProcess ([ 'file' => 'backup_2023.zip' ]); } }","title":"Ejemplo 3: Generaci\u00f3n de Copia de Seguridad"},{"location":"datasets/campos/","text":"Tipos de campo soportados en Ragnos En Ragnos, los campos de un dataset se definen mediante el m\u00e9todo addField() . Este m\u00e9todo es parte fundamental de la configuraci\u00f3n de un RDatasetController . Cada campo es una descripci\u00f3n declarativa de c\u00f3mo un atributo del dominio: Se valida Se muestra en formularios Se muestra en grillas Se persiste (o no) en base de datos Ragnos utiliza esta metadata para generar autom\u00e1ticamente formularios, validaciones, listados y comportamiento CRUD. 1. Estructura general de addField() $this->addField('nombreCampo', [ 'label' => 'Etiqueta visible', 'rules' => 'reglas|de|validacion', 'type' => 'tipo', 'query' => 'expresion SQL' ]); Par\u00e1metros comunes Par\u00e1metro Descripci\u00f3n label Texto visible en formularios y grillas rules Reglas de validaci\u00f3n (CI4 + Ragnos) type Tipo de campo (opcional) query Expresi\u00f3n SQL para campos calculados Reglas de Validaci\u00f3n Ragnos adopta el potente motor de validaci\u00f3n de CodeIgniter 4. Puedes usar reglas como required , is_unique , min_length , valid_email , etc. Consulta todas las reglas disponibles en la documentaci\u00f3n oficial de CodeIgniter 4 2. Campo de texto (string) $this->addField('customerName', [ 'label' => 'Nombre', 'rules' => 'required' ]); Persistente Editable Texto libre 3. Campo num\u00e9rico $this->addField('postalCode', [ 'label' => 'C\u00f3digo postal', 'rules' => 'required|numeric' ]); Persistente Editable Num\u00e9rico 4. Campo monetario ( money ) $this->addField('creditLimit', [ 'label' => 'L\u00edmite de cr\u00e9dito', 'rules' => 'required|money' ]); Validador custom Normalizaci\u00f3n autom\u00e1tica Uso financiero 5. Campo readonly $this->addField('Contacto', [ 'label' => 'Contacto', 'rules' => 'readonly' ]); Visible No editable 6. Campo hidden $this->addField('Contacto', [ 'label' => 'Contacto', 'rules' => 'readonly', 'type' => 'hidden' ]); No visible en formularios \u00datil para UX 7. Campo calculado ( query ) $this->addField('Contacto', [ 'label' => 'Contacto', 'rules' => 'readonly', 'query' => \"concat(contactLastName, ', ', contactFirstName)\", 'type' => 'hidden' ]); No persistente SQL din\u00e1mico Solo lectura 8. Campo relacionado ( addSearch ) $this->addSearch('salesRepEmployeeNumber', 'Tienda\\\\Empleados'); Clave for\u00e1nea l\u00f3gica Selector din\u00e1mico Sin JOIN manual 9. Campo clave primaria $this->setIdField('customerNumber'); Identidad del dataset Obligatorio Por defecto, los campos Id se consideran autoincrementales. Si no es el caso, se debe incluir expl\u00edcitamente $this->setAutoIncrement(false); . 10. Campo dropdown (enum) Breve descripci\u00f3n: un dropdown (enum) presenta un conjunto cerrado de opciones (clave => etiqueta). Se almacena la clave seleccionada en la base de datos; la etiqueta se usa solo para la interfaz. Configuraci\u00f3n t\u00edpica: type: \"dropdown\" options: array asociativo [valor => etiqueta] default: clave por defecto rules: validar con reglas CI4 (ej. required, in_list) se recomienda para listas cortas y estables; para grandes vol\u00famenes usar addSearch (selector relacionado). Ejemplo est\u00e1tico: $this->addField('status', [ 'label' => 'Estado', 'type' => 'dropdown', 'options' => [ 'shipped' => 'Enviado', 'pending' => 'Pendiente', 'cancelled' => 'Cancelado' ], 'default' => 'pending', 'rules' => 'required|in_list[shipped,pending,cancelled]' ]); Ejemplo din\u00e1mico (cargar desde DB): $rows = $this->db->table('categories')->select('id, name')->get()->getResultArray(); $options = array_column($rows, 'name', 'id'); $this->addField('categoryId', [ 'label' => 'Categor\u00eda', 'type' => 'dropdown', 'options' => $options, 'rules' => 'required|in_list[' . implode(',', array_keys($options)) . ']' ]); Placeholder / opci\u00f3n vac\u00eda: agregar una entrada con clave vac\u00eda para forzar selecci\u00f3n: 'options' => ['' => '(Seleccione)'] + $options Validaci\u00f3n y seguridad: Use in_list para evitar valores no permitidos. Si las opciones son din\u00e1micas, regenere la lista en cada carga de formulario para que la in_list coincida. UX y performance: Dropdown para <~20-30 opciones. Para relaciones con muchas filas, usar addSearch o un componente tipo autocompletar. Si necesita seleccionar m\u00faltiples valores, prefiera un componente multiselect (o un campo tipo relaci\u00f3n); no use dropdown simple. Internacionalizaci\u00f3n: almacene claves estables y traduzca etiquetas en la generaci\u00f3n de options para facilitar cambios de idioma. Persistencia: el valor guardado es la clave; si necesita guardar la etiqueta, considere un campo calculado o una vista. 11. Resumen Tipo Persistente Editable Texto S\u00ed S\u00ed Num\u00e9rico S\u00ed S\u00ed Money S\u00ed S\u00ed Readonly Depende No Hidden Depende No Calculado No No Relaci\u00f3n S\u00ed S\u00ed Dropdown S\u00ed S\u00ed Clave PK S\u00ed S\u00ed En Ragnos, los campos son declaraciones del dominio, no simples inputs.","title":"Referencia de Campos"},{"location":"datasets/campos/#tipos-de-campo-soportados-en-ragnos","text":"En Ragnos, los campos de un dataset se definen mediante el m\u00e9todo addField() . Este m\u00e9todo es parte fundamental de la configuraci\u00f3n de un RDatasetController . Cada campo es una descripci\u00f3n declarativa de c\u00f3mo un atributo del dominio: Se valida Se muestra en formularios Se muestra en grillas Se persiste (o no) en base de datos Ragnos utiliza esta metadata para generar autom\u00e1ticamente formularios, validaciones, listados y comportamiento CRUD.","title":"Tipos de campo soportados en Ragnos"},{"location":"datasets/campos/#1-estructura-general-de-addfield","text":"$this->addField('nombreCampo', [ 'label' => 'Etiqueta visible', 'rules' => 'reglas|de|validacion', 'type' => 'tipo', 'query' => 'expresion SQL' ]);","title":"1. Estructura general de addField()"},{"location":"datasets/campos/#parametros-comunes","text":"Par\u00e1metro Descripci\u00f3n label Texto visible en formularios y grillas rules Reglas de validaci\u00f3n (CI4 + Ragnos) type Tipo de campo (opcional) query Expresi\u00f3n SQL para campos calculados Reglas de Validaci\u00f3n Ragnos adopta el potente motor de validaci\u00f3n de CodeIgniter 4. Puedes usar reglas como required , is_unique , min_length , valid_email , etc. Consulta todas las reglas disponibles en la documentaci\u00f3n oficial de CodeIgniter 4","title":"Par\u00e1metros comunes"},{"location":"datasets/campos/#2-campo-de-texto-string","text":"$this->addField('customerName', [ 'label' => 'Nombre', 'rules' => 'required' ]); Persistente Editable Texto libre","title":"2. Campo de texto (string)"},{"location":"datasets/campos/#3-campo-numerico","text":"$this->addField('postalCode', [ 'label' => 'C\u00f3digo postal', 'rules' => 'required|numeric' ]); Persistente Editable Num\u00e9rico","title":"3. Campo num\u00e9rico"},{"location":"datasets/campos/#4-campo-monetario-money","text":"$this->addField('creditLimit', [ 'label' => 'L\u00edmite de cr\u00e9dito', 'rules' => 'required|money' ]); Validador custom Normalizaci\u00f3n autom\u00e1tica Uso financiero","title":"4. Campo monetario (money)"},{"location":"datasets/campos/#5-campo-readonly","text":"$this->addField('Contacto', [ 'label' => 'Contacto', 'rules' => 'readonly' ]); Visible No editable","title":"5. Campo readonly"},{"location":"datasets/campos/#6-campo-hidden","text":"$this->addField('Contacto', [ 'label' => 'Contacto', 'rules' => 'readonly', 'type' => 'hidden' ]); No visible en formularios \u00datil para UX","title":"6. Campo hidden"},{"location":"datasets/campos/#7-campo-calculado-query","text":"$this->addField('Contacto', [ 'label' => 'Contacto', 'rules' => 'readonly', 'query' => \"concat(contactLastName, ', ', contactFirstName)\", 'type' => 'hidden' ]); No persistente SQL din\u00e1mico Solo lectura","title":"7. Campo calculado (query)"},{"location":"datasets/campos/#8-campo-relacionado-addsearch","text":"$this->addSearch('salesRepEmployeeNumber', 'Tienda\\\\Empleados'); Clave for\u00e1nea l\u00f3gica Selector din\u00e1mico Sin JOIN manual","title":"8. Campo relacionado (addSearch)"},{"location":"datasets/campos/#9-campo-clave-primaria","text":"$this->setIdField('customerNumber'); Identidad del dataset Obligatorio Por defecto, los campos Id se consideran autoincrementales. Si no es el caso, se debe incluir expl\u00edcitamente $this->setAutoIncrement(false); .","title":"9. Campo clave primaria"},{"location":"datasets/campos/#10-campo-dropdown-enum","text":"Breve descripci\u00f3n: un dropdown (enum) presenta un conjunto cerrado de opciones (clave => etiqueta). Se almacena la clave seleccionada en la base de datos; la etiqueta se usa solo para la interfaz. Configuraci\u00f3n t\u00edpica: type: \"dropdown\" options: array asociativo [valor => etiqueta] default: clave por defecto rules: validar con reglas CI4 (ej. required, in_list) se recomienda para listas cortas y estables; para grandes vol\u00famenes usar addSearch (selector relacionado). Ejemplo est\u00e1tico: $this->addField('status', [ 'label' => 'Estado', 'type' => 'dropdown', 'options' => [ 'shipped' => 'Enviado', 'pending' => 'Pendiente', 'cancelled' => 'Cancelado' ], 'default' => 'pending', 'rules' => 'required|in_list[shipped,pending,cancelled]' ]); Ejemplo din\u00e1mico (cargar desde DB): $rows = $this->db->table('categories')->select('id, name')->get()->getResultArray(); $options = array_column($rows, 'name', 'id'); $this->addField('categoryId', [ 'label' => 'Categor\u00eda', 'type' => 'dropdown', 'options' => $options, 'rules' => 'required|in_list[' . implode(',', array_keys($options)) . ']' ]); Placeholder / opci\u00f3n vac\u00eda: agregar una entrada con clave vac\u00eda para forzar selecci\u00f3n: 'options' => ['' => '(Seleccione)'] + $options Validaci\u00f3n y seguridad: Use in_list para evitar valores no permitidos. Si las opciones son din\u00e1micas, regenere la lista en cada carga de formulario para que la in_list coincida. UX y performance: Dropdown para <~20-30 opciones. Para relaciones con muchas filas, usar addSearch o un componente tipo autocompletar. Si necesita seleccionar m\u00faltiples valores, prefiera un componente multiselect (o un campo tipo relaci\u00f3n); no use dropdown simple. Internacionalizaci\u00f3n: almacene claves estables y traduzca etiquetas en la generaci\u00f3n de options para facilitar cambios de idioma. Persistencia: el valor guardado es la clave; si necesita guardar la etiqueta, considere un campo calculado o una vista.","title":"10. Campo dropdown (enum)"},{"location":"datasets/campos/#11-resumen","text":"Tipo Persistente Editable Texto S\u00ed S\u00ed Num\u00e9rico S\u00ed S\u00ed Money S\u00ed S\u00ed Readonly Depende No Hidden Depende No Calculado No No Relaci\u00f3n S\u00ed S\u00ed Dropdown S\u00ed S\u00ed Clave PK S\u00ed S\u00ed En Ragnos, los campos son declaraciones del dominio, no simples inputs.","title":"11. Resumen"},{"location":"datasets/datasets/","text":"\ud83d\udcbe Datasets en Ragnos \u00bfQu\u00e9 es un Dataset? Un dataset ( RDatasetController ) es el concepto central de Ragnos para el desarrollo declarativo . En lugar de escribir controladores, modelos y vistas para cada m\u00f3dulo CRUD, un dataset permite definir la estructura y comportamiento de una entidad mediante metadatos en el constructor. El framework utiliza esta definici\u00f3n para generar autom\u00e1ticamente: Interfaces de usuario (Formularios y Grillas/Listados). Validaciones de entrada (Backend y Frontend). Consultas SQL y persistencia en base de datos. Respuestas para APIs. Ventajas Centralizaci\u00f3n : Todo (validaci\u00f3n, display, persistencia) se define en un solo lugar. Productividad : Elimina la necesidad de escribir HTML repetitivo o consultas CRUD b\u00e1sicas. Consistencia : Todos los m\u00f3dulos se comportan y lucen igual. Flexibilidad : Extensiones mediante Hooks y campos virtuales. Crear un dataset Un dataset es un controlador que extiende RDatasetController . Toda la configuraci\u00f3n se realiza en el constructor. Ejemplo m\u00ednimo namespace App\\Controllers\\Tienda; use App\\ThirdParty\\Ragnos\\Controllers\\RDatasetController; class Clientes extends RDatasetController { public function __construct() { parent::__construct(); // Seguridad y contexto $this->checkLogin(); $this->setTitle('Clientes'); // Persistencia $this->setTableName('customers'); $this->setIdField('customerNumber'); $this->setAutoIncrement(false); // Campos $this->addField('customerName', [ 'label' => 'Nombre', 'rules' => 'required' ]); // Campo calculado $this->addField('Contacto', [ 'label' => 'Contacto', 'rules' => 'readonly', 'query' => \"concat(contactLastName, ', ', contactFirstName)\", 'type' => 'hidden' ]); // Relaciones $this->addSearch('salesRepEmployeeNumber', 'Tienda\\\\Empleados'); // Grilla $this->setTableFields([ 'customerName', 'Contacto', 'salesRepEmployeeNumber' ]); } } Seguridad y contexto checkLogin() para requerir sesi\u00f3n activa. setTitle() para t\u00edtulo del m\u00f3dulo y breadcrumbs. Seguridad por defecto Siempre llama a checkLogin() al principio del constructor si tu m\u00f3dulo debe ser privado. Si olvidas esta l\u00ednea, el m\u00f3dulo ser\u00e1 accesible p\u00fablicamente. Tabla y clave primaria setTableName('table') define la tabla principal. !!! warning \"Coherencia con la BD\" El valor de setTableName debe coincidir exactamente con el nombre de la tabla f\u00edsica en tu base de datos. Ragnos no crea la tabla por ti; asume que ya existe. setIdField('id') establece la clave primaria. setAutoIncrement(true|false) controla si la PK es autoincremental. Definici\u00f3n de campos Use addField(name, options) para describir validaci\u00f3n, presentaci\u00f3n y persistencia. Para una referencia completa de todas las opciones y tipos de campo, consulta la Gu\u00eda de Campos . Opciones habituales: label : texto visible. rules : reglas de validaci\u00f3n (CI4 + validadores Ragnos como money , readonly ). type : text , hidden , etc. query : expresi\u00f3n SQL para campos virtuales. Ejemplos: Campo simple: required, texto. Campo num\u00e9rico: numeric . Monetario: rules => 'required|money' . Readonly / Hidden: visible en grilla, no editable. Calculado: query => \"concat(...)\" (no se persiste). Relaciones entre datasets Para relaciones m\u00e1s complejas tipo cabecera-lineas, consulta la gu\u00eda de Maestro-Detalle . addSearch(localField, 'Namespace\\\\Dataset') crea selectores y b\u00fasqueda asistida reutilizando otro dataset. No requiere joins manuales; facilita selectores din\u00e1micos y reutilizaci\u00f3n de l\u00f3gica. Configuraci\u00f3n de la grilla setTableFields([...]) define columnas visibles en el listado (DataTable). Puede incluir campos virtuales y etiquetas. setSortingFields([...]) para ordenar por defecto. Ciclo de vida (Hooks) Puedes intervenir en el ciclo de vida de los datos y de la interfaz mediante m\u00e9todos protegidos. \ud83d\udc49 Ver la Gu\u00eda Completa de Hooks y Eventos Tipos de campo soportados (resumen) Texto, Num\u00e9rico, Money (validador money ), Readonly, Hidden, Calculado ( query ), Relaci\u00f3n (v\u00eda addSearch ), Clave primaria. Campos con query o sin columna f\u00edsica no se insertan ni actualizan; solo se calculan en lectura. Qu\u00e9 NO se escribe en Ragnos Con RDatasetController no necesitas: Modelos CRUD manuales Controladores con SQL expl\u00edcito Formularios y validaciones duplicadas Todo se genera desde la metadata del dataset. Buenas Pr\u00e1cticas y Recomendaciones Dise\u00f1o First : Dise\u00f1a primero la base de datos de manera s\u00f3lida. Un dataset = una tabla : Cada dataset debe gestionar una tabla principal. Si necesitas vistas complejas, crea un RQueryController . Campos Virtuales : Usa query en addField para conciliar columnas (ej. nombre completo) en buscar/listar sin desnormalizar la BD. Centralizaci\u00f3n : Si una validaci\u00f3n es regla de negocio, ponla en rules del dataset, no en el cliente. Desacoplamiento : Usa los hooks para limpiar cach\u00e9 o loguear, pero evita poner l\u00f3gica de negocio pesada directamente en el controlador; llama a Servicios o Librer\u00edaa relaciones reutilizables. Centraliza l\u00f3gica en hooks. Pr\u00f3ximos pasos Crear nuevos datasets siguiendo este patr\u00f3n. Extender validadores y tipos. Integrar reportes y optimizar cache por eventos. Mantener la metadata consistente para escalabilidad.","title":"Creando Datasets"},{"location":"datasets/datasets/#datasets-en-ragnos","text":"","title":"\ud83d\udcbe Datasets en Ragnos"},{"location":"datasets/datasets/#que-es-un-dataset","text":"Un dataset ( RDatasetController ) es el concepto central de Ragnos para el desarrollo declarativo . En lugar de escribir controladores, modelos y vistas para cada m\u00f3dulo CRUD, un dataset permite definir la estructura y comportamiento de una entidad mediante metadatos en el constructor. El framework utiliza esta definici\u00f3n para generar autom\u00e1ticamente: Interfaces de usuario (Formularios y Grillas/Listados). Validaciones de entrada (Backend y Frontend). Consultas SQL y persistencia en base de datos. Respuestas para APIs.","title":"\u00bfQu\u00e9 es un Dataset?"},{"location":"datasets/datasets/#ventajas","text":"Centralizaci\u00f3n : Todo (validaci\u00f3n, display, persistencia) se define en un solo lugar. Productividad : Elimina la necesidad de escribir HTML repetitivo o consultas CRUD b\u00e1sicas. Consistencia : Todos los m\u00f3dulos se comportan y lucen igual. Flexibilidad : Extensiones mediante Hooks y campos virtuales.","title":"Ventajas"},{"location":"datasets/datasets/#crear-un-dataset","text":"Un dataset es un controlador que extiende RDatasetController . Toda la configuraci\u00f3n se realiza en el constructor.","title":"Crear un dataset"},{"location":"datasets/datasets/#ejemplo-minimo","text":"namespace App\\Controllers\\Tienda; use App\\ThirdParty\\Ragnos\\Controllers\\RDatasetController; class Clientes extends RDatasetController { public function __construct() { parent::__construct(); // Seguridad y contexto $this->checkLogin(); $this->setTitle('Clientes'); // Persistencia $this->setTableName('customers'); $this->setIdField('customerNumber'); $this->setAutoIncrement(false); // Campos $this->addField('customerName', [ 'label' => 'Nombre', 'rules' => 'required' ]); // Campo calculado $this->addField('Contacto', [ 'label' => 'Contacto', 'rules' => 'readonly', 'query' => \"concat(contactLastName, ', ', contactFirstName)\", 'type' => 'hidden' ]); // Relaciones $this->addSearch('salesRepEmployeeNumber', 'Tienda\\\\Empleados'); // Grilla $this->setTableFields([ 'customerName', 'Contacto', 'salesRepEmployeeNumber' ]); } }","title":"Ejemplo m\u00ednimo"},{"location":"datasets/datasets/#seguridad-y-contexto","text":"checkLogin() para requerir sesi\u00f3n activa. setTitle() para t\u00edtulo del m\u00f3dulo y breadcrumbs. Seguridad por defecto Siempre llama a checkLogin() al principio del constructor si tu m\u00f3dulo debe ser privado. Si olvidas esta l\u00ednea, el m\u00f3dulo ser\u00e1 accesible p\u00fablicamente.","title":"Seguridad y contexto"},{"location":"datasets/datasets/#tabla-y-clave-primaria","text":"setTableName('table') define la tabla principal. !!! warning \"Coherencia con la BD\" El valor de setTableName debe coincidir exactamente con el nombre de la tabla f\u00edsica en tu base de datos. Ragnos no crea la tabla por ti; asume que ya existe. setIdField('id') establece la clave primaria. setAutoIncrement(true|false) controla si la PK es autoincremental.","title":"Tabla y clave primaria"},{"location":"datasets/datasets/#definicion-de-campos","text":"Use addField(name, options) para describir validaci\u00f3n, presentaci\u00f3n y persistencia. Para una referencia completa de todas las opciones y tipos de campo, consulta la Gu\u00eda de Campos . Opciones habituales: label : texto visible. rules : reglas de validaci\u00f3n (CI4 + validadores Ragnos como money , readonly ). type : text , hidden , etc. query : expresi\u00f3n SQL para campos virtuales. Ejemplos: Campo simple: required, texto. Campo num\u00e9rico: numeric . Monetario: rules => 'required|money' . Readonly / Hidden: visible en grilla, no editable. Calculado: query => \"concat(...)\" (no se persiste).","title":"Definici\u00f3n de campos"},{"location":"datasets/datasets/#relaciones-entre-datasets","text":"Para relaciones m\u00e1s complejas tipo cabecera-lineas, consulta la gu\u00eda de Maestro-Detalle . addSearch(localField, 'Namespace\\\\Dataset') crea selectores y b\u00fasqueda asistida reutilizando otro dataset. No requiere joins manuales; facilita selectores din\u00e1micos y reutilizaci\u00f3n de l\u00f3gica.","title":"Relaciones entre datasets"},{"location":"datasets/datasets/#configuracion-de-la-grilla","text":"setTableFields([...]) define columnas visibles en el listado (DataTable). Puede incluir campos virtuales y etiquetas. setSortingFields([...]) para ordenar por defecto.","title":"Configuraci\u00f3n de la grilla"},{"location":"datasets/datasets/#ciclo-de-vida-hooks","text":"Puedes intervenir en el ciclo de vida de los datos y de la interfaz mediante m\u00e9todos protegidos. \ud83d\udc49 Ver la Gu\u00eda Completa de Hooks y Eventos","title":"Ciclo de vida (Hooks)"},{"location":"datasets/datasets/#tipos-de-campo-soportados-resumen","text":"Texto, Num\u00e9rico, Money (validador money ), Readonly, Hidden, Calculado ( query ), Relaci\u00f3n (v\u00eda addSearch ), Clave primaria. Campos con query o sin columna f\u00edsica no se insertan ni actualizan; solo se calculan en lectura.","title":"Tipos de campo soportados (resumen)"},{"location":"datasets/datasets/#que-no-se-escribe-en-ragnos","text":"Con RDatasetController no necesitas: Modelos CRUD manuales Controladores con SQL expl\u00edcito Formularios y validaciones duplicadas Todo se genera desde la metadata del dataset. Buenas Pr\u00e1cticas y Recomendaciones Dise\u00f1o First : Dise\u00f1a primero la base de datos de manera s\u00f3lida. Un dataset = una tabla : Cada dataset debe gestionar una tabla principal. Si necesitas vistas complejas, crea un RQueryController . Campos Virtuales : Usa query en addField para conciliar columnas (ej. nombre completo) en buscar/listar sin desnormalizar la BD. Centralizaci\u00f3n : Si una validaci\u00f3n es regla de negocio, ponla en rules del dataset, no en el cliente. Desacoplamiento : Usa los hooks para limpiar cach\u00e9 o loguear, pero evita poner l\u00f3gica de negocio pesada directamente en el controlador; llama a Servicios o Librer\u00edaa relaciones reutilizables. Centraliza l\u00f3gica en hooks.","title":"Qu\u00e9 NO se escribe en Ragnos"},{"location":"datasets/datasets/#proximos-pasos","text":"Crear nuevos datasets siguiendo este patr\u00f3n. Extender validadores y tipos. Integrar reportes y optimizar cache por eventos. Mantener la metadata consistente para escalabilidad.","title":"Pr\u00f3ximos pasos"},{"location":"datasets/guia_RQueryController/","text":"Gu\u00eda de Referencia: RQueryController RQueryController es una variante especializada del controlador base de Ragnos dise\u00f1ada para consultas de solo lectura y b\u00fasquedas avanzadas . A diferencia de RDatasetController (que se mapea a una tabla f\u00edsica para hacer CRUD), RQueryController se mapea a una Sentencia SQL Arbitraria . \ud83c\udfaf \u00bfCu\u00e1ndo usar RQueryController? Usa este controlador cuando: No necesitas editar: Solo quieres listar, buscar y filtrar datos. La data es compleja: Necesitas hacer JOINs , subconsultas o campos calculados (ej. CONCAT , CASE WHEN ) que no existen en una sola tabla f\u00edsica. Reportes R\u00e1pidos: Quieres exponer una vista de base de datos en el sistema administrativo r\u00e1pidamente. \ud83e\uddec Estructura B\u00e1sica Un controlador de consulta extiende de RQueryController y define su l\u00f3gica en el constructor. Ejemplo Analizado: Searchusuarios.php namespace App\\Controllers; use App\\ThirdParty\\Ragnos\\Controllers\\RQueryController; class Searchusuarios extends RQueryController { public function __construct() { parent::__construct(); // 1. Seguridad $this->checkUserInGroup('Administrador'); // 2. Configuraci\u00f3n Visual $this->setTitle('\ud83d\udd0e Usuarios'); // 3. La Fuente de Datos (SQL) $this->setQuery(\"SELECT usu_id, usu_nombre as 'Nombre', usu_login as 'Login', usu_activo as Activo, usu_grupo FROM gen_usuarios\"); // 4. Clave Primaria (Virtual o Real) $this->setIdField('usu_id'); // 5. Configuraci\u00f3n de Campos (Filtros y Visualizaci\u00f3n) $this->addField('Activo', [ 'label' => 'Activo', 'type' => 'dropdown', 'options' => ['S' => 'SI', 'N' => 'NO'], ]); $this->addField('usu_grupo', ['label' => 'Grupo']); // 6. Relaciones para B\u00fasqueda $this->addSearch('usu_grupo', 'Gruposdeusuarios'); // 7. Definici\u00f3n de la Grilla $this->setTableFields(['Nombre', 'Login', 'Activo', 'usu_grupo']); } } \ud83d\udcda M\u00e9todos Clave setQuery(string $sql) Define la fuente de datos. Importante: No uses ORDER BY o LIMIT aqu\u00ed; Ragnos los inyecta din\u00e1micamente seg\u00fan la interacci\u00f3n del usuario en la grilla. Alias: Es muy recomendable usar alias SQL ( AS 'Nombre' ) para que los encabezados de la tabla sean legibles autom\u00e1ticamente. setIdField(string $field) Aunque sea una consulta personalizada, Ragnos necesita saber cu\u00e1l es la columna que identifica un\u00edvocamente a cada fila (para selecci\u00f3n, detalles, etc.). Debe estar presente en el SELECT de setQuery . addField(string $name, array $config) Funciona igual que en RDatasetController , pero aqu\u00ed se usa principalmente para generar los filtros de b\u00fasqueda . Si defines un campo como 'type' => 'dropdown' , Ragnos crear\u00e1 un <select> en la barra de b\u00fasqueda avanzada. addSearch(string $field, string $controller) Permite vincular una columna de tu consulta con otro controlador Ragnos. Esto habilita el icono de lupa para buscar valores relacionados. checkUserInGroup(string|array $groups) Restringe el acceso a este controlador exclusivamente a los grupos de usuarios especificados. \u26a0\ufe0f Diferencias con RDatasetController Caracter\u00edstica RDatasetController RQueryController Fuente de Datos setTableName('tabla') setQuery('SELECT...') Edici\u00f3n (Save/Update) \u2705 Soportado (Autom\u00e1tico) \u274c No soportado Eliminaci\u00f3n (Delete) \u2705 Soportado \u274c No soportado Nuevo Registro \u2705 Soportado \u274c No soportado Uso Principal CRUDs (Cat\u00e1logos) Reportes, Dashboards, Buscadores \ud83d\udca1 Tips de Implementaci\u00f3n Campos Calculados: Puedes crear columnas \"virtuales\" en el SQL y usarlas en la grilla: $this->setQuery(\"SELECT id, precio * cantidad AS Total, ... FROM ventas\"); $this->setTableFields(['id', 'Total']); Uniones (JOINs): Ideal para mostrar nombres en lugar de IDs sin configurar addSearch visualmente: $this->setQuery(\" SELECT p.nombre, c.categoria_nombre FROM productos p JOIN categorias c ON p.cat_id = c.id \");","title":"Consultas Avanzadas (RQuery)"},{"location":"datasets/guia_RQueryController/#guia-de-referencia-rquerycontroller","text":"RQueryController es una variante especializada del controlador base de Ragnos dise\u00f1ada para consultas de solo lectura y b\u00fasquedas avanzadas . A diferencia de RDatasetController (que se mapea a una tabla f\u00edsica para hacer CRUD), RQueryController se mapea a una Sentencia SQL Arbitraria .","title":"Gu\u00eda de Referencia: RQueryController"},{"location":"datasets/guia_RQueryController/#cuando-usar-rquerycontroller","text":"Usa este controlador cuando: No necesitas editar: Solo quieres listar, buscar y filtrar datos. La data es compleja: Necesitas hacer JOINs , subconsultas o campos calculados (ej. CONCAT , CASE WHEN ) que no existen en una sola tabla f\u00edsica. Reportes R\u00e1pidos: Quieres exponer una vista de base de datos en el sistema administrativo r\u00e1pidamente.","title":"\ud83c\udfaf \u00bfCu\u00e1ndo usar RQueryController?"},{"location":"datasets/guia_RQueryController/#estructura-basica","text":"Un controlador de consulta extiende de RQueryController y define su l\u00f3gica en el constructor. Ejemplo Analizado: Searchusuarios.php namespace App\\Controllers; use App\\ThirdParty\\Ragnos\\Controllers\\RQueryController; class Searchusuarios extends RQueryController { public function __construct() { parent::__construct(); // 1. Seguridad $this->checkUserInGroup('Administrador'); // 2. Configuraci\u00f3n Visual $this->setTitle('\ud83d\udd0e Usuarios'); // 3. La Fuente de Datos (SQL) $this->setQuery(\"SELECT usu_id, usu_nombre as 'Nombre', usu_login as 'Login', usu_activo as Activo, usu_grupo FROM gen_usuarios\"); // 4. Clave Primaria (Virtual o Real) $this->setIdField('usu_id'); // 5. Configuraci\u00f3n de Campos (Filtros y Visualizaci\u00f3n) $this->addField('Activo', [ 'label' => 'Activo', 'type' => 'dropdown', 'options' => ['S' => 'SI', 'N' => 'NO'], ]); $this->addField('usu_grupo', ['label' => 'Grupo']); // 6. Relaciones para B\u00fasqueda $this->addSearch('usu_grupo', 'Gruposdeusuarios'); // 7. Definici\u00f3n de la Grilla $this->setTableFields(['Nombre', 'Login', 'Activo', 'usu_grupo']); } }","title":"\ud83e\uddec Estructura B\u00e1sica"},{"location":"datasets/guia_RQueryController/#metodos-clave","text":"","title":"\ud83d\udcda M\u00e9todos Clave"},{"location":"datasets/guia_RQueryController/#setquerystring-sql","text":"Define la fuente de datos. Importante: No uses ORDER BY o LIMIT aqu\u00ed; Ragnos los inyecta din\u00e1micamente seg\u00fan la interacci\u00f3n del usuario en la grilla. Alias: Es muy recomendable usar alias SQL ( AS 'Nombre' ) para que los encabezados de la tabla sean legibles autom\u00e1ticamente.","title":"setQuery(string $sql)"},{"location":"datasets/guia_RQueryController/#setidfieldstring-field","text":"Aunque sea una consulta personalizada, Ragnos necesita saber cu\u00e1l es la columna que identifica un\u00edvocamente a cada fila (para selecci\u00f3n, detalles, etc.). Debe estar presente en el SELECT de setQuery .","title":"setIdField(string $field)"},{"location":"datasets/guia_RQueryController/#addfieldstring-name-array-config","text":"Funciona igual que en RDatasetController , pero aqu\u00ed se usa principalmente para generar los filtros de b\u00fasqueda . Si defines un campo como 'type' => 'dropdown' , Ragnos crear\u00e1 un <select> en la barra de b\u00fasqueda avanzada.","title":"addField(string $name, array $config)"},{"location":"datasets/guia_RQueryController/#addsearchstring-field-string-controller","text":"Permite vincular una columna de tu consulta con otro controlador Ragnos. Esto habilita el icono de lupa para buscar valores relacionados.","title":"addSearch(string $field, string $controller)"},{"location":"datasets/guia_RQueryController/#checkuseringroupstringarray-groups","text":"Restringe el acceso a este controlador exclusivamente a los grupos de usuarios especificados.","title":"checkUserInGroup(string|array $groups)"},{"location":"datasets/guia_RQueryController/#diferencias-con-rdatasetcontroller","text":"Caracter\u00edstica RDatasetController RQueryController Fuente de Datos setTableName('tabla') setQuery('SELECT...') Edici\u00f3n (Save/Update) \u2705 Soportado (Autom\u00e1tico) \u274c No soportado Eliminaci\u00f3n (Delete) \u2705 Soportado \u274c No soportado Nuevo Registro \u2705 Soportado \u274c No soportado Uso Principal CRUDs (Cat\u00e1logos) Reportes, Dashboards, Buscadores","title":"\u26a0\ufe0f Diferencias con RDatasetController"},{"location":"datasets/guia_RQueryController/#tips-de-implementacion","text":"Campos Calculados: Puedes crear columnas \"virtuales\" en el SQL y usarlas en la grilla: $this->setQuery(\"SELECT id, precio * cantidad AS Total, ... FROM ventas\"); $this->setTableFields(['id', 'Total']); Uniones (JOINs): Ideal para mostrar nombres en lugar de IDs sin configurar addSearch visualmente: $this->setQuery(\" SELECT p.nombre, c.categoria_nombre FROM productos p JOIN categorias c ON p.cat_id = c.id \");","title":"\ud83d\udca1 Tips de Implementaci\u00f3n"},{"location":"datasets/maestro-detalle/","text":"\ud83d\udcd1 Relaci\u00f3n Maestro-Detalle en Ragnos Esta gu\u00eda explica c\u00f3mo crear una pantalla donde tienes un registro principal (como una Orden de compra ) y una lista de elementos relacionados (los Detalles o productos de esa orden). Arquitectura de la Relaci\u00f3n graph TD User[\"Usuario\"] -->|Abre Pantalla| Master[\"Controlador Maestro (Ordenes)\"] Master -->|Renderiza| View[\"Vista Principal\"] View -->|Contiene| Form[\"Formulario Maestro\"] subgraph Vinculacion [\"L\u00f3gica de Vinculaci\u00f3n\"] direction TB Form -->|\"ID Orden\"| Logic{\"\u00bfExiste Orden?\"} Logic -- NO --> Info(\"Solo muestra Formulario\") Logic -- \"SI (ID=100)\" --> LoadDetails[\"Carga Controlador Detalle\"] end LoadDetails -->|\"Inyecta ID=100 como $this->master\"| Detail[\"Controlador Detalle (OrdenesDetalles)\"] subgraph Detalle [\"Zona del Detalle\"] direction TB Detail -->|Aplica Filtro| Filter[\"WHERE orderNumber = 100\"] Filter -->|Muestra| Grid[\"Grilla de Productos\"] Grid -->|Nuevo Registro| NewLine[\"Formulario Detalle\"] NewLine -->|Campo Oculto| Hidden[\"orderNumber = 100\"] end %% Estilos Profesionales classDef mainNode fill:#f9f,stroke:#333,stroke-width:2px; classDef detailNode fill:#bbf,stroke:#333,stroke-width:2px; classDef logicNode fill:#fff9c4,stroke:#fbc02d,stroke-width:2px; style Master fill:#e1bee7,stroke:#4a148c,stroke-width:2px style Detail fill:#bbdefb,stroke:#0d47a1,stroke-width:2px style Hidden fill:#c8e6c9,stroke:#2e7d32,stroke-dasharray: 5 5 La idea b\u00e1sica es tener dos controladores: El Maestro (Ordenes): Controla la informaci\u00f3n general (fecha, cliente, total). El Detalle (OrdenesDetalles): Controla la lista de productos dentro de esa orden. 1. Configurando el Maestro (Controlador Ordenes ) Este es el \"padre\" de la relaci\u00f3n. Aqu\u00ed definimos la cabecera de la factura. Configuraci\u00f3n b\u00e1sica: Le decimos a Ragnos que use la tabla orders y que la clave principal es orderNumber . Campos: Definimos los campos normales como fecha ( orderDate ), estado ( status ) y cliente ( customerNumber ). Campo Total (Calculado): Para mostrar el total de la orden sin guardarlo manualmente, usamos una peque\u00f1a consulta SQL dentro de la configuraci\u00f3n del campo. Esta consulta suma cantidad * precio de la tabla de detalles. Activar el modo detalle: Hay una l\u00ednea clave que debes agregar en tu controlador maestro para avisar que tendr\u00e1 \"hijos\": $this->setDetailsController('Tienda\\Ordenesdetalles'); Esto le dice a Ragnos que el controlador Ordenesdetalles manejar\u00e1 los detalles relacionados con cada orden. La relaci\u00f3n se basa en que el campo orderNumber en ambos controladores es el mismo, y este es la llave primaria en el maestro. 2. Configurando el Detalle (Controlador Ordenesdetalles ) Este es el \"hijo\". Controla cada l\u00ednea de producto. El truco del campo oculto: Necesitamos que cada producto sepa a qu\u00e9 orden pertenece. Para eso, en el campo orderNumber del detalle hacemos dos cosas: Lo ponemos como hidden (oculto) para que el usuario no lo toque. Le asignamos el valor por defecto $this->master . \u00bfQu\u00e9 hace esto? Cuando creas un detalle desde la orden #100, Ragnos autom\u00e1ticamente rellena este campo con el n\u00famero 100. Filtrar los datos: No queremos ver todos los productos de todas las \u00f3rdenes. En el m\u00e9todo _filters() , agregamos una regla para que solo se carguen los productos que coincidan con el ID del maestro actual ( $this->master ). function _filters() { $this->modelo->builder()->where('orderNumber', $this->master); } En este fragmento, $this->modelo->builder() permite interactuar directamente con la consulta SQL que generar\u00e1 la grilla. La variable $this->master es inyectada autom\u00e1ticamente por el framework cuando detecta que este controlador se est\u00e1 ejecutando como \"hijo\", y contiene el ID del registro que se est\u00e1 visualizando en el maestro (en este caso, el n\u00famero de orden). Actualizar cambios: Usamos funciones especiales (llamadas hooks ) como _afterInsert o _afterUpdate para limpiar la memoria cach\u00e9. Esto asegura que si agregas un producto, el total de la orden principal se recalcule correctamente. \ud83d\udc49 Ver Gu\u00eda de Hooks Hooks de javascript personalizados (Opcional) En el archivo custom.js se ha agregado la siguiente funci\u00f3n: // con cada cambio en la tabla de detalles de ordenes // recalcula el total de la orden function _OrdenesdetallesOnChange ( tabla ) { let orden = $ ( \"input[name='orderNumber']\" ). val (); getObject ( \"tienda/ordenes/calculatotal\" , { orden : orden }, function ( data ) { $ ( 'input[name=\"total\"]' ). val ( data . total ); }); } Esta funci\u00f3n se ejecuta cada vez que hay un cambio en la tabla de detalles de \u00f3rdenes. Lo que hace es: Obtiene el n\u00famero de orden actual desde el campo oculto. Llama a un endpoint ( tienda/ordenes/calculatotal ) para recalcular el total de la orden. Actualiza el campo total en la pantalla con el nuevo valor. de este modo, el total siempre estar\u00e1 actualizado, cada que se agregue, modifique o elimine un producto en la orden. Esta funci\u00f3n se enlaza autom\u00e1ticamente gracias a la convenci\u00f3n de nombres: _NombreDelControladorOnChange . Resumen del flujo de trabajo Abres una Orden: Ves los datos generales (Maestro). El sistema verifica: \u00bfEsta orden ya existe? S\u00ed: Carga autom\u00e1ticamente la tabla de productos relacionados al final de la pantalla. No: Oculta la secci\u00f3n de productos hasta que guardes la orden por primera vez. Agregas un producto: Al crear una l\u00ednea en la tabla de detalles, el sistema le pega invisiblemente el n\u00famero de la orden padre. Guardas: Al guardar el detalle, el sistema actualiza los totales y todo se mantiene sincronizado. \u00a1Y listo! Con estos pasos logras que dos tablas funcionen como una sola pantalla integrada.","title":"Maestro-Detalle"},{"location":"datasets/maestro-detalle/#relacion-maestro-detalle-en-ragnos","text":"Esta gu\u00eda explica c\u00f3mo crear una pantalla donde tienes un registro principal (como una Orden de compra ) y una lista de elementos relacionados (los Detalles o productos de esa orden).","title":"\ud83d\udcd1 Relaci\u00f3n Maestro-Detalle en Ragnos"},{"location":"datasets/maestro-detalle/#arquitectura-de-la-relacion","text":"graph TD User[\"Usuario\"] -->|Abre Pantalla| Master[\"Controlador Maestro (Ordenes)\"] Master -->|Renderiza| View[\"Vista Principal\"] View -->|Contiene| Form[\"Formulario Maestro\"] subgraph Vinculacion [\"L\u00f3gica de Vinculaci\u00f3n\"] direction TB Form -->|\"ID Orden\"| Logic{\"\u00bfExiste Orden?\"} Logic -- NO --> Info(\"Solo muestra Formulario\") Logic -- \"SI (ID=100)\" --> LoadDetails[\"Carga Controlador Detalle\"] end LoadDetails -->|\"Inyecta ID=100 como $this->master\"| Detail[\"Controlador Detalle (OrdenesDetalles)\"] subgraph Detalle [\"Zona del Detalle\"] direction TB Detail -->|Aplica Filtro| Filter[\"WHERE orderNumber = 100\"] Filter -->|Muestra| Grid[\"Grilla de Productos\"] Grid -->|Nuevo Registro| NewLine[\"Formulario Detalle\"] NewLine -->|Campo Oculto| Hidden[\"orderNumber = 100\"] end %% Estilos Profesionales classDef mainNode fill:#f9f,stroke:#333,stroke-width:2px; classDef detailNode fill:#bbf,stroke:#333,stroke-width:2px; classDef logicNode fill:#fff9c4,stroke:#fbc02d,stroke-width:2px; style Master fill:#e1bee7,stroke:#4a148c,stroke-width:2px style Detail fill:#bbdefb,stroke:#0d47a1,stroke-width:2px style Hidden fill:#c8e6c9,stroke:#2e7d32,stroke-dasharray: 5 5 La idea b\u00e1sica es tener dos controladores: El Maestro (Ordenes): Controla la informaci\u00f3n general (fecha, cliente, total). El Detalle (OrdenesDetalles): Controla la lista de productos dentro de esa orden.","title":"Arquitectura de la Relaci\u00f3n"},{"location":"datasets/maestro-detalle/#1-configurando-el-maestro-controlador-ordenes","text":"Este es el \"padre\" de la relaci\u00f3n. Aqu\u00ed definimos la cabecera de la factura. Configuraci\u00f3n b\u00e1sica: Le decimos a Ragnos que use la tabla orders y que la clave principal es orderNumber . Campos: Definimos los campos normales como fecha ( orderDate ), estado ( status ) y cliente ( customerNumber ). Campo Total (Calculado): Para mostrar el total de la orden sin guardarlo manualmente, usamos una peque\u00f1a consulta SQL dentro de la configuraci\u00f3n del campo. Esta consulta suma cantidad * precio de la tabla de detalles. Activar el modo detalle: Hay una l\u00ednea clave que debes agregar en tu controlador maestro para avisar que tendr\u00e1 \"hijos\": $this->setDetailsController('Tienda\\Ordenesdetalles'); Esto le dice a Ragnos que el controlador Ordenesdetalles manejar\u00e1 los detalles relacionados con cada orden. La relaci\u00f3n se basa en que el campo orderNumber en ambos controladores es el mismo, y este es la llave primaria en el maestro.","title":"1. Configurando el Maestro (Controlador Ordenes)"},{"location":"datasets/maestro-detalle/#2-configurando-el-detalle-controlador-ordenesdetalles","text":"Este es el \"hijo\". Controla cada l\u00ednea de producto. El truco del campo oculto: Necesitamos que cada producto sepa a qu\u00e9 orden pertenece. Para eso, en el campo orderNumber del detalle hacemos dos cosas: Lo ponemos como hidden (oculto) para que el usuario no lo toque. Le asignamos el valor por defecto $this->master . \u00bfQu\u00e9 hace esto? Cuando creas un detalle desde la orden #100, Ragnos autom\u00e1ticamente rellena este campo con el n\u00famero 100. Filtrar los datos: No queremos ver todos los productos de todas las \u00f3rdenes. En el m\u00e9todo _filters() , agregamos una regla para que solo se carguen los productos que coincidan con el ID del maestro actual ( $this->master ). function _filters() { $this->modelo->builder()->where('orderNumber', $this->master); } En este fragmento, $this->modelo->builder() permite interactuar directamente con la consulta SQL que generar\u00e1 la grilla. La variable $this->master es inyectada autom\u00e1ticamente por el framework cuando detecta que este controlador se est\u00e1 ejecutando como \"hijo\", y contiene el ID del registro que se est\u00e1 visualizando en el maestro (en este caso, el n\u00famero de orden). Actualizar cambios: Usamos funciones especiales (llamadas hooks ) como _afterInsert o _afterUpdate para limpiar la memoria cach\u00e9. Esto asegura que si agregas un producto, el total de la orden principal se recalcule correctamente. \ud83d\udc49 Ver Gu\u00eda de Hooks","title":"2. Configurando el Detalle (Controlador Ordenesdetalles)"},{"location":"datasets/maestro-detalle/#hooks-de-javascript-personalizados-opcional","text":"En el archivo custom.js se ha agregado la siguiente funci\u00f3n: // con cada cambio en la tabla de detalles de ordenes // recalcula el total de la orden function _OrdenesdetallesOnChange ( tabla ) { let orden = $ ( \"input[name='orderNumber']\" ). val (); getObject ( \"tienda/ordenes/calculatotal\" , { orden : orden }, function ( data ) { $ ( 'input[name=\"total\"]' ). val ( data . total ); }); } Esta funci\u00f3n se ejecuta cada vez que hay un cambio en la tabla de detalles de \u00f3rdenes. Lo que hace es: Obtiene el n\u00famero de orden actual desde el campo oculto. Llama a un endpoint ( tienda/ordenes/calculatotal ) para recalcular el total de la orden. Actualiza el campo total en la pantalla con el nuevo valor. de este modo, el total siempre estar\u00e1 actualizado, cada que se agregue, modifique o elimine un producto en la orden. Esta funci\u00f3n se enlaza autom\u00e1ticamente gracias a la convenci\u00f3n de nombres: _NombreDelControladorOnChange .","title":"Hooks de javascript personalizados (Opcional)"},{"location":"datasets/maestro-detalle/#resumen-del-flujo-de-trabajo","text":"Abres una Orden: Ves los datos generales (Maestro). El sistema verifica: \u00bfEsta orden ya existe? S\u00ed: Carga autom\u00e1ticamente la tabla de productos relacionados al final de la pantalla. No: Oculta la secci\u00f3n de productos hasta que guardes la orden por primera vez. Agregas un producto: Al crear una l\u00ednea en la tabla de detalles, el sistema le pega invisiblemente el n\u00famero de la orden padre. Guardas: Al guardar el detalle, el sistema actualiza los totales y todo se mantiene sincronizado. \u00a1Y listo! Con estos pasos logras que dos tablas funcionen como una sola pantalla integrada.","title":"Resumen del flujo de trabajo"},{"location":"frontend/funciones_javascript/","text":"\u26a1 Funciones JavaScript: getValue y getObject Este documento describe las funciones utilitarias getValue y getObject , utilizadas en el proyecto para realizar peticiones as\u00edncronas al servidor. Estas funciones simplifican el uso de fetch y manejan la serializaci\u00f3n de par\u00e1metros, tiempos de espera y reintentos. getValue(url, params, callback) Realiza una petici\u00f3n HTTP POST a una URL especificada y devuelve la respuesta como texto plano. Par\u00e1metros url (string): La URL a la que se realizar\u00e1 la petici\u00f3n. Se procesa internamente con fixUrl , por lo que puede ser una ruta relativa. params (object, opcional): Un objeto con los par\u00e1metros que se enviar\u00e1n en el cuerpo de la petici\u00f3n (codificados como application/x-www-form-urlencoded ). Adem\u00e1s de los datos a enviar, este objeto acepta configuraciones especiales: timeout (number): Tiempo m\u00e1ximo de espera en milisegundos (por defecto: 12000). retryAttempts (number): N\u00famero de intentos en caso de fallo (por defecto: 1). retryDelay (number): Retardo entre intentos en milisegundos (por defecto: 1000). callback (function, opcional): Una funci\u00f3n que se ejecutar\u00e1 al completar la petici\u00f3n. Recibe dos argumentos: (response, error) . Retorno Si se proporciona un callback , la funci\u00f3n no retorna nada y el resultado se maneja en el callback. Si no se proporciona un callback , devuelve una Promise que resuelve con el texto de la respuesta o rechaza con un error. Ejemplos de uso Moderniza tu c\u00f3digo Aunque soportan callbacks, recomendamos fuertemente usar la sintaxis async/await para un c\u00f3digo m\u00e1s limpio y legible, evitando el \"callback hell\". Uso b\u00e1sico con Promesas (Async/Await): try { const respuestaTexto = await getValue ( \"controller/metodo\" , { id : 123 }); console . log ( \"Respuesta del servidor:\" , respuestaTexto ); } catch ( error ) { console . error ( \"Hubo un error:\" , error ); } Uso con Callback: getValue ( \"controller/metodo\" , { usuario : \"juan\" }, function ( response , error ) { if ( error ) { console . error ( \"Error:\" , error ); } else { console . log ( \"Respuesta:\" , response ); } }); Configuraci\u00f3n de timeout y reintentos: const params = { dato : \"valor\" , timeout : 5000 , // Esperar m\u00e1ximo 5 segundos retryAttempts : 3 , // Reintentar hasta 3 veces si falla }; try { const res = await getValue ( \"api/data\" , params ); } catch ( e ) { console . error ( \"Fall\u00f3 tras 3 intentos\" ); } getObject(purl, pparameters, callbackfunction) Es una funci\u00f3n envolvente (wrapper) de getValue . Realiza la petici\u00f3n y autom\u00e1ticamente intenta parsear la respuesta como un objeto JSON. Par\u00e1metros purl (string): La URL a la que se realizar\u00e1 la petici\u00f3n. pparameters (object): Objeto con los par\u00e1metros a enviar. callbackfunction (function, opcional): Funci\u00f3n de callback que recibe (objeto, error) . objeto : El resultado parseado como JSON si todo sali\u00f3 bien (o null si hubo error). error : Objeto de error si la petici\u00f3n fall\u00f3 o el JSON no es v\u00e1lido (o null si todo sali\u00f3 bien). Retorno Si se usa callbackfunction , no retorna nada expl\u00edcito. Si no se usa callbackfunction , devuelve una Promise que resuelve con el objeto JavaScript parseado o rechaza con el error. Ejemplos de uso Uso b\u00e1sico para obtener datos JSON: // Supongamos que el servidor devuelve: {\"nombre\": \"Ragnos\", \"version\": 1.0} try { const data = await getObject ( \"api/config\" , { modulo : \"admin\" }); console . log ( \"Nombre del sistema:\" , data . nombre ); } catch ( error ) { console . error ( \"Error obteniendo configuraci\u00f3n:\" , error ); } Uso con Callback: getObject ( \"clientes/buscar\" , { q : \"Empresa X\" }, function ( clientes , error ) { if ( error ) { alert ( \"Error en la b\u00fasqueda\" ); return ; } // 'clientes' ya es un array u objeto JS clientes . forEach (( c ) => console . log ( c . nombre )); }); RagnosSearch y Clases relacionadas La clase RagnosSearch y sus m\u00e9todos auxiliares proporcionan una interfaz estandarizada para realizar b\u00fasquedas en inputs, integrando interfaz gr\u00e1fica (botones) y manejo de resultados. RagnosSearch.setupSimpleSearch(elemento, ruta, params, callback) M\u00e9todo est\u00e1tico para configurar una b\u00fasqueda sencilla en un input existente. Transforma el input agregando botones de b\u00fasqueda y limpieza. Par\u00e1metros elemento (jQuery Selector | DOM Element): El input donde se habilitar\u00e1 la b\u00fasqueda. ruta (string): La URL del servidor (Controlador/M\u00e9todo) que procesar\u00e1 la b\u00fasqueda. params (object): Configuraci\u00f3n adicional. canSetToNull (boolean): Define si se muestra el bot\u00f3n \"X\" para limpiar el campo (Default: true ). callback (function): Funci\u00f3n a ejecutar tras una b\u00fasqueda exitosa. Recibe el objeto jQuery del input como argumento e . Retorno No retorna valor. Modifica el DOM del input. Ejemplo de uso RagnosSearch . setupSimpleSearch ( $ ( \"#miInput\" ), \"admin/usuarios/buscar\" , {}, function ( e ) { // Los datos del resultado se adjuntan al objeto jQuery en 'searchdata' let resultado = e . data ( \"searchdata\" ); if ( resultado ) { console . log ( \"ID seleccionado:\" , resultado . id ); console . log ( \"Nombre:\" , resultado . nombre ); // Asignar valor al input visible e . val ( resultado . nombre ); } } ); $(selector).RagnosSearch(params) Plugin de jQuery que instancia la clase RagnosSearch . Est\u00e1 dise\u00f1ado para b\u00fasquedas m\u00e1s complejas, t\u00edpicamente vinculadas a un controlador est\u00e1ndar del sistema ( RagnosController ) que implementa searchByAjax y soporta filtros estructurados. Par\u00e1metros ( params ) Objeto de configuraci\u00f3n con: controller (string): Nombre del controlador que gestiona la b\u00fasqueda (ej. 'usuarios' , 'productos' ). El sistema buscar\u00e1 en controller/searchByAjax . filter (string): Cadena en Base64 que contiene un array JSON de filtros. Estructura: Base64( JSON_String([ {field, op, value}, ... ]) ) . callback (function): Funci\u00f3n a ejecutar al seleccionar un resultado. canSetToNull (boolean): (Opcional) Permite limpiar el campo. Ejemplo de uso $ ( \"#inputBusquedaAvanzada\" ). RagnosSearch ({ controller : \"usuarios\" , // Busca en: usuarios/searchByAjax // Filtro: Usuarios activos (usu_activo = 'S') y del grupo 2 filter : btoa ( JSON . stringify ([ { field : \"usu_activo\" , op : \"=\" , value : \"S\" }, { field : \"usu_grupo\" , op : \"=\" , value : 2 }, ]) ), callback : function ( e ) { let datos = e . data ( \"searchdata\" ); console . log ( \"Datos recibidos:\" , datos ); if ( datos && datos . id ) { // L\u00f3gica personalizada } }, }); Hooks de Sistema y Funciones en custom.js El archivo custom.js es el lugar designado para l\u00f3gica espec\u00edfica de la aplicaci\u00f3n, incluyendo \"hooks\" (ganchos) que el sistema invoca autom\u00e1ticamente bas\u00e1ndose en convenciones de nombres. Esto permite extender la funcionalidad de b\u00fasquedas y tablas sin modificar el n\u00facleo. Convenci\u00f3n de Nombres para Hooks El sistema detecta autom\u00e1ticamente funciones globales con patrones espec\u00edficos de nombre para ejecutar acciones tras ciertos eventos. 1. Hooks de B\u00fasqueda ( _NombreCampoOnSearch ) Se ejecutan autom\u00e1ticamente despu\u00e9s de que un control RagnosSearch completa una selecci\u00f3n. Patr\u00f3n: _{id_del_input}OnSearch Par\u00e1metro: Recibe el objeto jQuery del control (input). Uso: Ideal para rellenar otros campos del formulario bas\u00e1ndose en el resultado de la b\u00fasqueda. Ejemplo del sistema ( _productCodeOnSearch ): Cuando se selecciona un producto en el input productCode , esta funci\u00f3n busca el input priceEach en el detalle de la orden y le asigna el precio sugerido (MSRP). // Se activa al seleccionar algo en <input id=\"productCode\" ...> function _productCodeOnSearch ( control ) { // 'control' es el input del c\u00f3digo de producto // Accedemos a los datos devueltos por la b\u00fasqueda con .data(\"searchdata\") let datos = control . data ( \"searchdata\" ); // Actualizamos otro campo (Precio Unitario) con el valor MSRP del producto $ ( '#detalleorden input[name=\"priceEach\"]' ). val ( datos . MSRP ); } 2. Hooks de Cambio en Tabla ( _NombreTablaOnChange ) Se ejecutan cuando ocurre un cambio en una tabla gestionada (por ejemplo, al agregar o editar filas en una tabla detalle). Patr\u00f3n: _{id_de_la_tabla}OnChange Par\u00e1metro: Recibe el objeto tabla o el contexto del cambio. Uso: Rec\u00e1lculos de totales, validaciones cruzadas. Ejemplo del sistema ( _OrdenesdetallesOnChange ): Cada vez que cambia algo en la tabla de detalles de \u00f3rdenes ( Ordenesdetalles ), se recalcula el total de la orden completa llamando al servidor. // Se activa al modificar la tabla <table id=\"Ordenesdetalles\" ...> function _OrdenesdetallesOnChange ( tabla ) { // Obtenemos el ID de la orden actual let orden = $ ( \"input[name='orderNumber']\" ). val (); // Llamamos al servidor para recalcular el total getObject ( \"tienda/ordenes/calculatotal\" , { orden : orden }, function ( data ) { // Actualizamos el campo visual de Total $ ( 'input[name=\"total\"]' ). val ( data . total ); }); } Funciones Utilitarias Personalizadas Tambi\u00e9n se pueden definir funciones normales para ser usadas como callbacks expl\u00edcitos en configuraciones de b\u00fasqueda. Ejemplo ( pruebaBusquedaOffice ): Una funci\u00f3n simple dise\u00f1ada para ser pasada como par\u00e1metro callback en RagnosSearch . function pruebaBusquedaOffice ( e ) { let datos = e . data ( \"searchdata\" ); console . log ( \"Los datos de la busqueda por oficina\" , datos ); } // Uso: // $('#oficina').RagnosSearch({ ..., callback: pruebaBusquedaOffice });","title":"Funciones JavaScript"},{"location":"frontend/funciones_javascript/#funciones-javascript-getvalue-y-getobject","text":"Este documento describe las funciones utilitarias getValue y getObject , utilizadas en el proyecto para realizar peticiones as\u00edncronas al servidor. Estas funciones simplifican el uso de fetch y manejan la serializaci\u00f3n de par\u00e1metros, tiempos de espera y reintentos.","title":"\u26a1 Funciones JavaScript: getValue y getObject"},{"location":"frontend/funciones_javascript/#getvalueurl-params-callback","text":"Realiza una petici\u00f3n HTTP POST a una URL especificada y devuelve la respuesta como texto plano.","title":"getValue(url, params, callback)"},{"location":"frontend/funciones_javascript/#parametros","text":"url (string): La URL a la que se realizar\u00e1 la petici\u00f3n. Se procesa internamente con fixUrl , por lo que puede ser una ruta relativa. params (object, opcional): Un objeto con los par\u00e1metros que se enviar\u00e1n en el cuerpo de la petici\u00f3n (codificados como application/x-www-form-urlencoded ). Adem\u00e1s de los datos a enviar, este objeto acepta configuraciones especiales: timeout (number): Tiempo m\u00e1ximo de espera en milisegundos (por defecto: 12000). retryAttempts (number): N\u00famero de intentos en caso de fallo (por defecto: 1). retryDelay (number): Retardo entre intentos en milisegundos (por defecto: 1000). callback (function, opcional): Una funci\u00f3n que se ejecutar\u00e1 al completar la petici\u00f3n. Recibe dos argumentos: (response, error) .","title":"Par\u00e1metros"},{"location":"frontend/funciones_javascript/#retorno","text":"Si se proporciona un callback , la funci\u00f3n no retorna nada y el resultado se maneja en el callback. Si no se proporciona un callback , devuelve una Promise que resuelve con el texto de la respuesta o rechaza con un error.","title":"Retorno"},{"location":"frontend/funciones_javascript/#ejemplos-de-uso","text":"Moderniza tu c\u00f3digo Aunque soportan callbacks, recomendamos fuertemente usar la sintaxis async/await para un c\u00f3digo m\u00e1s limpio y legible, evitando el \"callback hell\". Uso b\u00e1sico con Promesas (Async/Await): try { const respuestaTexto = await getValue ( \"controller/metodo\" , { id : 123 }); console . log ( \"Respuesta del servidor:\" , respuestaTexto ); } catch ( error ) { console . error ( \"Hubo un error:\" , error ); } Uso con Callback: getValue ( \"controller/metodo\" , { usuario : \"juan\" }, function ( response , error ) { if ( error ) { console . error ( \"Error:\" , error ); } else { console . log ( \"Respuesta:\" , response ); } }); Configuraci\u00f3n de timeout y reintentos: const params = { dato : \"valor\" , timeout : 5000 , // Esperar m\u00e1ximo 5 segundos retryAttempts : 3 , // Reintentar hasta 3 veces si falla }; try { const res = await getValue ( \"api/data\" , params ); } catch ( e ) { console . error ( \"Fall\u00f3 tras 3 intentos\" ); }","title":"Ejemplos de uso"},{"location":"frontend/funciones_javascript/#getobjectpurl-pparameters-callbackfunction","text":"Es una funci\u00f3n envolvente (wrapper) de getValue . Realiza la petici\u00f3n y autom\u00e1ticamente intenta parsear la respuesta como un objeto JSON.","title":"getObject(purl, pparameters, callbackfunction)"},{"location":"frontend/funciones_javascript/#parametros_1","text":"purl (string): La URL a la que se realizar\u00e1 la petici\u00f3n. pparameters (object): Objeto con los par\u00e1metros a enviar. callbackfunction (function, opcional): Funci\u00f3n de callback que recibe (objeto, error) . objeto : El resultado parseado como JSON si todo sali\u00f3 bien (o null si hubo error). error : Objeto de error si la petici\u00f3n fall\u00f3 o el JSON no es v\u00e1lido (o null si todo sali\u00f3 bien).","title":"Par\u00e1metros"},{"location":"frontend/funciones_javascript/#retorno_1","text":"Si se usa callbackfunction , no retorna nada expl\u00edcito. Si no se usa callbackfunction , devuelve una Promise que resuelve con el objeto JavaScript parseado o rechaza con el error.","title":"Retorno"},{"location":"frontend/funciones_javascript/#ejemplos-de-uso_1","text":"Uso b\u00e1sico para obtener datos JSON: // Supongamos que el servidor devuelve: {\"nombre\": \"Ragnos\", \"version\": 1.0} try { const data = await getObject ( \"api/config\" , { modulo : \"admin\" }); console . log ( \"Nombre del sistema:\" , data . nombre ); } catch ( error ) { console . error ( \"Error obteniendo configuraci\u00f3n:\" , error ); } Uso con Callback: getObject ( \"clientes/buscar\" , { q : \"Empresa X\" }, function ( clientes , error ) { if ( error ) { alert ( \"Error en la b\u00fasqueda\" ); return ; } // 'clientes' ya es un array u objeto JS clientes . forEach (( c ) => console . log ( c . nombre )); });","title":"Ejemplos de uso"},{"location":"frontend/funciones_javascript/#ragnossearch-y-clases-relacionadas","text":"La clase RagnosSearch y sus m\u00e9todos auxiliares proporcionan una interfaz estandarizada para realizar b\u00fasquedas en inputs, integrando interfaz gr\u00e1fica (botones) y manejo de resultados.","title":"RagnosSearch y Clases relacionadas"},{"location":"frontend/funciones_javascript/#ragnossearchsetupsimplesearchelemento-ruta-params-callback","text":"M\u00e9todo est\u00e1tico para configurar una b\u00fasqueda sencilla en un input existente. Transforma el input agregando botones de b\u00fasqueda y limpieza.","title":"RagnosSearch.setupSimpleSearch(elemento, ruta, params, callback)"},{"location":"frontend/funciones_javascript/#parametros_2","text":"elemento (jQuery Selector | DOM Element): El input donde se habilitar\u00e1 la b\u00fasqueda. ruta (string): La URL del servidor (Controlador/M\u00e9todo) que procesar\u00e1 la b\u00fasqueda. params (object): Configuraci\u00f3n adicional. canSetToNull (boolean): Define si se muestra el bot\u00f3n \"X\" para limpiar el campo (Default: true ). callback (function): Funci\u00f3n a ejecutar tras una b\u00fasqueda exitosa. Recibe el objeto jQuery del input como argumento e .","title":"Par\u00e1metros"},{"location":"frontend/funciones_javascript/#retorno_2","text":"No retorna valor. Modifica el DOM del input.","title":"Retorno"},{"location":"frontend/funciones_javascript/#ejemplo-de-uso","text":"RagnosSearch . setupSimpleSearch ( $ ( \"#miInput\" ), \"admin/usuarios/buscar\" , {}, function ( e ) { // Los datos del resultado se adjuntan al objeto jQuery en 'searchdata' let resultado = e . data ( \"searchdata\" ); if ( resultado ) { console . log ( \"ID seleccionado:\" , resultado . id ); console . log ( \"Nombre:\" , resultado . nombre ); // Asignar valor al input visible e . val ( resultado . nombre ); } } );","title":"Ejemplo de uso"},{"location":"frontend/funciones_javascript/#selectorragnossearchparams","text":"Plugin de jQuery que instancia la clase RagnosSearch . Est\u00e1 dise\u00f1ado para b\u00fasquedas m\u00e1s complejas, t\u00edpicamente vinculadas a un controlador est\u00e1ndar del sistema ( RagnosController ) que implementa searchByAjax y soporta filtros estructurados.","title":"$(selector).RagnosSearch(params)"},{"location":"frontend/funciones_javascript/#parametros-params","text":"Objeto de configuraci\u00f3n con: controller (string): Nombre del controlador que gestiona la b\u00fasqueda (ej. 'usuarios' , 'productos' ). El sistema buscar\u00e1 en controller/searchByAjax . filter (string): Cadena en Base64 que contiene un array JSON de filtros. Estructura: Base64( JSON_String([ {field, op, value}, ... ]) ) . callback (function): Funci\u00f3n a ejecutar al seleccionar un resultado. canSetToNull (boolean): (Opcional) Permite limpiar el campo.","title":"Par\u00e1metros (params)"},{"location":"frontend/funciones_javascript/#ejemplo-de-uso_1","text":"$ ( \"#inputBusquedaAvanzada\" ). RagnosSearch ({ controller : \"usuarios\" , // Busca en: usuarios/searchByAjax // Filtro: Usuarios activos (usu_activo = 'S') y del grupo 2 filter : btoa ( JSON . stringify ([ { field : \"usu_activo\" , op : \"=\" , value : \"S\" }, { field : \"usu_grupo\" , op : \"=\" , value : 2 }, ]) ), callback : function ( e ) { let datos = e . data ( \"searchdata\" ); console . log ( \"Datos recibidos:\" , datos ); if ( datos && datos . id ) { // L\u00f3gica personalizada } }, });","title":"Ejemplo de uso"},{"location":"frontend/funciones_javascript/#hooks-de-sistema-y-funciones-en-customjs","text":"El archivo custom.js es el lugar designado para l\u00f3gica espec\u00edfica de la aplicaci\u00f3n, incluyendo \"hooks\" (ganchos) que el sistema invoca autom\u00e1ticamente bas\u00e1ndose en convenciones de nombres. Esto permite extender la funcionalidad de b\u00fasquedas y tablas sin modificar el n\u00facleo.","title":"Hooks de Sistema y Funciones en custom.js"},{"location":"frontend/funciones_javascript/#convencion-de-nombres-para-hooks","text":"El sistema detecta autom\u00e1ticamente funciones globales con patrones espec\u00edficos de nombre para ejecutar acciones tras ciertos eventos.","title":"Convenci\u00f3n de Nombres para Hooks"},{"location":"frontend/funciones_javascript/#1-hooks-de-busqueda-_nombrecampoonsearch","text":"Se ejecutan autom\u00e1ticamente despu\u00e9s de que un control RagnosSearch completa una selecci\u00f3n. Patr\u00f3n: _{id_del_input}OnSearch Par\u00e1metro: Recibe el objeto jQuery del control (input). Uso: Ideal para rellenar otros campos del formulario bas\u00e1ndose en el resultado de la b\u00fasqueda. Ejemplo del sistema ( _productCodeOnSearch ): Cuando se selecciona un producto en el input productCode , esta funci\u00f3n busca el input priceEach en el detalle de la orden y le asigna el precio sugerido (MSRP). // Se activa al seleccionar algo en <input id=\"productCode\" ...> function _productCodeOnSearch ( control ) { // 'control' es el input del c\u00f3digo de producto // Accedemos a los datos devueltos por la b\u00fasqueda con .data(\"searchdata\") let datos = control . data ( \"searchdata\" ); // Actualizamos otro campo (Precio Unitario) con el valor MSRP del producto $ ( '#detalleorden input[name=\"priceEach\"]' ). val ( datos . MSRP ); }","title":"1. Hooks de B\u00fasqueda (_NombreCampoOnSearch)"},{"location":"frontend/funciones_javascript/#2-hooks-de-cambio-en-tabla-_nombretablaonchange","text":"Se ejecutan cuando ocurre un cambio en una tabla gestionada (por ejemplo, al agregar o editar filas en una tabla detalle). Patr\u00f3n: _{id_de_la_tabla}OnChange Par\u00e1metro: Recibe el objeto tabla o el contexto del cambio. Uso: Rec\u00e1lculos de totales, validaciones cruzadas. Ejemplo del sistema ( _OrdenesdetallesOnChange ): Cada vez que cambia algo en la tabla de detalles de \u00f3rdenes ( Ordenesdetalles ), se recalcula el total de la orden completa llamando al servidor. // Se activa al modificar la tabla <table id=\"Ordenesdetalles\" ...> function _OrdenesdetallesOnChange ( tabla ) { // Obtenemos el ID de la orden actual let orden = $ ( \"input[name='orderNumber']\" ). val (); // Llamamos al servidor para recalcular el total getObject ( \"tienda/ordenes/calculatotal\" , { orden : orden }, function ( data ) { // Actualizamos el campo visual de Total $ ( 'input[name=\"total\"]' ). val ( data . total ); }); }","title":"2. Hooks de Cambio en Tabla (_NombreTablaOnChange)"},{"location":"frontend/funciones_javascript/#funciones-utilitarias-personalizadas","text":"Tambi\u00e9n se pueden definir funciones normales para ser usadas como callbacks expl\u00edcitos en configuraciones de b\u00fasqueda. Ejemplo ( pruebaBusquedaOffice ): Una funci\u00f3n simple dise\u00f1ada para ser pasada como par\u00e1metro callback en RagnosSearch . function pruebaBusquedaOffice ( e ) { let datos = e . data ( \"searchdata\" ); console . log ( \"Los datos de la busqueda por oficina\" , datos ); } // Uso: // $('#oficina').RagnosSearch({ ..., callback: pruebaBusquedaOffice });","title":"Funciones Utilitarias Personalizadas"},{"location":"frontend/personalizacion_ui/","text":"Personalizaci\u00f3n de la Interfaz (UI) Ragnos utiliza AdminLTE 3 como base para su interfaz, integrado con el sistema de vistas de CodeIgniter 4. Aqu\u00ed te explicamos c\u00f3mo personalizar los elementos comunes como el men\u00fa lateral, el logotipo y la barra superior. Men\u00fa Lateral (Sidebar) El men\u00fa principal de la aplicaci\u00f3n se encuentra en una vista est\u00e1tica. Para agregar, quitar o reorganizar enlaces, debes editar el archivo: \ud83d\udcc2 app/Views/template/sidebar.php Estructura del Men\u00fa El men\u00fa utiliza una lista HTML est\u00e1ndar con clases de Bootstrap/AdminLTE. Iconos Disponibles Ragnos incluye la librer\u00eda Bootstrap Icons . Puedes navegar por la galer\u00eda oficial de iconos para encontrar los c\u00f3digos de clase (ej. bi-shop , bi-gear ). Ejemplo de c\u00f3mo agregar un enlace simple: <li class=\"nav-item\"> <a href=\" <? = site_url ( 'proceso/tareas' ) ?> \" class=\"nav-link\"> <i class=\"bi bi-check-square nav-icon\"></i> <p>Mis Tareas</p> </a> </li> Ejemplo de un submen\u00fa desplegable: <li class=\"nav-item\"> <a class=\"nav-link\"> <i class=\"bi bi-shop\"></i> <p> Tienda <i class=\"nav-arrow bi bi-chevron-right\"></i> </p> </a> <ul class=\"nav nav-treeview\"> <li class=\"nav-item\"> <a href=\" <? = site_url ( 'tienda/productos' ) ?> \" class=\"nav-link\"> <i class=\"bi bi-box nav-icon\"></i> <p>Productos</p> </a> </li> </ul> </li> Control de Acceso en el Men\u00fa Puedes mostrar u ocultar elementos del men\u00fa seg\u00fan el rol del usuario logueado utilizando el servicio Admin_aut . <?php // Obtener el servicio de autenticaci\u00f3n al inicio del archivo $auth = service ( 'Admin_aut' ); ?> <!-- ... en el men\u00fa ... --> <?php if ( $auth -> isUserInGroup ( 'administrador' )) : ?> <li class=\"nav-item\"> <a href=\" <? = site_url ( 'usuarios' ) ?> \" class=\"nav-link\"> ... </a> </li> <?php endif ; ?> Personalizaci\u00f3n del Logotipo y T\u00edtulo T\u00edtulo de la Aplicaci\u00f3n El nombre que aparece junto al logo se configura globalmente en app/Config/RagnosConfig.php : public $Ragnos_application_title = 'Mi Empresa'; Logotipo El logo se imprime en la parte superior del archivo sidebar.php : <div class=\"sidebar-brand\"> <a href=\" <? = site_url () ?> \" class=\"brand-link\"> <!-- Puedes cambiar este span por una etiqueta img --> <span class=\"brand-text font-weight-light\"> <? = Ragnos :: config () -> Ragnos_application_title ; ?> </span> </a> </div> Para usar una imagen: <img src=\" <? = base_url ( 'content/img/mi-logo.png' ) ?> \" alt=\"Logo\" class=\"brand-image img-circle elevation-3\" style=\"opacity: .8\"> Barra Superior (Topbar) La barra superior se encuentra en: \ud83d\udcc2 app/Views/template/topbar.php Aqu\u00ed puedes modificar los enlaces de la derecha (perfil, notificaciones) o agregar buscadores globales.","title":"Personalizaci\u00f3n UI"},{"location":"frontend/personalizacion_ui/#personalizacion-de-la-interfaz-ui","text":"Ragnos utiliza AdminLTE 3 como base para su interfaz, integrado con el sistema de vistas de CodeIgniter 4. Aqu\u00ed te explicamos c\u00f3mo personalizar los elementos comunes como el men\u00fa lateral, el logotipo y la barra superior.","title":"Personalizaci\u00f3n de la Interfaz (UI)"},{"location":"frontend/personalizacion_ui/#menu-lateral-sidebar","text":"El men\u00fa principal de la aplicaci\u00f3n se encuentra en una vista est\u00e1tica. Para agregar, quitar o reorganizar enlaces, debes editar el archivo: \ud83d\udcc2 app/Views/template/sidebar.php","title":"Men\u00fa Lateral (Sidebar)"},{"location":"frontend/personalizacion_ui/#estructura-del-menu","text":"El men\u00fa utiliza una lista HTML est\u00e1ndar con clases de Bootstrap/AdminLTE. Iconos Disponibles Ragnos incluye la librer\u00eda Bootstrap Icons . Puedes navegar por la galer\u00eda oficial de iconos para encontrar los c\u00f3digos de clase (ej. bi-shop , bi-gear ). Ejemplo de c\u00f3mo agregar un enlace simple: <li class=\"nav-item\"> <a href=\" <? = site_url ( 'proceso/tareas' ) ?> \" class=\"nav-link\"> <i class=\"bi bi-check-square nav-icon\"></i> <p>Mis Tareas</p> </a> </li> Ejemplo de un submen\u00fa desplegable: <li class=\"nav-item\"> <a class=\"nav-link\"> <i class=\"bi bi-shop\"></i> <p> Tienda <i class=\"nav-arrow bi bi-chevron-right\"></i> </p> </a> <ul class=\"nav nav-treeview\"> <li class=\"nav-item\"> <a href=\" <? = site_url ( 'tienda/productos' ) ?> \" class=\"nav-link\"> <i class=\"bi bi-box nav-icon\"></i> <p>Productos</p> </a> </li> </ul> </li>","title":"Estructura del Men\u00fa"},{"location":"frontend/personalizacion_ui/#control-de-acceso-en-el-menu","text":"Puedes mostrar u ocultar elementos del men\u00fa seg\u00fan el rol del usuario logueado utilizando el servicio Admin_aut . <?php // Obtener el servicio de autenticaci\u00f3n al inicio del archivo $auth = service ( 'Admin_aut' ); ?> <!-- ... en el men\u00fa ... --> <?php if ( $auth -> isUserInGroup ( 'administrador' )) : ?> <li class=\"nav-item\"> <a href=\" <? = site_url ( 'usuarios' ) ?> \" class=\"nav-link\"> ... </a> </li> <?php endif ; ?>","title":"Control de Acceso en el Men\u00fa"},{"location":"frontend/personalizacion_ui/#personalizacion-del-logotipo-y-titulo","text":"","title":"Personalizaci\u00f3n del Logotipo y T\u00edtulo"},{"location":"frontend/personalizacion_ui/#titulo-de-la-aplicacion","text":"El nombre que aparece junto al logo se configura globalmente en app/Config/RagnosConfig.php : public $Ragnos_application_title = 'Mi Empresa';","title":"T\u00edtulo de la Aplicaci\u00f3n"},{"location":"frontend/personalizacion_ui/#logotipo","text":"El logo se imprime en la parte superior del archivo sidebar.php : <div class=\"sidebar-brand\"> <a href=\" <? = site_url () ?> \" class=\"brand-link\"> <!-- Puedes cambiar este span por una etiqueta img --> <span class=\"brand-text font-weight-light\"> <? = Ragnos :: config () -> Ragnos_application_title ; ?> </span> </a> </div> Para usar una imagen: <img src=\" <? = base_url ( 'content/img/mi-logo.png' ) ?> \" alt=\"Logo\" class=\"brand-image img-circle elevation-3\" style=\"opacity: .8\">","title":"Logotipo"},{"location":"frontend/personalizacion_ui/#barra-superior-topbar","text":"La barra superior se encuentra en: \ud83d\udcc2 app/Views/template/topbar.php Aqu\u00ed puedes modificar los enlaces de la derecha (perfil, notificaciones) o agregar buscadores globales.","title":"Barra Superior (Topbar)"},{"location":"frontend/reportes_simples/","text":"\ud83d\udcca Generaci\u00f3n de Reportes Simples (RSimpleLevelReport) La clase RSimpleLevelReport permite generar reportes en formato de tabla HTML de manera r\u00e1pida y estructurada a partir de un array de datos. Es ideal para mostrar listados, res\u00famenes financieros o cualquier conjunto de datos que requiera una presentaci\u00f3n tabular, con soporte para agrupaci\u00f3n por niveles (cortes de control). Caracter\u00edsticas Principales Generaci\u00f3n autom\u00e1tica de tablas HTML. Soporte para m\u00faltiples niveles de agrupaci\u00f3n (encabezados por grupo). C\u00e1lculo autom\u00e1tico de totales de registros. F\u00e1cil integraci\u00f3n con vistas de Ragnos. Flujo B\u00e1sico de Uso Obtener los datos (generalmente desde un Modelo). Instanciar App\\ThirdParty\\Ragnos\\Controllers\\RSimpleLevelReport . Configurar el reporte usando quickSetup . Renderizar el reporte y pasarlo a la vista. API de la Clase quickSetup($title, $data, $listfields, $groups = [], $desc_filter = '') Configura los par\u00e1metros principales del reporte de una sola vez. $title (string): El t\u00edtulo principal del reporte. $data (array): El conjunto de datos (array de arrays asociativos). $listfields (array): Lista de campos a mostrar. Si es un array simple ['Campo1', 'Campo2'] , se buscar\u00e1n esas claves en $data . Se recomienda que los nombres coincidan con las claves del array de datos. $groups (array): (Opcional) Configuraci\u00f3n de agrupamiento. Formato: ['campo_agrupador' => ['label' => 'Etiqueta del Grupo']] . $desc_filter (string): (Opcional) Subt\u00edtulo o descripci\u00f3n de filtros aplicados. setShowTotals(bool $showTotals) Habilita o deshabilita la visualizaci\u00f3n del conteo total de registros al final del reporte (por defecto true ). render($rutadevuelta = 'admin/index') Retorna el HTML del reporte renderizado dentro de la vista est\u00e1ndar de reportes. \u00datil para incrustar en layouts existentes. generate() Retorna solo el HTML de la tabla y los encabezados, sin envoltorio de vista completa. \u00datil para inyecciones AJAX o vistas personalizadas. Ejemplos de Implementaci\u00f3n 1. Reporte Simple (Listado Plano) Este ejemplo muestra un listado de ventas mensuales sin agrupaci\u00f3n. <?php namespace App\\Controllers\\Tienda ; use App\\ThirdParty\\Ragnos\\Controllers\\BaseController ; use App\\ThirdParty\\Ragnos\\Controllers\\RSimpleLevelReport ; class Reportes extends BaseController { public function ventaspormes () { // 1. Obtener datos $model = new \\App\\Models\\Dashboard (); $datos = $model -> ventasultimos12meses (); // Estructura esperada de $datos: // [['Mes' => 'Enero', 'Total' => 1000], ['Mes' => 'Febrero', 'Total' => 1500], ...] // 2. Formatear datos (opcional pero recomendado) foreach ( $datos as $key => $value ) { $datos [ $key ][ 'Total' ] = '$ ' . number_format ( $value [ 'Total' ], 2 ); } // 3. Configurar Reporte $reporte = new RSimpleLevelReport (); $reporte -> setShowTotals ( false ); // Ocultar conteo de registros xq es irrelevante aqu\u00ed // quickSetup(T\u00edtulo, Datos, Columnas a mostrar) $reporte -> quickSetup ( 'Ventas por Mes' , $datos , [ 'Mes' , 'Total' ]); // 4. Renderizar $contenido = $reporte -> render (); return view ( 'admin/reporte_view' , [ 'contenido' => $contenido ]); } } 2. Reporte Agrupado (Corte de Control) Este ejemplo genera un listado de productos agrupados por Categor\u00eda . Cada vez que cambia la categor\u00eda, se genera un nuevo encabezado. Requisito Importante : Para que la agrupaci\u00f3n funcione correctamente, los datos de entrada deben estar ordenados por el campo de agrupaci\u00f3n. <?php namespace App\\Controllers\\Tienda ; use App\\ThirdParty\\Ragnos\\Controllers\\BaseController ; use App\\ThirdParty\\Ragnos\\Controllers\\RSimpleLevelReport ; class Productos extends BaseController { public function listadoPorCategoria () { // 1. Obtener datos (\u00a1Ordenados por categor\u00eda!) $data = [ [ 'categoria' => 'Electr\u00f3nica' , 'producto' => 'Televisor' , 'precio' => 500 ], [ 'categoria' => 'Electr\u00f3nica' , 'producto' => 'Radio' , 'precio' => 50 ], [ 'categoria' => 'Hogar' , 'producto' => 'Silla' , 'precio' => 25 ], [ 'categoria' => 'Hogar' , 'producto' => 'Mesa' , 'precio' => 100 ], ]; $reporte = new RSimpleLevelReport (); // 2. Definir Agrupaci\u00f3n // La clave 'categoria' debe existir en $data. $grupos = [ 'categoria' => [ 'label' => 'Categor\u00eda de Producto' ] ]; // 3. Configurar $reporte -> quickSetup ( 'Listado de Productos' , $data , [ 'producto' , 'precio' ], // Campos a mostrar en las columnas $grupos , // Configuraci\u00f3n de grupos 'Filtro: Todos los productos activos' // Subt\u00edtulo opcional ); return view ( 'admin/reporte_view' , [ 'contenido' => $reporte -> render ()]); } } 3. Reporte Multi-Nivel Es posible agrupar por m\u00faltiples niveles (ej: Pa\u00eds -> Estado -> Ciudad). $grupos = [ 'pais' => ['label' => 'Pa\u00eds'], 'estado' => ['label' => 'Estado/Provincia'] ]; // Los datos deben venir ordenados por pais y luego por estado $reporte->quickSetup('Reporte Geogr\u00e1fico', $data, ['ciudad', 'poblacion'], $grupos); Aplicaciones Comunes Listados de Inventario : Agrupados por almac\u00e9n o categor\u00eda. Reportes de Ventas : Diarios, mensuales o agrupados por vendedor. Auditor\u00eda : Listados de logs de sistema. Res\u00famenes Financieros : Listados simples de ingresos/egresos formateados.","title":"Reportes Simples"},{"location":"frontend/reportes_simples/#generacion-de-reportes-simples-rsimplelevelreport","text":"La clase RSimpleLevelReport permite generar reportes en formato de tabla HTML de manera r\u00e1pida y estructurada a partir de un array de datos. Es ideal para mostrar listados, res\u00famenes financieros o cualquier conjunto de datos que requiera una presentaci\u00f3n tabular, con soporte para agrupaci\u00f3n por niveles (cortes de control).","title":"\ud83d\udcca Generaci\u00f3n de Reportes Simples (RSimpleLevelReport)"},{"location":"frontend/reportes_simples/#caracteristicas-principales","text":"Generaci\u00f3n autom\u00e1tica de tablas HTML. Soporte para m\u00faltiples niveles de agrupaci\u00f3n (encabezados por grupo). C\u00e1lculo autom\u00e1tico de totales de registros. F\u00e1cil integraci\u00f3n con vistas de Ragnos.","title":"Caracter\u00edsticas Principales"},{"location":"frontend/reportes_simples/#flujo-basico-de-uso","text":"Obtener los datos (generalmente desde un Modelo). Instanciar App\\ThirdParty\\Ragnos\\Controllers\\RSimpleLevelReport . Configurar el reporte usando quickSetup . Renderizar el reporte y pasarlo a la vista.","title":"Flujo B\u00e1sico de Uso"},{"location":"frontend/reportes_simples/#api-de-la-clase","text":"","title":"API de la Clase"},{"location":"frontend/reportes_simples/#quicksetuptitle-data-listfields-groups-desc_filter","text":"Configura los par\u00e1metros principales del reporte de una sola vez. $title (string): El t\u00edtulo principal del reporte. $data (array): El conjunto de datos (array de arrays asociativos). $listfields (array): Lista de campos a mostrar. Si es un array simple ['Campo1', 'Campo2'] , se buscar\u00e1n esas claves en $data . Se recomienda que los nombres coincidan con las claves del array de datos. $groups (array): (Opcional) Configuraci\u00f3n de agrupamiento. Formato: ['campo_agrupador' => ['label' => 'Etiqueta del Grupo']] . $desc_filter (string): (Opcional) Subt\u00edtulo o descripci\u00f3n de filtros aplicados.","title":"quickSetup($title, $data, $listfields, $groups = [], $desc_filter = '')"},{"location":"frontend/reportes_simples/#setshowtotalsbool-showtotals","text":"Habilita o deshabilita la visualizaci\u00f3n del conteo total de registros al final del reporte (por defecto true ).","title":"setShowTotals(bool $showTotals)"},{"location":"frontend/reportes_simples/#renderrutadevuelta-adminindex","text":"Retorna el HTML del reporte renderizado dentro de la vista est\u00e1ndar de reportes. \u00datil para incrustar en layouts existentes.","title":"render($rutadevuelta = 'admin/index')"},{"location":"frontend/reportes_simples/#generate","text":"Retorna solo el HTML de la tabla y los encabezados, sin envoltorio de vista completa. \u00datil para inyecciones AJAX o vistas personalizadas.","title":"generate()"},{"location":"frontend/reportes_simples/#ejemplos-de-implementacion","text":"","title":"Ejemplos de Implementaci\u00f3n"},{"location":"frontend/reportes_simples/#1-reporte-simple-listado-plano","text":"Este ejemplo muestra un listado de ventas mensuales sin agrupaci\u00f3n. <?php namespace App\\Controllers\\Tienda ; use App\\ThirdParty\\Ragnos\\Controllers\\BaseController ; use App\\ThirdParty\\Ragnos\\Controllers\\RSimpleLevelReport ; class Reportes extends BaseController { public function ventaspormes () { // 1. Obtener datos $model = new \\App\\Models\\Dashboard (); $datos = $model -> ventasultimos12meses (); // Estructura esperada de $datos: // [['Mes' => 'Enero', 'Total' => 1000], ['Mes' => 'Febrero', 'Total' => 1500], ...] // 2. Formatear datos (opcional pero recomendado) foreach ( $datos as $key => $value ) { $datos [ $key ][ 'Total' ] = '$ ' . number_format ( $value [ 'Total' ], 2 ); } // 3. Configurar Reporte $reporte = new RSimpleLevelReport (); $reporte -> setShowTotals ( false ); // Ocultar conteo de registros xq es irrelevante aqu\u00ed // quickSetup(T\u00edtulo, Datos, Columnas a mostrar) $reporte -> quickSetup ( 'Ventas por Mes' , $datos , [ 'Mes' , 'Total' ]); // 4. Renderizar $contenido = $reporte -> render (); return view ( 'admin/reporte_view' , [ 'contenido' => $contenido ]); } }","title":"1. Reporte Simple (Listado Plano)"},{"location":"frontend/reportes_simples/#2-reporte-agrupado-corte-de-control","text":"Este ejemplo genera un listado de productos agrupados por Categor\u00eda . Cada vez que cambia la categor\u00eda, se genera un nuevo encabezado. Requisito Importante : Para que la agrupaci\u00f3n funcione correctamente, los datos de entrada deben estar ordenados por el campo de agrupaci\u00f3n. <?php namespace App\\Controllers\\Tienda ; use App\\ThirdParty\\Ragnos\\Controllers\\BaseController ; use App\\ThirdParty\\Ragnos\\Controllers\\RSimpleLevelReport ; class Productos extends BaseController { public function listadoPorCategoria () { // 1. Obtener datos (\u00a1Ordenados por categor\u00eda!) $data = [ [ 'categoria' => 'Electr\u00f3nica' , 'producto' => 'Televisor' , 'precio' => 500 ], [ 'categoria' => 'Electr\u00f3nica' , 'producto' => 'Radio' , 'precio' => 50 ], [ 'categoria' => 'Hogar' , 'producto' => 'Silla' , 'precio' => 25 ], [ 'categoria' => 'Hogar' , 'producto' => 'Mesa' , 'precio' => 100 ], ]; $reporte = new RSimpleLevelReport (); // 2. Definir Agrupaci\u00f3n // La clave 'categoria' debe existir en $data. $grupos = [ 'categoria' => [ 'label' => 'Categor\u00eda de Producto' ] ]; // 3. Configurar $reporte -> quickSetup ( 'Listado de Productos' , $data , [ 'producto' , 'precio' ], // Campos a mostrar en las columnas $grupos , // Configuraci\u00f3n de grupos 'Filtro: Todos los productos activos' // Subt\u00edtulo opcional ); return view ( 'admin/reporte_view' , [ 'contenido' => $reporte -> render ()]); } }","title":"2. Reporte Agrupado (Corte de Control)"},{"location":"frontend/reportes_simples/#3-reporte-multi-nivel","text":"Es posible agrupar por m\u00faltiples niveles (ej: Pa\u00eds -> Estado -> Ciudad). $grupos = [ 'pais' => ['label' => 'Pa\u00eds'], 'estado' => ['label' => 'Estado/Provincia'] ]; // Los datos deben venir ordenados por pais y luego por estado $reporte->quickSetup('Reporte Geogr\u00e1fico', $data, ['ciudad', 'poblacion'], $grupos);","title":"3. Reporte Multi-Nivel"},{"location":"frontend/reportes_simples/#aplicaciones-comunes","text":"Listados de Inventario : Agrupados por almac\u00e9n o categor\u00eda. Reportes de Ventas : Diarios, mensuales o agrupados por vendedor. Auditor\u00eda : Listados de logs de sistema. Res\u00famenes Financieros : Listados simples de ingresos/egresos formateados.","title":"Aplicaciones Comunes"},{"location":"fundamentos/configuracion/","text":"Configuraci\u00f3n de Ragnos Adem\u00e1s de la configuraci\u00f3n est\u00e1ndar de CodeIgniter 4 (base de datos, rutas, etc.), Ragnos incluye un archivo de configuraci\u00f3n espec\u00edfico para personalizar el comportamiento global del framework. Archivo de Configuraci\u00f3n El archivo se encuentra en app/Config/RagnosConfig.php . namespace Config; use CodeIgniter\\Config\\BaseConfig; class RagnosConfig extends BaseConfig { public $Ragnos_application_title = '\ud83c\udfea Tienda'; public $Ragnos_all_to_uppercase = false; public $currency = 'USD'; public $locale = 'es_MX'; } Variables Disponibles Identidad de la Aplicaci\u00f3n Variable Tipo Descripci\u00f3n $Ragnos_application_title string Define el nombre p\u00fablico de la aplicaci\u00f3n. Este texto aparecer\u00e1 en la barra superior (Topbar), en el men\u00fa lateral (Sidebar) y en los encabezados de p\u00e1gina. Comportamiento de Datos Variable Tipo Descripci\u00f3n $Ragnos_all_to_uppercase bool Si se establece en true , fuerza la conversi\u00f3n a may\u00fasculas de ciertos campos de entrada predeterminados en los formularios generados autom\u00e1ticamente. Regionalizaci\u00f3n Variable Tipo Descripci\u00f3n $currency string Define el c\u00f3digo de moneda por defecto (ej. 'USD', 'MXN', 'EUR') utilizado en los helpers de formateo de dinero. $locale string Define el locale predeterminado para formatos de fecha y n\u00famero (ej. 'es_MX', 'en_US'). Nota: Esto es independiente del idioma de la interfaz que maneja CI4. Enrutamiento (Auto Routing) Una particularidad importante de Ragnos es que mantiene habilitada la caracter\u00edstica de Auto Routing ( $routes->setAutoRoute(true) ) de CodeIgniter 4 por defecto. \u00bfQu\u00e9 implica esto para el desarrollador? Cero Configuraci\u00f3n de Rutas: Al crear un nuevo controlador (por ejemplo, con el Generador CLI ), este es accesible inmediatamente v\u00eda URL ( /TuControlador/metodo ) sin necesidad de editar app/Config/Routes.php . Agilidad: Esto es fundamental para la filosof\u00eda \"Low Code\" de Ragnos, permitiendo prototipar y desplegar m\u00f3dulos CRUD en segundos. Seguridad y Personalizaci\u00f3n: Si necesitas URLs espec\u00edficas o restringir el acceso, puedes definir rutas manuales en Config/Routes.php . Las rutas manuales tienen prioridad sobre las autom\u00e1ticas. \u26a0\ufe0f Importante: Si decides desactivar el Auto Routing ( false ) por pol\u00edticas de seguridad estrictas, deber\u00e1s registrar manualmente cada ruta de tus Datasets, lo cual incrementa el trabajo de mantenimiento. Otras Configuraciones (CodeIgniter) Recuerda que Ragnos respeta la configuraci\u00f3n nativa de CI4. Archivos importantes en app/Config/ : App.php : Configuraci\u00f3n base ( baseURL , indexPage ). Database.php : Credenciales de conexi\u00f3n. Security.php : Configuraci\u00f3n CSRF y headers de seguridad.","title":"Configuraci\u00f3n"},{"location":"fundamentos/configuracion/#configuracion-de-ragnos","text":"Adem\u00e1s de la configuraci\u00f3n est\u00e1ndar de CodeIgniter 4 (base de datos, rutas, etc.), Ragnos incluye un archivo de configuraci\u00f3n espec\u00edfico para personalizar el comportamiento global del framework.","title":"Configuraci\u00f3n de Ragnos"},{"location":"fundamentos/configuracion/#archivo-de-configuracion","text":"El archivo se encuentra en app/Config/RagnosConfig.php . namespace Config; use CodeIgniter\\Config\\BaseConfig; class RagnosConfig extends BaseConfig { public $Ragnos_application_title = '\ud83c\udfea Tienda'; public $Ragnos_all_to_uppercase = false; public $currency = 'USD'; public $locale = 'es_MX'; }","title":"Archivo de Configuraci\u00f3n"},{"location":"fundamentos/configuracion/#variables-disponibles","text":"","title":"Variables Disponibles"},{"location":"fundamentos/configuracion/#identidad-de-la-aplicacion","text":"Variable Tipo Descripci\u00f3n $Ragnos_application_title string Define el nombre p\u00fablico de la aplicaci\u00f3n. Este texto aparecer\u00e1 en la barra superior (Topbar), en el men\u00fa lateral (Sidebar) y en los encabezados de p\u00e1gina.","title":"Identidad de la Aplicaci\u00f3n"},{"location":"fundamentos/configuracion/#comportamiento-de-datos","text":"Variable Tipo Descripci\u00f3n $Ragnos_all_to_uppercase bool Si se establece en true , fuerza la conversi\u00f3n a may\u00fasculas de ciertos campos de entrada predeterminados en los formularios generados autom\u00e1ticamente.","title":"Comportamiento de Datos"},{"location":"fundamentos/configuracion/#regionalizacion","text":"Variable Tipo Descripci\u00f3n $currency string Define el c\u00f3digo de moneda por defecto (ej. 'USD', 'MXN', 'EUR') utilizado en los helpers de formateo de dinero. $locale string Define el locale predeterminado para formatos de fecha y n\u00famero (ej. 'es_MX', 'en_US'). Nota: Esto es independiente del idioma de la interfaz que maneja CI4.","title":"Regionalizaci\u00f3n"},{"location":"fundamentos/configuracion/#enrutamiento-auto-routing","text":"Una particularidad importante de Ragnos es que mantiene habilitada la caracter\u00edstica de Auto Routing ( $routes->setAutoRoute(true) ) de CodeIgniter 4 por defecto.","title":"Enrutamiento (Auto Routing)"},{"location":"fundamentos/configuracion/#que-implica-esto-para-el-desarrollador","text":"Cero Configuraci\u00f3n de Rutas: Al crear un nuevo controlador (por ejemplo, con el Generador CLI ), este es accesible inmediatamente v\u00eda URL ( /TuControlador/metodo ) sin necesidad de editar app/Config/Routes.php . Agilidad: Esto es fundamental para la filosof\u00eda \"Low Code\" de Ragnos, permitiendo prototipar y desplegar m\u00f3dulos CRUD en segundos. Seguridad y Personalizaci\u00f3n: Si necesitas URLs espec\u00edficas o restringir el acceso, puedes definir rutas manuales en Config/Routes.php . Las rutas manuales tienen prioridad sobre las autom\u00e1ticas. \u26a0\ufe0f Importante: Si decides desactivar el Auto Routing ( false ) por pol\u00edticas de seguridad estrictas, deber\u00e1s registrar manualmente cada ruta de tus Datasets, lo cual incrementa el trabajo de mantenimiento.","title":"\u00bfQu\u00e9 implica esto para el desarrollador?"},{"location":"fundamentos/configuracion/#otras-configuraciones-codeigniter","text":"Recuerda que Ragnos respeta la configuraci\u00f3n nativa de CI4. Archivos importantes en app/Config/ : App.php : Configuraci\u00f3n base ( baseURL , indexPage ). Database.php : Credenciales de conexi\u00f3n. Security.php : Configuraci\u00f3n CSRF y headers de seguridad.","title":"Otras Configuraciones (CodeIgniter)"},{"location":"fundamentos/instalacion/","text":"Instalaci\u00f3n de Ragnos Esta gu\u00eda describe c\u00f3mo instalar Ragnos Framework a partir de un archivo ZIP distribuido. Requisitos del Servidor Ragnos est\u00e1 basado en CodeIgniter 4 , por lo que comparte sus requisitos m\u00ednimos: PHP : Versi\u00f3n 7.4 o superior (se recomienda PHP 8.1+). Extensiones PHP : intl mbstring json mysqlnd (si usas MySQL/MariaDB) curl gd (opcional, para manipulaci\u00f3n de im\u00e1genes) Base de Datos : MySQL (5.1+) o MariaDB. Pasos de Instalaci\u00f3n 1. Descarga y Extracci\u00f3n Descarga el archivo .zip con la \u00faltima versi\u00f3n de Ragnos. Extrae el contenido en el directorio de tu servidor web (por ejemplo, c:\\laragon\\www\\mi-proyecto o /var/www/html/mi-proyecto ). Verifique que la carpeta vendor existe y contiene las dependencias. Ragnos ya incluye todas las librer\u00edas necesarias. 2. Configuraci\u00f3n del Entorno Ubica el archivo env en la ra\u00edz del proyecto. Ren\u00f3mbralo o c\u00f3pialo a .env . Abre el archivo .env y ajusta las siguientes variables: Ojo con el punto Aseg\u00farate de que el archivo se llame exactamente .env (con el punto al inicio) y no solo env . Entorno: CI_ENVIRONMENT = development URL Base: app.baseURL = 'http://localhost/mi-proyecto/' Base de Datos: Descomenta y configura las credenciales de tu base de datos: database.default.hostname = localhost database.default.database = nombre_de_tu_bd database.default.username = tu_usuario database.default.password = tu_contrase\u00f1a database.default.DBDriver = MySQLi 3. Importar Base de Datos Ragnos requiere ciertas tablas base para funcionar (usuarios, sesiones, permisos). Crea una base de datos vac\u00eda en tu gestor (phpMyAdmin, HeidiSQL, etc.). Importa los archivos SQL ubicados en la carpeta sampledatabase/ : Ejecuta primero ragnos_mariadb.sql (o el dump principal que contenga la estructura base). Ejecuta ci_sessions.sql para la tabla de sesiones. 4. Verificar Permisos Aseg\u00farate de que la carpeta writable/ y sus subcarpetas tengan permisos de escritura por parte del servidor web. 5. Ejecutar Accede a tu navegador en la URL configurada (ej. http://localhost/mi-proyecto/public o simplemente http://mi-proyecto.test si usas Laragon). Deber\u00edas ver la pantalla de inicio de sesi\u00f3n. 6. Credenciales de Acceso (Demo) Para acceder al sistema demo por primera vez, utiliza las siguientes credenciales: Usuario: admin Contrase\u00f1a: ok","title":"Instalaci\u00f3n"},{"location":"fundamentos/instalacion/#instalacion-de-ragnos","text":"Esta gu\u00eda describe c\u00f3mo instalar Ragnos Framework a partir de un archivo ZIP distribuido.","title":"Instalaci\u00f3n de Ragnos"},{"location":"fundamentos/instalacion/#requisitos-del-servidor","text":"Ragnos est\u00e1 basado en CodeIgniter 4 , por lo que comparte sus requisitos m\u00ednimos: PHP : Versi\u00f3n 7.4 o superior (se recomienda PHP 8.1+). Extensiones PHP : intl mbstring json mysqlnd (si usas MySQL/MariaDB) curl gd (opcional, para manipulaci\u00f3n de im\u00e1genes) Base de Datos : MySQL (5.1+) o MariaDB.","title":"Requisitos del Servidor"},{"location":"fundamentos/instalacion/#pasos-de-instalacion","text":"","title":"Pasos de Instalaci\u00f3n"},{"location":"fundamentos/instalacion/#1-descarga-y-extraccion","text":"Descarga el archivo .zip con la \u00faltima versi\u00f3n de Ragnos. Extrae el contenido en el directorio de tu servidor web (por ejemplo, c:\\laragon\\www\\mi-proyecto o /var/www/html/mi-proyecto ). Verifique que la carpeta vendor existe y contiene las dependencias. Ragnos ya incluye todas las librer\u00edas necesarias.","title":"1. Descarga y Extracci\u00f3n"},{"location":"fundamentos/instalacion/#2-configuracion-del-entorno","text":"Ubica el archivo env en la ra\u00edz del proyecto. Ren\u00f3mbralo o c\u00f3pialo a .env . Abre el archivo .env y ajusta las siguientes variables: Ojo con el punto Aseg\u00farate de que el archivo se llame exactamente .env (con el punto al inicio) y no solo env . Entorno: CI_ENVIRONMENT = development URL Base: app.baseURL = 'http://localhost/mi-proyecto/' Base de Datos: Descomenta y configura las credenciales de tu base de datos: database.default.hostname = localhost database.default.database = nombre_de_tu_bd database.default.username = tu_usuario database.default.password = tu_contrase\u00f1a database.default.DBDriver = MySQLi","title":"2. Configuraci\u00f3n del Entorno"},{"location":"fundamentos/instalacion/#3-importar-base-de-datos","text":"Ragnos requiere ciertas tablas base para funcionar (usuarios, sesiones, permisos). Crea una base de datos vac\u00eda en tu gestor (phpMyAdmin, HeidiSQL, etc.). Importa los archivos SQL ubicados en la carpeta sampledatabase/ : Ejecuta primero ragnos_mariadb.sql (o el dump principal que contenga la estructura base). Ejecuta ci_sessions.sql para la tabla de sesiones.","title":"3. Importar Base de Datos"},{"location":"fundamentos/instalacion/#4-verificar-permisos","text":"Aseg\u00farate de que la carpeta writable/ y sus subcarpetas tengan permisos de escritura por parte del servidor web.","title":"4. Verificar Permisos"},{"location":"fundamentos/instalacion/#5-ejecutar","text":"Accede a tu navegador en la URL configurada (ej. http://localhost/mi-proyecto/public o simplemente http://mi-proyecto.test si usas Laragon). Deber\u00edas ver la pantalla de inicio de sesi\u00f3n.","title":"5. Ejecutar"},{"location":"fundamentos/instalacion/#6-credenciales-de-acceso-demo","text":"Para acceder al sistema demo por primera vez, utiliza las siguientes credenciales: Usuario: admin Contrase\u00f1a: ok","title":"6. Credenciales de Acceso (Demo)"},{"location":"fundamentos/plantilla/","text":"Ragnos CLI Generator El Generador CLI de Ragnos es una herramienta de l\u00ednea de comandos integrada en Spark (CodeIgniter 4) que permite crear esqueletos de RDatasetController en segundos. Puedes ver este generador en acci\u00f3n en la gu\u00eda de Primeros Pasos . \ud83d\udccb Tabla de Contenidos Instalaci\u00f3n Sintaxis del Comando Ejemplos de Uso Mapeo Inteligente de Tipos Beneficios \ud83d\udee0 Instalaci\u00f3n El Generador CLI de Ragnos viene preinstalado con el paquete Ragnos. Solo aseg\u00farate de tener Ragnos correctamente instalado en tu proyecto CodeIgniter 4. Verifica que la disponibilidad del comando ejecutando: php spark list Deber\u00edas ver el grupo Ragnos y el comando ragnos:make . \ud83d\udcbb Sintaxis del Comando Desde la ra\u00edz de tu proyecto: php spark ragnos:make [ NombreControlador ] [ Opciones ] Argumentos Argumento Descripci\u00f3n NombreControlador La ruta y nombre de la clase (ej. Inventario/Productos ). Opciones Opci\u00f3n Descripci\u00f3n -table Nombre exacto de la tabla en BD. \ud83d\ude80 Ejemplos de Uso 1. Uso B\u00e1sico (Autodetecci\u00f3n) Si tu controlador es Productos y tabla productos : php spark ragnos:make Tienda/Productos 2. Uso con Tabla Espec\u00edfica php spark ragnos:make Admin/Usuarios -table app_users_tbl \ud83e\udde0 Mapeo Inteligente de Tipos Ragnos elige el componente seg\u00fan tu BD: Tipo BD Tipo Ragnos Reglas Auto-generadas INT number required \\| integer DECIMAL money required \\| decimal DATE date required TEXT textarea required TINYINT(1) checkbox permit_empty VARCHAR text required \\| max_length[n] \u2b50 Beneficios Velocidad: Crea un CRUD en 10 segundos. Estandarizaci\u00f3n: Evita errores de copy-paste y namespaces. Limpieza: Genera etiquetas legibles (\"Fecha Alta\" en lugar de \"fecha_alta\"). Plantilla oficial de nuevo Dataset Si quieres crear un nuevo Dataset desde cero, sin utilizar la l\u00ednea de comandos, utiliza esta plantilla como gu\u00eda para definir la estructura y convenciones recomendadas. <?php namespace App\\Controllers\\Tienda ; use App\\ThirdParty\\Ragnos\\Controllers\\RDatasetController ; class EjemploDataset extends RDatasetController { public function __construct () { parent :: __construct (); $this -> checkLogin (); $this -> setTitle ( 'Ejemplo' ); $this -> setTableName ( 'example_table' ); $this -> setIdField ( 'id' ); $this -> setAutoIncrement ( true ); $this -> addField ( 'name' , [ 'label' => 'Nombre' , 'rules' => 'required' ]); $this -> setTableFields ([ 'name' ]); } } \ud83d\udcc4 Documentaci\u00f3n de la plantilla de Dataset \ud83c\udfaf Prop\u00f3sito Esta plantilla sirve como punto de partida para crear un nuevo Dataset que se integrar\u00e1 en la tienda (store) del proyecto. Proporciona la estructura, convenciones y campos m\u00ednimos recomendados para que el Dataset funcione correctamente en el flujo existente. \ud83d\udcdd Instrucciones b\u00e1sicas Duplicar: Copia este archivo y col\u00f3calo en la ruta adecuada del repositorio para el nuevo Dataset. Ajustar: Modifica los nombres de clases, tablas y campos seg\u00fan tus necesidades (ver \"Convenciones\"). Registrar: Define el Dataset en el m\u00f3dulo/manifest de la tienda para que quede disponible en la interfaz y en la API. \ud83c\udff7 Convenciones de nombres Clase/Modelo: PascalCase (por ejemplo, MiDataset ). Tabla en BD: snake_case plural (por ejemplo, mi_datasets ). Campos: snake_case (por ejemplo, fecha_creacion , usuario_id ). Slug/identificador p\u00fablico: kebab-case (por ejemplo, mi-dataset ). \ud83c\udfd7 Estructura recomendada Metadatos: Nombre, slug, descripci\u00f3n corta, versi\u00f3n, autor/contacto. Esquema de datos: Lista de campos con nombre, tipo ( string , integer , boolean , date , json , etc.), nulabilidad y valores por defecto. Relaciones: Definir relaciones belongsTo / hasMany / hasOne con otras tablas (indicando FK). \u00cdndices: Declarar \u00edndices para campos de b\u00fasqueda y claves for\u00e1neas. \ud83d\uddc4 Migraciones y esquema Migraci\u00f3n: Crear una migraci\u00f3n que genere la tabla con todos los campos y restricciones. Claves for\u00e1neas: Incluir ON DELETE / ON UPDATE seg\u00fan la l\u00f3gica de negocio. Optimizaci\u00f3n: A\u00f1adir \u00edndices para consultas frecuentes. \u2705 Validaciones y tipos Servidor: Especificar validaciones (requerido, formato, rango) y tipos esperados. UI: Mapear validaciones a los formularios de la interfaz para ofrecer feedback consistente. \ud83d\uded2 Registro en la tienda (store) Manifest: A\u00f1adir el Dataset al listado de Datasets para que la tienda lo reconozca. API: Proveer endpoints o adaptadores para CRUD seg\u00fan la arquitectura del proyecto. Seguridad: Incluir permisos y roles necesarios para acceder o modificar el Dataset. \ud83e\udde9 Ejemplo de placeholders (sustituir por reales) Nombre clase: MiDataset Tabla: mi_datasets Campos: id (PK) titulo (string) descripcion (text) publicado (boolean) creado_en (datetime) usuario_id (FK) \ud83e\uddea Pruebas y verificaci\u00f3n Crear pruebas unitarias para validaciones y modelos. Probar migraciones en una copia de la BD y verificar la integridad referencial. Verificar el registro y visibilidad en la interfaz de la tienda. \ud83d\udca1 Buenas pr\u00e1cticas Autodocumentaci\u00f3n: Mantener la documentaci\u00f3n dentro del propio Dataset (metadatos) para facilitar su descubrimiento. Versionado: Controlar cambios en el esquema y documentar migraciones incompatibles. Compatibilidad: Evitar cambios breaking en campos p\u00fablicos sin migraciones previas y comunicaci\u00f3n a los consumidores. Notas finales: Aseg\u00farate de adaptar los nombres y tipos a la l\u00f3gica de tu dominio. Esta plantilla es una gu\u00eda; revisa las pol\u00edticas de la base de datos, seguridad y permisos de tu proyecto antes de publicar el Dataset. \u00a1Con esta plantilla y gu\u00eda, deber\u00edas estar listo para crear un nuevo Dataset que se integre perfectamente en tu proyecto!","title":"Generador CLI"},{"location":"fundamentos/plantilla/#ragnos-cli-generator","text":"El Generador CLI de Ragnos es una herramienta de l\u00ednea de comandos integrada en Spark (CodeIgniter 4) que permite crear esqueletos de RDatasetController en segundos. Puedes ver este generador en acci\u00f3n en la gu\u00eda de Primeros Pasos .","title":"Ragnos CLI Generator"},{"location":"fundamentos/plantilla/#tabla-de-contenidos","text":"Instalaci\u00f3n Sintaxis del Comando Ejemplos de Uso Mapeo Inteligente de Tipos Beneficios","title":"\ud83d\udccb Tabla de Contenidos"},{"location":"fundamentos/plantilla/#instalacion","text":"El Generador CLI de Ragnos viene preinstalado con el paquete Ragnos. Solo aseg\u00farate de tener Ragnos correctamente instalado en tu proyecto CodeIgniter 4. Verifica que la disponibilidad del comando ejecutando: php spark list Deber\u00edas ver el grupo Ragnos y el comando ragnos:make .","title":"\ud83d\udee0 Instalaci\u00f3n"},{"location":"fundamentos/plantilla/#sintaxis-del-comando","text":"Desde la ra\u00edz de tu proyecto: php spark ragnos:make [ NombreControlador ] [ Opciones ]","title":"\ud83d\udcbb Sintaxis del Comando"},{"location":"fundamentos/plantilla/#argumentos","text":"Argumento Descripci\u00f3n NombreControlador La ruta y nombre de la clase (ej. Inventario/Productos ).","title":"Argumentos"},{"location":"fundamentos/plantilla/#opciones","text":"Opci\u00f3n Descripci\u00f3n -table Nombre exacto de la tabla en BD.","title":"Opciones"},{"location":"fundamentos/plantilla/#ejemplos-de-uso","text":"","title":"\ud83d\ude80 Ejemplos de Uso"},{"location":"fundamentos/plantilla/#1-uso-basico-autodeteccion","text":"Si tu controlador es Productos y tabla productos : php spark ragnos:make Tienda/Productos","title":"1. Uso B\u00e1sico (Autodetecci\u00f3n)"},{"location":"fundamentos/plantilla/#2-uso-con-tabla-especifica","text":"php spark ragnos:make Admin/Usuarios -table app_users_tbl","title":"2. Uso con Tabla Espec\u00edfica"},{"location":"fundamentos/plantilla/#mapeo-inteligente-de-tipos","text":"Ragnos elige el componente seg\u00fan tu BD: Tipo BD Tipo Ragnos Reglas Auto-generadas INT number required \\| integer DECIMAL money required \\| decimal DATE date required TEXT textarea required TINYINT(1) checkbox permit_empty VARCHAR text required \\| max_length[n]","title":"\ud83e\udde0 Mapeo Inteligente de Tipos"},{"location":"fundamentos/plantilla/#beneficios","text":"Velocidad: Crea un CRUD en 10 segundos. Estandarizaci\u00f3n: Evita errores de copy-paste y namespaces. Limpieza: Genera etiquetas legibles (\"Fecha Alta\" en lugar de \"fecha_alta\").","title":"\u2b50 Beneficios"},{"location":"fundamentos/plantilla/#plantilla-oficial-de-nuevo-dataset","text":"Si quieres crear un nuevo Dataset desde cero, sin utilizar la l\u00ednea de comandos, utiliza esta plantilla como gu\u00eda para definir la estructura y convenciones recomendadas. <?php namespace App\\Controllers\\Tienda ; use App\\ThirdParty\\Ragnos\\Controllers\\RDatasetController ; class EjemploDataset extends RDatasetController { public function __construct () { parent :: __construct (); $this -> checkLogin (); $this -> setTitle ( 'Ejemplo' ); $this -> setTableName ( 'example_table' ); $this -> setIdField ( 'id' ); $this -> setAutoIncrement ( true ); $this -> addField ( 'name' , [ 'label' => 'Nombre' , 'rules' => 'required' ]); $this -> setTableFields ([ 'name' ]); } }","title":"Plantilla oficial de nuevo Dataset"},{"location":"fundamentos/plantilla/#documentacion-de-la-plantilla-de-dataset","text":"","title":"\ud83d\udcc4 Documentaci\u00f3n de la plantilla de Dataset"},{"location":"fundamentos/plantilla/#proposito","text":"Esta plantilla sirve como punto de partida para crear un nuevo Dataset que se integrar\u00e1 en la tienda (store) del proyecto. Proporciona la estructura, convenciones y campos m\u00ednimos recomendados para que el Dataset funcione correctamente en el flujo existente.","title":"\ud83c\udfaf Prop\u00f3sito"},{"location":"fundamentos/plantilla/#instrucciones-basicas","text":"Duplicar: Copia este archivo y col\u00f3calo en la ruta adecuada del repositorio para el nuevo Dataset. Ajustar: Modifica los nombres de clases, tablas y campos seg\u00fan tus necesidades (ver \"Convenciones\"). Registrar: Define el Dataset en el m\u00f3dulo/manifest de la tienda para que quede disponible en la interfaz y en la API.","title":"\ud83d\udcdd Instrucciones b\u00e1sicas"},{"location":"fundamentos/plantilla/#convenciones-de-nombres","text":"Clase/Modelo: PascalCase (por ejemplo, MiDataset ). Tabla en BD: snake_case plural (por ejemplo, mi_datasets ). Campos: snake_case (por ejemplo, fecha_creacion , usuario_id ). Slug/identificador p\u00fablico: kebab-case (por ejemplo, mi-dataset ).","title":"\ud83c\udff7 Convenciones de nombres"},{"location":"fundamentos/plantilla/#estructura-recomendada","text":"Metadatos: Nombre, slug, descripci\u00f3n corta, versi\u00f3n, autor/contacto. Esquema de datos: Lista de campos con nombre, tipo ( string , integer , boolean , date , json , etc.), nulabilidad y valores por defecto. Relaciones: Definir relaciones belongsTo / hasMany / hasOne con otras tablas (indicando FK). \u00cdndices: Declarar \u00edndices para campos de b\u00fasqueda y claves for\u00e1neas.","title":"\ud83c\udfd7 Estructura recomendada"},{"location":"fundamentos/plantilla/#migraciones-y-esquema","text":"Migraci\u00f3n: Crear una migraci\u00f3n que genere la tabla con todos los campos y restricciones. Claves for\u00e1neas: Incluir ON DELETE / ON UPDATE seg\u00fan la l\u00f3gica de negocio. Optimizaci\u00f3n: A\u00f1adir \u00edndices para consultas frecuentes.","title":"\ud83d\uddc4 Migraciones y esquema"},{"location":"fundamentos/plantilla/#validaciones-y-tipos","text":"Servidor: Especificar validaciones (requerido, formato, rango) y tipos esperados. UI: Mapear validaciones a los formularios de la interfaz para ofrecer feedback consistente.","title":"\u2705 Validaciones y tipos"},{"location":"fundamentos/plantilla/#registro-en-la-tienda-store","text":"Manifest: A\u00f1adir el Dataset al listado de Datasets para que la tienda lo reconozca. API: Proveer endpoints o adaptadores para CRUD seg\u00fan la arquitectura del proyecto. Seguridad: Incluir permisos y roles necesarios para acceder o modificar el Dataset.","title":"\ud83d\uded2 Registro en la tienda (store)"},{"location":"fundamentos/plantilla/#ejemplo-de-placeholders-sustituir-por-reales","text":"Nombre clase: MiDataset Tabla: mi_datasets Campos: id (PK) titulo (string) descripcion (text) publicado (boolean) creado_en (datetime) usuario_id (FK)","title":"\ud83e\udde9 Ejemplo de placeholders (sustituir por reales)"},{"location":"fundamentos/plantilla/#pruebas-y-verificacion","text":"Crear pruebas unitarias para validaciones y modelos. Probar migraciones en una copia de la BD y verificar la integridad referencial. Verificar el registro y visibilidad en la interfaz de la tienda.","title":"\ud83e\uddea Pruebas y verificaci\u00f3n"},{"location":"fundamentos/plantilla/#buenas-practicas","text":"Autodocumentaci\u00f3n: Mantener la documentaci\u00f3n dentro del propio Dataset (metadatos) para facilitar su descubrimiento. Versionado: Controlar cambios en el esquema y documentar migraciones incompatibles. Compatibilidad: Evitar cambios breaking en campos p\u00fablicos sin migraciones previas y comunicaci\u00f3n a los consumidores. Notas finales: Aseg\u00farate de adaptar los nombres y tipos a la l\u00f3gica de tu dominio. Esta plantilla es una gu\u00eda; revisa las pol\u00edticas de la base de datos, seguridad y permisos de tu proyecto antes de publicar el Dataset. \u00a1Con esta plantilla y gu\u00eda, deber\u00edas estar listo para crear un nuevo Dataset que se integre perfectamente en tu proyecto!","title":"\ud83d\udca1 Buenas pr\u00e1cticas"},{"location":"fundamentos/primeros_pasos/","text":"Primeros Pasos: Hola Mundo En este tutorial crearemos un m\u00f3dulo funcional completo (CRUD) para gestionar una lista de \"Tareas\" en menos de 5 minutos. 1. Preparar la Base de Datos Primero, necesitamos una tabla f\u00edsica donde guardar los datos. Ejecuta este SQL en tu base de datos: CREATE TABLE ` tareas ` ( ` id_tarea ` int ( 11 ) NOT NULL AUTO_INCREMENT , ` titulo ` varchar ( 100 ) NOT NULL , ` descripcion ` text , ` estado ` enum ( 'pendiente' , 'en_progreso' , 'completada' ) DEFAULT 'pendiente' , ` fecha_vencimiento ` date DEFAULT NULL , PRIMARY KEY ( ` id_tarea ` ) ) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 ; 2. Generar el Controlador Abre tu terminal en la carpeta ra\u00edz del proyecto y usa el generador de Ragnos: php spark ragnos:make Proceso/Tareas -table tareas Esto crear\u00e1 el archivo app/Controllers/Proceso/Tareas.php . 3. Configurar el Dataset Abre el archivo reci\u00e9n creado app/Controllers/Proceso/Tareas.php y completa la configuraci\u00f3n en el constructor. El generador habr\u00e1 creado una estructura b\u00e1sica; ed\u00edtala para que luzca as\u00ed: namespace App\\Controllers\\Proceso; use App\\ThirdParty\\Ragnos\\Controllers\\RDatasetController; class Tareas extends RDatasetController { public function __construct() { parent::__construct(); // 1. T\u00edtulo y Seguridad $this->checkLogin(); // Requiere estar logueado $this->setTitle('Gesti\u00f3n de Tareas'); // 2. Configuraci\u00f3n de la Tabla $this->setTableName('tareas'); $this->setIdField('id_tarea'); // 3. Definici\u00f3n de Campos $this->addField('titulo', [ 'label' => 'T\u00edtulo de la Tarea', 'rules' => 'required|min_length[5]' ]); $this->addField('descripcion', [ 'label' => 'Detalle', 'type' => 'textarea' ]); $this->addField('fecha_vencimiento', [ 'label' => 'Vence el', 'type' => 'date' ]); $this->addField('estado', [ 'label' => 'Estado Actual', 'type' => 'select', // O 'enum' 'options' => [ 'pendiente' => 'Pendiente', 'en_progreso' => 'En Progreso', 'completada' => 'Finalizada' ] ]); // 4. Configurar la Grilla (Listado) $this->setTableFields(['titulo', 'estado', 'fecha_vencimiento']); } } 4. Probar en el Navegador Abre tu navegador e ingresa al sistema. Navega manualmente a la URL de tu controlador. Si tu URL base es localhost/ragnos , ve a: http://localhost/ragnos/proceso/tareas \u00a1Listo! Deber\u00edas ver: Un listado de tareas (vac\u00edo por ahora). Un bot\u00f3n \"Nuevo\" que abre un formulario. Funcionalidad completa de Guardar, Editar y Eliminar. Siguientes Pasos Agrega este nuevo m\u00f3dulo al men\u00fa lateral (ver Personalizaci\u00f3n de UI ). Aprende sobre m\u00e1s tipos de campos en Referencia de Campos .","title":"Primeros Pasos"},{"location":"fundamentos/primeros_pasos/#primeros-pasos-hola-mundo","text":"En este tutorial crearemos un m\u00f3dulo funcional completo (CRUD) para gestionar una lista de \"Tareas\" en menos de 5 minutos.","title":"Primeros Pasos: Hola Mundo"},{"location":"fundamentos/primeros_pasos/#1-preparar-la-base-de-datos","text":"Primero, necesitamos una tabla f\u00edsica donde guardar los datos. Ejecuta este SQL en tu base de datos: CREATE TABLE ` tareas ` ( ` id_tarea ` int ( 11 ) NOT NULL AUTO_INCREMENT , ` titulo ` varchar ( 100 ) NOT NULL , ` descripcion ` text , ` estado ` enum ( 'pendiente' , 'en_progreso' , 'completada' ) DEFAULT 'pendiente' , ` fecha_vencimiento ` date DEFAULT NULL , PRIMARY KEY ( ` id_tarea ` ) ) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 ;","title":"1. Preparar la Base de Datos"},{"location":"fundamentos/primeros_pasos/#2-generar-el-controlador","text":"Abre tu terminal en la carpeta ra\u00edz del proyecto y usa el generador de Ragnos: php spark ragnos:make Proceso/Tareas -table tareas Esto crear\u00e1 el archivo app/Controllers/Proceso/Tareas.php .","title":"2. Generar el Controlador"},{"location":"fundamentos/primeros_pasos/#3-configurar-el-dataset","text":"Abre el archivo reci\u00e9n creado app/Controllers/Proceso/Tareas.php y completa la configuraci\u00f3n en el constructor. El generador habr\u00e1 creado una estructura b\u00e1sica; ed\u00edtala para que luzca as\u00ed: namespace App\\Controllers\\Proceso; use App\\ThirdParty\\Ragnos\\Controllers\\RDatasetController; class Tareas extends RDatasetController { public function __construct() { parent::__construct(); // 1. T\u00edtulo y Seguridad $this->checkLogin(); // Requiere estar logueado $this->setTitle('Gesti\u00f3n de Tareas'); // 2. Configuraci\u00f3n de la Tabla $this->setTableName('tareas'); $this->setIdField('id_tarea'); // 3. Definici\u00f3n de Campos $this->addField('titulo', [ 'label' => 'T\u00edtulo de la Tarea', 'rules' => 'required|min_length[5]' ]); $this->addField('descripcion', [ 'label' => 'Detalle', 'type' => 'textarea' ]); $this->addField('fecha_vencimiento', [ 'label' => 'Vence el', 'type' => 'date' ]); $this->addField('estado', [ 'label' => 'Estado Actual', 'type' => 'select', // O 'enum' 'options' => [ 'pendiente' => 'Pendiente', 'en_progreso' => 'En Progreso', 'completada' => 'Finalizada' ] ]); // 4. Configurar la Grilla (Listado) $this->setTableFields(['titulo', 'estado', 'fecha_vencimiento']); } }","title":"3. Configurar el Dataset"},{"location":"fundamentos/primeros_pasos/#4-probar-en-el-navegador","text":"Abre tu navegador e ingresa al sistema. Navega manualmente a la URL de tu controlador. Si tu URL base es localhost/ragnos , ve a: http://localhost/ragnos/proceso/tareas \u00a1Listo! Deber\u00edas ver: Un listado de tareas (vac\u00edo por ahora). Un bot\u00f3n \"Nuevo\" que abre un formulario. Funcionalidad completa de Guardar, Editar y Eliminar.","title":"4. Probar en el Navegador"},{"location":"fundamentos/primeros_pasos/#siguientes-pasos","text":"Agrega este nuevo m\u00f3dulo al men\u00fa lateral (ver Personalizaci\u00f3n de UI ). Aprende sobre m\u00e1s tipos de campos en Referencia de Campos .","title":"Siguientes Pasos"}]}